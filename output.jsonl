{"instruction": "", "input": "", "output": "category IcsInterfaceResources{\n\n    asset DataHistorian extends IcsApplication \n        user info: \"A centralized database located on a computer installed in the control system DMZ supporting external corporate user data access for archival and analysis using statistical process control and other techniques.\"\n        developer info: \"https://collaborate.mitre.org/attackics/index.php/Data_Historian\"\n      {\n      // Override control related attack steps (Impact) because they are not relevant to this asset\n      | manipulationOfControl @Override\n\n      | lossOfControl @Override\n      }\n\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2019-2022 coreLang contributors <https://mal-lang.org/coreLang/contributors.html>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninclude \"ComputeResources.mal\"\ninclude \"DataResources.mal\"\ninclude \"IAM.mal\"\ninclude \"User.mal\"\ninclude \"Networking.mal\"\ninclude \"Vulnerability.mal\"\n"}
{"instruction": "", "input": "", "output": "// enterpriseLang\n// Authors: Wenjun Xiong (wenjx@kth.se), Emeline Legrand, Oscar Åberg\n// Probability distributions: Quentin Biharé, Love Wessman, Lina Evensjö\n\n#id: \"org.mal_lang.attacklang\"\n#version: \"1.0.0\"\n\ncategory Person {\n\tasset User {\n\t\t| attemptMaliciousLink @hidden\n\t\t\t->\tmaliciousLink\t\t\n\n\t\t& maliciousLink //(0.712)*Exponential(1)]\n\t\t\tdeveloper info: \"Sources for distribution result: https://arxiv.org/pdf/1606.00887; https://dl.acm.org/doi/fullHtml/10.1145/1290958.1290968\"\n\t\t\t->\tcomputer.os.service.attemptExploitationForClientExecution,\n\t\t\t\tattemptMaliciousFile, // links may lead users to download files that require execution via Malicious File\n\t\t\t\tcomputer.os.executeCode\n\n\t\t| attemptMaliciousFile @hidden\n\t\t\t->\tmaliciousFile\n\n\t\t& maliciousFile //(0.93)*Exponential(1)]\n\t\t\tdeveloper info: \"Sources for distribution result: Based on attack step spearphishingLinkClicked and https://doi.org/10.1016/j.cose.2006.10.009\"\n\t\t\t->\tcomputer.os.attemptDynamicDataExchange,\n\t\t\t\tcomputer.os.executeCode\n\n\t\t| attemptUserExecution @hidden\n\t\t\t->\tuserAccount.userExecution\n\n\t\t| mediaInserted //(0.3)*Exponential(48)]\n\t\t\tuser info: \"People work in the targeted entreprise have physical access to the network and can thus easily use an infected USB device for the adversary to get initial compromise.\"\n\t\t\tdeveloper info: \"Sources for distribution result: https://www.supplychaindive.com/news/internal-actors-cyberattacks-manufacturing/572832/#:~:text=External%20actors%20account%20for%20the,2019%20Data%20Breach%20Investigations%20Report\"\n\t\t\t->\tcomputer.os.replicationThroughRemovableMedia,\n\t\t\t\tcomputer.peripheralDevice.dataExfiltration\n\n\t\t# userTraining //(0.22)]\n\t\t\tuser info: \"https://attack.mitre.org/mitigations/M1017/\"\n\t\t\tdeveloper info: \"Sources for distribution result: https://www.tandfonline.com/doi/abs/10.1080/10919392.2019.1552745; https://doi.org/10.1145/1572532.1572536; https://ieeexplore.ieee.org/abstract/document/6585241\" \n\t\t\t->\tmaliciousFile,\n\t\t\t\tmaliciousLink,\n\t\t\t\tuserAccount.userExecution\n\t}\n}\n\ncategory Software {\n\tasset UserAccount {\n\t\t| userRights\n\t\t\t->\tos.abuseElevationControlMechanism,\n\t\t\t\tos.accountAccessRemoval,\n\t\t\t\tos.accountDiscovery,\n\t\t\t\tos.applicationWindowDiscovery,\n\t\t\t\tos.attemptAccessTokenManipulation,\n\t\t\t\tos.attemptAutomatedCollection,\n\t\t\t\tos.attemptBITSJobs,\n\t\t\t\tos.attemptDataEncryptedForImpact,\n\t\t\t\tos.attemptExecutionThroughAPI,\n\t\t\t\tos.attemptLaunchAgent,\n\t\t\t\tos.attemptLogonScripts,\n\t\t\t\tos.attemptPlistModification,\n\t\t\t\tos.attemptSetuidAndSetgid,\n\t\t\t\tos.attemptShortcutModification,\n\t\t\t\tos.attemptSSHAuthorizedKeys,\n\t\t\t\tos.attemptTaintSharedContent,\n\t\t\t\tos.bash_profileAndBashrc,\n\t\t\t\tos.bashHistory,\n\t\t\t\tos.bruteForce,\n\t\t\t\tos.bypassUserAccessControl,\n\t\t\t\tos.changeDefaultFileAssociation,\n\t\t\t\tos.clearCommandHistory,\n\t\t\t\tos.cmstp,\n\t\t\t\tos.commandAndScriptingInterpreter,\n\t\t\t\tos.compileAfterDelivery,\n\t\t\t\tos.compiledHTMLFile,\n\t\t\t\tos.componentObjectModelHijacking,\n\t\t\t\tos.controlPanel,\n\t\t\t\tos.cOR_PROFILER,\n\t\t\t\tos.credentialsInFiles,\n\t\t\t\tos.credentialsInRegistry,\n\t\t\t\tos.credentialStuffing,\n\t\t\t\tos.cron,\n\t\t\t\tos.dataDestruction,\n\t\t\t\tos.dataEncoding,\n\t\t\t\tos.dataFromInformationRepositories,\n\t\t\t\tos.dataManipulation,\n\t\t\t\tos.defaultAccounts,\n\t\t\t\tos.deobfuscateOrDecodeFilesOrInformation,\n\t\t\t\tos.disableOrModifyTools,\n\t\t\t\tos.diskWipe,\n\t\t\t\tos.dLLSearchOrderHijacking,\n\t\t\t\tos.domainAccounts,\n\t\t\t\tos.domainDiscovery,\n\t\t\t\tos.domainGroups,\n\t\t\t\tos.domainTrustDiscovery,\n\t\t\t\tos.dynamicDataExchange,\n\t\t\t\tos.dynamicResolution,\n\t\t\t\tos.elevatedExecutionWithPrompt,\n\t\t\t\tos.emailCollection,\n\t\t\t\tos.executableInstallerFilePermissionsWeakness,\n\t\t\t\tos.executionGuardrails,\n\t\t\t\tos.executionThroughModuleLoad,\n\t\t\t\tos.fileAndDirectoryDiscovery,\n\t\t\t\tos.fileAndDirectoryPermissionsModification,\n\t\t\t\tos.fileDeletion,\n\t\t\t\tos.forcedAuthentication,\n\t\t\t\tos.gatekeeperBypass,\n\t\t\t\tos.groupPolicyModification,\n\t\t\t\tos.groupPolicyPreferences,\n\t\t\t\tos.gUIInputCapture,\n\t\t\t\tos.hiddenFilesAndDirectories,\n\t\t\t\tos.hiddenFileSystem,\n\t\t\t\tos.hiddenWindow,\n\t\t\t\tos.hISTCONTROL,\n\t\t\t\tos.indicatorRemovalOnHost,\n\t\t\t\tos.indirectCommandExecution,\n\t\t\t\tos.inhibitSystemRecovery,\n\t\t\t\tos.installRootCertificate,\n\t\t\t\tos.installUtil,\n\t\t\t\tos.internalSpearphishing,\n\t\t\t\tos.lateralToolTransfer,\n\t\t\t\tos.launchctl,\n\t\t\t\tos.lC_LOAD_DYLIB_Addition,\n\t\t\t\tos.lLMNR_NBT_NS_PoisoningAndSMBRelay,\n\t\t\t\tos.localAccounts,\n\t\t\t\tos.localGroups,\n\t\t\t\tos.manInTheMiddle,\n\t\t\t\tos.masqueradeTaskOrService,\n\t\t\t\tos.modifyRegistry,\n\t\t\t\tos.mshta,\n\t\t\t\tos.msiexec,\n\t\t\t\tos.networkShareConnectionRemoval,\n\t\t\t\tos.networkShareDiscovery,\n\t\t\t\tos.odbcconf,\n\t\t\t\tos.goldenTicket,\n\t\t\t\tos.parentPIDSpoofing,\n\t\t\t\tos.passwordCracking,\n\t\t\t\tos.passwordGuessing,\n\t\t\t\tos.passwordPolicyDiscovery,\n\t\t\t\tos.passwordSpraying,\n\t\t\t\tos.pathInterceptionBySearchOrderHijacking,\n\t\t\t\tos.peripheralDeviceDiscovery,\n\t\t\t\tos.portableExecutableInjection,\n\t\t\t\tos.portKnocking,\n\t\t\t\tos.powerShellUserProfile,\n\t\t\t\tos.privateKeys,\n\t\t\t\tos.processDiscovery,\n\t\t\t\tos.processDoppelganging,\n\t\t\t\tos.processHollowing,\n\t\t\t\tos.pubPrn,\n\t\t\t\tos.registryRunKeysOrStartupFolder,\n\t\t\t\tos.regsvcsOrRegasm,\n\t\t\t\tos.regsvr32,\n\t\t\t\tos.remoteDesktopProtocol,\n\t\t\t\tos.remoteFileCopy, \n\t\t\t\tos.remoteSystemDiscovery,\n\t\t\t\tos.reopenedApplications,\n\t\t\t\tos.resourceHijacking,\n\t\t\t\tos.rootkit,\n\t\t\t\tos.rundll32,\n\t\t\t\tos.runVirtualInstance,\n\t\t\t\tos.screensaver,\n\t\t\t\tos.securitySoftwareDiscovery,\n\t\t\t\tos.servicesFilePermissionsWeakness,\n\t\t\t\tos.servicesRegistryPermissionsWeakness,\n\t\t\t\tos.serviceStop,\n\t\t\t\tos.signedScriptProxyExecution,\n\t\t\t\tos.silverTicket,\n\t\t\t\tos.sIPAndTrustProviderHijacking,\n\t\t\t\tos.softwareDiscovery,\n\t\t\t\tos.source,\n\t\t\t\tos.spaceAfterFileName,\n\t\t\t\tos.sudoAndSudoCaching,\n\t\t\t\tos.systemdService,\n\t\t\t\tos.systemInformationDiscovery,\n\t\t\t\tos.systemNetworkConfigurationDiscovery,\n\t\t\t\tos.systemNetworkConnectionsDiscovery,\n\t\t\t\tos.systemOwnerOrUserDiscovery,\n\t\t\t\tos.systemServiceDiscovery,\n\t\t\t\tos.systemShutdownOrReboot,\n\t\t\t\tos.templateInjection,\n\t\t\t\tos.threadExecutionHijacking,\n\t\t\t\tos.timestomp,\n\t\t\t\tos.trap,\n\t\t\t\tos.trustedDeveloperUtilities,\n\t\t\t\tos.videoCapture,\n\t\t\t\tos.windowsAdminShares,\n\t\t\t\tos.windowsManagementInstrumentation,\n\t\t\t\tos.windowsRemoteManagement,\n\t\t\t\tos.xslScriptProcessing,\n\t\t\t\tos.service.attemptExploitationForCredentialAccess,\n\t\t\t\tos.service.attemptExploitationForDefenseEvasion,\n\t\t\t\tos.service.attemptExploitationForPrivilegeEscalation,\n\t\t\t\tos.service.attemptExploitationOfRemoteServices,\n\t\t\t\tos.service.attemptExternalRemoteServices,\n\t\t\t\tos.service.implantContainerImage,\n\t\t\t\tos.service.remoteAccessSoftware,\n\t\t\t\tos.service.cloudAccounts,\n\t\t\t\tos.service.cloudGroups,\n\t\t\t\tos.service.cloudServiceDiscovery,\n\t\t\t\tos.service.cloudServiceDashboard,\n\t\t\t\tos.service.disableOrModifyCloudFirewall,\n\t\t\t\tos.service.modifyCloudComputeInfrastructure,\n\t\t\t\tos.service.officeTemplateMacros,\n\t\t\t\tos.service.officeTest,\n\t\t\t\tos.service.outlookForms,\n\t\t\t\tos.service.outlookHomePage,\n\t\t\t\tos.service.outlookRules,\n\t\t\t\tos.service.addIns,\n\t\t\t\tos.service.stealApplicationAccessToken,\n\t\t\t\tos.service.attemptUseThirdpartySoftware,\n\t\t\t\tos.service.browser.browserBookmarkDiscovery,\n\t\t\t\tos.service.browser.driveByCompromise,\n\t\t\t\tos.service.browser.installExtensions,\n\t\t\t\tos.service.browser.stealWebSessionCookie,\n\t\t\t\tos.computer.router.internalNetwork.transmittedDataManipulation,\n\t\t\t\tos.computer.router.externalNetwork.bidirectionaCommunication,\n\t\t\t\tos.computer.router.externalNetwork.dataFromCloudStorageObject,\n\t\t\t\tos.computer.router.externalNetwork.deadDropResolver,\n\t\t\t\tos.computer.router.externalNetwork.oneWayCommunication,\n\t\t\t\tos.computer.router.externalNetwork.transmittedDataManipulation\n\n\t\t| userCredentials\n\t\t\t->\tuserRights,\n\t\t\t\tos.validAccounts,\n\t\t\t\tos.computer.router.internalNetwork.exchangeServerCollection,\n\t\t\t\tos.service.remoteServices\n\n\t\t& userExecution\n\t\t\tdeveloper info: \"Binary probability relation.\"\n\t\t\t->\tuser.maliciousFile,\n\t\t\t\tuser.maliciousLink\n\n\t\t| userInformation\n\n\t\t# userTraining //(0.22)]\n\t\t\tuser info: \"https://attack.mitre.org/mitigations/M1017/\"\n\t\t\tdeveloper info: \"Sources for distribution result: https://www.tandfonline.com/doi/abs/10.1080/10919392.2019.1552745; https://doi.org/10.1145/1572532.1572536; https://ieeexplore.ieee.org/abstract/document/6585241\" \t\t\n\t\t\t->\tos.cachedDomainCredentials,\n\t\t\t\tos.confluence,\n\t\t\t\tos.credentialsInFiles,\n\t\t\t\tos.gUIInputCapture,\n\t\t\t\tos.lSASecrets,\n\t\t\t\tos.lSASSMemory,\n\t\t\t\tos.manInTheBrowser,\n\t\t\t\tos.nTDS,\n\t\t\t\tos.plistModification,\n\t\t\t\tos.reopenedApplications,\n\t\t\t\tos.securityAccountManager,\n\t\t\t\tos.sharepoint,\n\t\t\t\tos.templateInjection,\n\t\t// 
{"instruction": "", "input": "", "output": "category IcsControlResources{\n\n    asset ControlServer extends IcsApplication \n        user info: \"A device which acts as both a server and controller, that hosts the control software used in communicating with lower-level control devices in an ICS network.\"\n        developer info: \"https://collaborate.mitre.org/attackics/index.php/Control_Server\"\n      {\n      // Override view related attack steps (Impact) becase they are not relevant to this asset\n      | manipulationOfView @Override\n\n      | lossOfView @Override\n      }\n\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n#id: \"org.mal-lang.testLang\"\n#version: \"0.0.1\"\n\ncategory InheritanceOverrides {\n\n  asset Parent {\n\n    | test_base_step\n      -> other_step1\n\n    | other_step1\n\n    | other_test\n  }\n\n  asset Child extends Parent {\n\n    | test_base_step\n      +> other_step2,\n         other_step3\n\n    | other_step2\n\n    | other_step3\n\n    | other_test\n      +> other_step3\n  }\n\n}\n\ncategory subType{\n  asset BaseAsset {\n\n    | base_step1\n  }\n\n  asset SubAsset extends BaseAsset{\n    | subasset_step2\n  }\n\n  asset OtherAsset {\n    | other_step1\n      -> subtype_test_assoc_field1[SubAsset].subasset_step2\n  }\n\n}\n\ncategory interleavedVariables{\n  asset AssetA {\n    let A1 = fieldB\n    let A2 = fieldB.B1()\n    | testStepA\n      -> A2().testStepA,\n         A1().testStepB\n  }\n\n  asset AssetB {\n    let B1 = fieldA\n    let B2 = fieldA.A1()\n    | testStepB\n      -> B1().testStepA,\n         B2().testStepB\n  }\n\n}\n\ncategory setOperations{\n  asset SetOpsAssetA {\n    | testStepSetOpsA\n      -> (fieldB1 \\/ fieldB2).testStepSetOpsB1,\n         (fieldB1 /\\ fieldB2).testStepSetOpsB2,\n         (fieldB1 - fieldB2).testStepSetOpsB3\n  }\n\n  asset SetOpsAssetB {\n    | testStepSetOpsB1\n\n    | testStepSetOpsB2\n\n    | testStepSetOpsB3\n  }\n}\n\nassociations {\n  // Subtype test association\n  BaseAsset [subtype_test_assoc_field1] * <-- SubtypeTestAssoc --> * [subtype_test_assoc_field2] OtherAsset\n  // Interleaved variables association\n  AssetA [fieldA] * <-- InterleaveVarsAssoc --> * [fieldB] AssetB\n  // Set operations test associationsA\n  SetOpsAssetA [fieldA1] * <-- SetOps1 --> * [fieldB1] SetOpsAssetB\n  SetOpsAssetA [fieldA2] * <-- SetOps2 --> * [fieldB2] SetOpsAssetB\n  SetOpsAssetA [fieldA3] * <-- SetOps3 --> * [fieldB3] SetOpsAssetB\n}\n"}
{"instruction": "", "input": "", "output": "category System {\n\n    asset EthernetGatewayECU extends GatewayECU\n        user info: \"Specifies a Gateway ECU that has additionaly Ethernet network capabilities.\"\n        {\n        | fullAccess\n                developer info: \"Overriding from GatewayECU\"\n                +>\ttrafficVNetworks.adversaryInTheMiddle, // This will act as Firewall and IDPS are disabled on vehicle networks\n                    trafficNetworks.adversaryInTheMiddle, // This will act as above but on the ethernet network\n                    forwarding\n\n        | forwarding\n                developer info: \"Forwarding is the lightest interaction with the gateway, where the gateway simply retransmits received messages. Vulnerabilities may, however, lead to compromise of the gateway as well as of the associated firewall. Therefore, Forwarding leads to Connect.\"\n                -> \tconnect,\n                    bypassFirewall  // If firewall is not enabled then bypass it.\n\n        & bypassFirewall\n                user info: \"If firewall is disabled, then attacker can bypass it.\"\n                ->\tgatewayBypassIDPS, // Added here to stop those attacks when firewall is enabled.\n                    gatewayNoIDPS,\n                    trafficNetworks.accessNetworkLayer\n\n        # firewallProtection // Firewall is just a defense on gateway ECU.\n                user info: \"Firewall protection comes from the existence of a correctly configured firewall.\"\n                -> bypassFirewall\n\n        | deny\n                user info: \"Perform denial of service attack on all the connected networks.\"\n                -> \ttrafficVNetworks.deny,\n                    trafficNetworks.deny\n        }\n\n    }\n\ncategory Networking {\n\n    asset Router extends Service {\n\n        | fullAccess\n                +> \ttrafficNetworks.adversaryInTheMiddle,\n                    forwarding\n\n        # correctlyConfiguredFirewallExists\n                ->\tnoFirewallProtection\n\n        | noFirewallProtection\n                user info: \"Firewall protection comes from (i) the existence of a (ii) correctly configured firewall.\"\n                -> bypassFirewall\n\n        | forwarding\n                developer info: \"Forwarding is the lightest interaction with the router, where the router simply retransmits received messages. Vulnerabilities may, however, lead to compromise of the router as well as of the associated firewall. Therefore, Forwarding leads to Connect.\"\n                -> \tnetworkConnectUninspected,\n                    networkConnectInspected,\n                    bypassFirewall\n\n        & bypassFirewall\n                ->\ttrafficNetworks.accessNetworkLayer\n\n        | deny\n                -> \ttrafficNetworks.deny\n        }\n\n    asset EthernetNetwork extends VehicleNetwork\n        user info: \"This represents the homonym network when using IPv4.\"\n        {\n        //Override\t\n        | physicalAccess\n                user info: \"Physical access currently includes close-enough-to-touch. Merged coreLang asset Network with vehicleLang asset Network\"\n                +> \tbypassPortSecurity\n        \n        | accessUninspected\n                user info: \"Access implies the possibility to submit packets over the network. In a generic network, it does not imply the possibility to listen to others' traffic on the network. You are outside the router but with a possibility to communicate in to the network.\"\n                ->\tdeny,\n                applications.networkConnectUninspected\n\n        & bypassPortSecurity\n                 -> \tbypassAccessControl\n  \n        | bypassAccessControl\n                -> \taccessDataLinkLayer\n\n        | accessDataLinkLayer\n                user info: \"Hosts with a MAC address on the network have Layer 2 access.\"\n                developer info: \"Access to data link layer (OSI layer 2) may enable eavesdropping, depending on the kind of network, as well as ARP cache poisoning either on the router side or any of the hosts on the network. (Router side ARP cache poisoning is modelled as a property on the network.)\"\n                -> \taccessNetworkLayer, \n                    aRPCachePoisoning\n  \n        | accessNetworkLayer\n                user info: \"Network layer (OSI layer 3) access implies the possibility to submit IP packets over the network. It does not imply the possibility to listen to others' trafic on the network. You are outside the router but with a possibility to communicate in to the network.\"\n                -> \tapplications.networkConnectUninspected,\n                    trafficRouters.forwarding,\n                    trafficEthGatewayECU.forwarding,\n                    deny\n  \n        & aRPCachePoisoning\n                user info: \"ARP spoofing works on all common IPv4 networks, both wirebound and wireless. For WPA2Enterprise, it can be exploited due to Hole196 (cf. https://www.cwnp.com/forums/posts?postNum=300580).\"\n                    -> \tadversaryInTheMiddle\n \n        # portSecurity\n                user info: \"You can use port security to restrict a port's ingress traffic by limiting the MAC addresses that are allowed to send traffic into the port.\"\n                developer info: \"http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst6500/ios/12-2SX/configuration/guide/book/port_sec.html\"\n                -> \tbypassPortSecurity\n\n        # staticARPTables \n                -> \taRPCachePoisoning\n\n        // Override\n        | eavesdrop\n                user info: \"Attackers can sometimes eavesdrop. Merged coreLang asset Network with vehicleLang asset Network\"\n                +> \tdataflows.eavesdrop\n        // Override\n        | adversaryInTheMiddle\n                user info: \"Attackers can sometimes intercept and tamper with communications on the IP layer. Higher-layer encryption and authentication, such as HTTPS, may still prevent the compromise of information in dataflows. Merged coreLang asset Network with vehicleLang asset Network\"\n                +> \taccessUninspected,\n                    accessDataLinkLayer,\n                    eavesdrop,\n                    dataflows.adversaryInTheMiddle,\n                    trafficRouters.deny,\n                    trafficEthGatewayECU.deny\n        // Override\n        | deny\n                user info: \"The network is made unavailable. Merged coreLang asset Network with vehicleLang asset Network\"\n                +> \tdataflows.deny\n        }\n\n}\n\nassociations {\n\n    Dataflow\t\t[realizingDataflow]\t\t\t\t* \t<-- NetworkVirtualization \t\t\t--> 0..1\t[virtualNetwork] \t\t\t\tEthernetNetwork\n    EthernetNetwork [ethernetNetworks] \t\t\t\t* \t<-- EthernetConnection \t\t\t\t--> * \t[ethernetNetworkMachines]\t\t\tMachine\n        user info: \"Physical machines can be connected to networks. If services are not explicitly connected to other networks, it is assumed that they are communicating over the physically connected one.\"\n    EthernetNetwork [trafficNetworks] \t\t\t\t* \t<-- Connection \t\t\t\t\t\t--> * \t[trafficRouters] \t\t\t\tRouter\n    EthernetNetwork [trafficNetworks] \t\t\t\t* \t<-- Connection \t\t\t\t\t\t--> * \t[trafficEthGatewayECU] \t\t\tEthernetGatewayECU\n}\n"}
{"instruction": "", "input": "", "output": "category IcsInterfaceResources{\n\n    asset HMI extends IcsApplication \n        user info: \"The Human-Machine Interface (HMI) refers to the graphical, textual and auditory information the program presents to the user (operator) using computer monitors and audio subsystems, and the control sequences the user employs to control the program.\"\n        developer info: \"https://collaborate.mitre.org/attackics/index.php/Human-Machine_Interface\"\n      {\n\n      }\n\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2019-2022 coreLang contributors <https://mal-lang.org/coreLang/contributors.html>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ncategory IAM {\n\n    abstract asset IAMObject extends Information\n      user info: \"An IAM object represents the base logic shared by all assets used for Identity and Access Management roles(Identity, Group, Privileges).\"\n    {\n      # notPresent [Disabled]\n        user info: \"This defense is used to reason about the attack vectors introduced by this asset. It should be used to model the possibility that the IAM object does not actually exist.\"\n        developer info: \"Enabling this defense should make the asset behave as if it did not exist, as such all of its impactful attack steps should be disabled by it.\"\n        ->  successfulAssume,\n            successfulLockout\n\n      | attemptAssume @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  successfulAssume\n\n      & successfulAssume @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  assume\n\n      | assume\n        user info: \"When an attacker is able to assume an IAM asset the privileges associated with it can always be exploited, other behaviour is asset specific.\"\n        ->  execPrivApps.authenticate,\n            highPrivApps.authenticate,\n            lowPrivApps.specificAccessAuthenticate,\n            readPrivData.authorizedReadFromIAM,\n            writePrivData.authorizedWriteFromIAM,\n            writePrivData.authorizedApplicationRespondConnectFromIAM,\n            deletePrivData.authorizedDeleteFromIAM,\n            managedIAMs.attemptAssume,\n            subprivileges.attemptAssume\n\n      | deny\n        user info: \"Denying Identity, Group, or Privileges means that they are unavailable to legitimate users and which may be locked out as a result.\"\n        +>  attemptLockout\n\n      | write\n        user info: \"Overwriting Identity, Group, or Privileges means that the attacker is able to assume them.\"\n        +>  attemptAssume\n\n      | attemptLockout @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  successfulLockout\n\n      & successfulLockout @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  lockout\n\n      | lockout {A}\n        user info: \"The Identity, Group, or Privileges has been locked out and cannot be used by legitimate users. This means that the applications that they can execute and data they can read might also be denied if all of the access roles that could execute or read them, respectively, have been locked out.\"\n        ->  execPrivApps.denyFromLockout,\n            readPrivData.denyFromLockout,\n            subprivileges.lockout\n    }\n\n    asset Identity extends IAMObject\n      user info: \"An identity models an IAM identity that should then be associated with privileges on other instances.\"\n      developer info: \"An identity can be visualised as a group of assumable roles that can be associated with many credentials.\"\n    {\n      # notPresent [Disabled]\n        user info: \"Prevent unsafe user activity too if the Identity is assumed to not exist.\"\n        +>  successfulUnsafeUserActivity\n\n      | assume {C,I,A}\n        user info: \"After authentication or compromise of an account/identity, assume its privileges.\"\n        developer info: \"This is both legitimate and illegitimate access! Also assume all the privileges of the parent identities (on the above level/inherited by this identity) because those represent the group of (inherited) roles.\"\n        +>  parentId.attemptAssume,\n            memberOf.attemptAssume\n\n      & lockoutFromCredentials @hidden\n        developer info: \"Only lockout an identity if all of the Credentials that could be used to authenticate have been denied.\"\n        ->  attemptLockout\n\n      | lockout\n        user info: \"If all of the Identities belonging to a Group are lockedout we assume that the Group as a whole is lockedout.\"\n        +>  memberOf.lockoutFromMembers\n\n      !E missingUser @hidden\n        developer info: \"If there are no Users asociated with this Identity we make the worst case scenario assumption regarding the strength of the Credentials belonging to it.\"\n        <-  users\n        ->  credentials.weakCredentials\n\n      | attemptUnsafeUserActivity @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  successfulUnsafeUserActivity\n\n      & successfulUnsafeUserActivity @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  unsafeUserActivity\n\n      | unsafeUserActivity\n        user info: \"Propagate unsafe user activity to any Applications or subset of privileges associated with this Identity.\"\n        ->  execPrivApps.attemptUnsafeUserActivity,\n            highPrivApps.attemptUnsafeUserActivity,\n            lowPrivApps.attemptUnsafeUserActivity,\n            subprivileges.attemptUnsafeUserActivity\n    }\n\n    asset Privileges extends IAMObject\n      user info: \"A privileges asset can be associated with another IAMObject to reason about a specific subset of given privileges on Applications and Data.\"\n      modeler info: \"The privileges asset is not meant to be used normally when assigning permissions. Identities and Groups should be directly associated with the relevant assets. The purpose of the Privileges asset is to be used as a speculative asset when reasoning about additional privileges that a particular Group or Identity may have as a result of either poor configurations or the attacker's actions.\"\n    {\n      # notPresent [Disabled]\n        user info: \"Prevent unsafe user activity too if the Privileges are assumed to not exist.\"\n        +>  successfulUnsafeUserActivity\n\n      | assume {C,I,A}\n        user info: \"After authentication or compromise assume its privileges.\"\n        developer info: \"Assume identity/group the privileges are associated with since the privileges are simply an extension of it.\"\n        +>  IAMOwners.attemptAssume\n\n      | attemptUnsafeUserActivity @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  successfulUnsafeUserActivity\n\n      & successfulUnsafeUserActivity @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  unsafeUserActivity\n\n      | unsafeUserActivity\n        user info: \"Propagate unsafe user activity to any Applications or subset of privileges associated with these Privileges.\"\n        ->  execPrivApps.attemptUnsafeUserActivity,\n            highPrivApps.attemptUnsafeUserActivity,\n            lowPrivApps.attemptUnsafeUserActivity,\n            subprivileges.attemptUnsafeUserActivity\n    }\n\n    asset Group extends IAMObject\n      user info: \"A group is a way to group together identities and/or other groups. This allows the expression of hierarchical IAM (structured inheritance).\"\n      modeler info: \"Groups can be used instead of nested identities to make the model more intuitive and clearer to understand.\"\n    {\n      | assume {C,I,A}\n        user info: \"If an identity of a group is compromised then the whole group(i.e. all other privileges of the group) should be considered as compromised. Furthermore, the parent groups should also be considered compromised.\"\n        developer info: \"The parent groups should be compromised because all the privileges of the parent groups are inherited on the children groups but lower children groups should not be compromised because lower levels might have inherited plus additional privileges.\"\n        +>  parentGroup.attemptAssume\n\n      & lockoutFromMembers @hidden\n        developer info: \"If all of the Identities belonging to a Group are lockedout we assume that the Group as a whole is lockedout.\"\n        ->  attemptLockout\n    }\n\n    asset Credentials extends Information\n      user info: \"Credentials can be used to get access to an Identity, but they can also be used as an encryption/signing key for Data.\"\n      modeler info: \"Credentials represent a variety of access control mechanism(e.g. username and password pair, keycards, biometric data).\"\n    {\n      # notDisclosed [Enabled]\n        user info: \"Describes the case where the password/credential is leaked to some location, it can then be available to the attacker.\"\n        ->  useLeakedCredentials\n\n      # notGuessable [Enabled]\n        user info: \"Describes if the credentials can be guessed by the attacker(i.e. they represent a password or passphrase).\"\n        ->  guessCredentials\n\n      # unique [Enabled]\n        user info: \"Describes if the credentials are known to be unique and therefore cannot be used in a credentials reuse attack.\"\n        ->  credentialsReuse,\n            propagateOneCredentialCompromised\n\n      # notPhishable [Disabled]\n        user info: \"Describes if the credentials cannot be phished(they are biometric, e.g. fingerprints or iris scans, or physical, e.g. access cards or keys, elements).\"\n        ->  credentialTheft\n\n      | read\n        user info: \"If the attacker is able to read the information containing credentials we assume that they are compromised.\"\n        +> attemptUse\n\n      | write\n        user info: \"If the attacker is able to write the information containing credentials we assume that they have changed them for the authentication process.\"\n        +> attemptUse\n\n      | deny\n        user info: \"If the attacker is able to deny the information containing credentials we assume that they have denied them for the authentication process.\"\n        +> identities.lockoutFromCredentials\n\n      | useLeakedCredentials [EasyAndCertain]\n        user info: \"If the password/credential is leaked to some location, it can then be available to the attacker and therefore it can be used.\"\n        ->  attemptUse\n\n      | attemptCredentialsReuse @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  credentialsReuse,\n            requiredFactors.attemptCredentialsReuse\n\n      & credentialsReuse @hidden\n        developer info: \"The user is reusing credentials which means that the attacker is able to compromise all of the non-unique credentials associated with this user.\"\n        ->  attemptUse\n\n      | attemptUse @hidden\n        developer info: \"In order to use these credentials the attacker may require additional factors.\"\n        ->  use\n\n      & use {C}\n        user info: \"The attacker is using the credentials to perform a legitimate authentication.\"\n        ->  identities.attemptAssume,\n            encryptedData.accessDecryptedData,\n            signedData.accessSpoofedData,\n            attemptPropagateOneCredentialCompromised,\n            credentials.use, // these credentials may serve as additional required factors for other credentials in a multi-factor authentication\n            hashes.attemptUse, // the hashes generated based on these credentials are also compromised as the attacker is assumed to know which hashing functions were used\n            origCreds.guessCredentialsFromHash\n\n      | attemptPropagateOneCredentialCompromised @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  propagateOneCredentialCompromised\n\n      & propagateOneCredentialCompromised @hidden\n        developer info: \"Intermediate step used to propagate the credentials reuse attack step.\"\n        ->  credentials*.identities.users.oneCredentialCompromised\n\n      | attemptCredentialTheft @hidden\n        developer info: \"The attacker is attempting to access the credentials.\"\n        ->  credentialTheft,\n            requiredFactors.attemptCredentialTheft\n\n      & credentialTheft @hidden\n        developer info: \"The attacker is able to steal the credentials.\"\n        ->  attemptUse\n\n      !E missingIdentity @hidden\n        developer info: \"If there are no Identities asociated with these Credentials we make the worst case scenario assumption regarding the strength of the Credentials.\"\n        <-  identities\n        ->  weakCredentials\n\n      | weakCredentials @hidden\n        developer info: \"Intermediate step used to represent how weak the credentials the user employs are. This is inversely related to the securityAwareness defense on the User asset associated with the Identity to which these Credentials belong. If either the User or Identity associations are missing the assumption is made that the crentials are weak and therefore guessable by the attacker.\"\n        ->  guessCredentials,\n            requiredFactors.weakCredentials\n\n      !E credsHashed @hidden\n        developer info: \"If there are no associated hashes the assumption is that the credentials are guessable without any additional requirements.\"\n        <-  hashes\n        ->  guessCredentialsFromHash\n\n      | guessCredentialsFromHash @hidden\n        developer info: \"If hashes are associated with this Credentials asset the assumption is that one of those hashes is required by the attacker to be able to perform a guessing attack.\"\n        ->  guessCredentials\n\n      & guessCredentials @hidden [HardAndUncertain]\n        developer info: \"The attacker can try to just guess a set of credentials. The likelihood of succeeding is dependent on how strong the credentials are.\"\n        modeler info: \"The guessability of the Credentials is influenced by the notGuessable defense on this asset and the securityAwareness defense on the User associated with the Identity that these Credentials belong to. If either the User or Identity associations are missing the assumption is made that the crentials are guessable and only the notGuessable defense would play a role in restricting this attack step.\"\n        ->  attemptUse\n    }\n}\n\nassociations {\n  Credentials      [encryptCreds]      0..1 <-- EncryptionCredentials --> *    [encryptedData]          Data\n      user info: \"Encrypted data can be associated with the relevant encryption credentials.\"\n  Credentials      [signingCreds]      0..1 <-- SigningCredentials    --> *    [signedData]             Data\n      user info: \"Signed data can be associated with the relevant signing credentials.\"\n  Credentials      [hashes]               * <-- HashedCredentials     --> 0..1 [origCreds]              Credentials\n      user info: \"Credentials can be associated with their hashed counterparts. Multiple hashes can be generated for the same Credentials, but a hash is unique to one set of Credentials.\"\n  Credentials      [credentials]          * <-- ConditionalAuthentication --> * [requiredFactors]       Credentials\n      user info: \"Credentials can be associated with other Credentials to depict conditional authentication procedures, such as multi-factor authentication.\"\n  // ### Access Control happens below\n  Identity         [identities]           * <-- IdentityCredentials   --> *    [credentials]            Credentials\n  Identity         [parentId]             * <-- CanAssume             --> *    [childId]                Identity\n      user info: \"Starting from a parent Identity, the child Identities can be assumed due to inheritance.\"\n  Group            [memberOf]             * <-- MemberOf              --> *    [groupIds]               Identity\n  Group            [parentGroup]          * <-- MemberOf              --> *    [childGroups]            Group\n  // Then, Access Control on application level\n  IAMObject        [executionPrivIAMs]    * <-- ExecutionPrivilegeAccess       --> * [execPrivApps]     Application\n      user info: \"Every application executes on a system with privileges of a specified identity on the system. If the application is compromised then the privileges should be compromised.\"\n  IAMObject        [highPrivAppIAMs]      * <-- HighPrivilegeApplicationAccess --> * [highPrivApps]     Application\n      user info: \"High privilege application access on an Application results in the (full) access/compromise of the application and all the child applications.\"\n  IAMObject        [lowPrivAppIAMs]       * <-- LowPrivilegeApplicationAccess  --> * [lowPrivApps]      Application\n      user info: \"Low privilege application access on an Application allows only the local interaction with the application and all the specified privileges.\"\n  // Finally, Access control on data\n  IAMObject        [readingIAMs]          * <-- ReadPrivileges        --> *    [readPrivData]           Data\n  IAMObject        [writingIAMs]          * <-- WritePrivileges       --> *    [writePrivData]          Data\n  IAMObject        [deletingIAMs]         * <-- DeletePrivileges      --> *    [deletePrivData]         Data\n  // Associations for the Privileges asset\n  IAMObject        [IAMOwners]            * <-- HasPrivileges         --> *    [subprivileges]          Privileges\n      user info: \"Identities, Groups, and Privileges may have a subset of Privileges that we logically separate to model specific scenarios, such as partial lockouts or speculating about possible privileges.\"\n  // Self-referential associations for the IAMObject asset\n  IAMObject        [managers]             * <-- AccountManagement     --> *    [managedIAMs]            IAMObject\n      user info: \"Identities, Groups, and Privileges may have account management roles for other Identities, Groups, and Privileges.\"\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2019-2022 coreLang contributors <https://mal-lang.org/coreLang/contributors.html>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ncategory DataResources {\n\n    asset Information\n      user info: \"Represents any type of information that might be contained inside Data. This include general purpose information, but also serves as the basis for more specialized types, such as Credentials and SoftwareProduct. Information represents the abstract concept, while Data represent an actual instance of information stored or transmitted digitally.\"\n    {\n      | read\n        user info: \"The attacker is able to read the information. They may still be unable to extract it, which represents the adversary being able to read it themselves. This is the case if autonomous code is able to read it, but lack the required networking connections to transmit it back to the adversary.\"\n        ->  dataReplicas.read,\n            containerData.read\n\n      | write\n        user info: \"The attacker is able to write the information.\"\n        ->  dataReplicas.write,\n            containerData.write,\n            dependentApps.fullAccess,\n            delete\n\n      | delete\n        user info: \"The attacker is able to delete the information.\"\n        ->  dataReplicas.delete,\n            containerData.delete,\n            deny\n\n      | deny\n        user info: \"The attacker is able to deny the information.\"\n        ->  dataReplicas.deny,\n            containerData.deny,\n            dependentApps.deny\n\n      | extract\n        user info: \"The attacker is able to extract the information. This means that they have a path available through which they can transfer the information back to a system that they control.\"\n\n      // The following 5 attack steps are used to implement data replication\n      | attemptReadFromReplica @hidden\n        developer info: \"Reading one replica allows the attacker to read all other replicas as well since the information contained in them is the same.\"\n        ->  read\n\n      & attemptWriteFromReplica @hidden\n        developer info: \"Information can be overwritten only if all replicas have been overwritten.\"\n        ->  write\n\n      & attemptDeleteFromReplica @hidden\n        developer info: \"Information can be deleted only if all replicas have been deleted.\"\n        ->  delete\n\n      & attemptDenyFromReplica @hidden\n        developer info: \"Information can be denied only if all replicas have been denied.\"\n        ->  deny\n\n      | attemptExtractFromReplica @hidden\n        developer info: \"The attacker attempts to extract the information.\"\n        ->  extract\n    }\n\n    asset Data\n      user info: \"Any form of data that can be stored or transmitted.\"\n    {\n      # notPresent [Disabled]\n        user info: \"This defense is used to reason about the attack vectors introduced by this asset. It should be used to model the possibility of data not existing on the associated container (i.e. Hardware, Application, Network, etc.).\"\n        developer info: \"Enabling this defense should make the asset behave as if it did not exist, as such all of its impactful attack steps should be disabled by it.\"\n        ->  applicationRespondConnect,\n            successfulRead,\n            successfulWrite,\n            successfulDeny,\n            successfulDelete,\n            reverseReach,\n            extract\n\n      | authorizedAccessFromApplication @hidden\n        developer info: \"Try to gain access to the data through permissions.\"\n        ->  authorizedReadFromApplication,\n            authorizedWriteFromApplication,\n            authorizedDeleteFromApplication\n\n      !E dataEncrypted @hidden\n        developer info: \"If the data are encrypted then accessing them requires the associated encryption credentials/key. Data will be considered encrypted if there is at least one Credentials instance associated with it. Otherwise, 'accessUnencryptedData' is triggered.\"\n        <-  encryptCreds\n        ->  accessUnencryptedData\n\n      !E dataSigned @hidden\n        developer info: \"If the data are signed then writing them requires the associated signing credentials/key. Data will be considered signed if there is at least one Credentials asset associated with it. Otherwise, 'accessUnsignedData' is triggered.\"\n        <-  signingCreds\n        ->  accessUnsignedData\n\n      E payloadInspectionBypassFromEncryptedData @hidden\n        developer info: \"If the data are encrypted then payload inspection cannot be performed on the connection rules they are transmitted over.\"\n        <-  encryptCreds\n        ->  bypassPayloadInspectionFromEncryptedData\n\n      let senderOutgoingApplicationConnections = (senderApp.appConnections \\/ senderApp.outgoingAppConnections)\n      let receiverIngoingApplicationConnections = (receiverApp.appConnections \\/ receiverApp.ingoingAppConnections)\n      let transitNetworkInboundAllowedConnections = (transitNetwork.netConnections \\/ transitNetwork.ingoingNetConnections \\/ transitNetwork.diodeIngoingNetConnections)\n      let transitNetworkOutboundAllowedConnections = (transitNetwork.netConnections \\/ transitNetwork.outgoingNetConnections)\n      | bypassPayloadInspectionFromEncryptedData @hidden\n        developer info: \"The connection rules that the encrypted data traverse over cannot provide payload inspection since they are assumed to permit encrypted traffic. This implies that the attacker could simply encrypt their own communications to evade inspection.\"\n        ->  (senderOutgoingApplicationConnections() /\\ transitNetworkInboundAllowedConnections()).payloadInspectionBypassed,\n            (receiverIngoingApplicationConnections() /\\ transitNetworkOutboundAllowedConnections()).payloadInspectionBypassed\n\n      & accessUnencryptedData @hidden\n        developer info: \"If data are unencrypted then access them.\"\n        ->  accessDecryptedData\n\n      & accessUnsignedData @hidden\n        developer info: \"If data are unsigned then alter them.\"\n        ->  accessSpoofedData\n\n      | accessSpoofedData @hidden\n        developer info: \"Intermediate attack step to only allow effects of 'accessUnsignedData' on data after compromising the signing credentials or signing is disabled.\"\n        ->  applicationRespondConnect,\n            successfulWrite\n\n      | accessDecryptedData @hidden\n        developer info: \"Intermediate attack step to only allow effects of 'accessUnencryptedData' on data after compromising the encryption credentials or encryption is disabled.\"\n        ->  applicationRespondConnect,\n            successfulRead,\n            successfulWrite,\n            successfulDelete\n\n      | attemptApplicationRespondConnect @hidden\n        developer info: \"Intermediate attack step to handle defenses.\"\n        ->  applicationRespondConnect\n\n      & applicationRespondConnect @hidden\n        developer info: \"In order to perform a respond connect attack the adversary must be able to write the received data.\"\n        ->  senderApp.attemptNetworkConnectFromResponse,\n            containedData.applicationRespondConnect\n\n      | authorizedApplicationRespondConnectFromApplication @hidden\n        developer info: \"The adversary can attempt a respond connect attack from an Application, but they still require write permissions in order to perform it.\"\n        ->  authorizedApplicationRespondConnect\n\n      | authorizedApplicationRespondConnectFromIAM @hidden\n        developer info: \"The attacker has obtained the access control permissions required to modify the incoming requests.\"\n        ->  authorizedApplicationRespondConnect\n\n      & authorizedApplicationRespondConnect @hidden\n        developer info: \"In order to perform a respond connect attack the adversary must be able to write the received data. If they only have specific access on the Application we need to see if they also have the required permissions.\"\n        ->  attemptApplicationRespondConnect\n\n      | attemptRead @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  successfulRead\n\n      & successfulRead @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  read\n\n      | read {C}\n        user info: \"The attacker can read the data. This means that the data can be used for further attack steps, but they are not necessarily obtained by the attacker. The extract attack step covers the scenario where the attacker actually collects the data.\"\n        ->  containedData.attemptRead,\n            information.read,\n            replicatedInformation.attemptReadFromReplica,\n            extract\n\n      | authorizedReadFromIAM @hidden\n        developer info: \"The attacker has obtained the access control permissions required to read the data.\"\n        ->  authorizedRead\n\n      | authorizedReadFromApplication @hidden\n        developer info: \"The attacker can reach the data via an Application, but they still require the adequate permissions to read it.\"\n        ->  authorizedRead\n\n      & authorizedRead @hidden\n        developer info: \"An attacker is able to read the Data through authorized permissions, this requires both access to the Data and the adequate permissions.\"\n        ->  attemptRead\n\n      | attemptWrite @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  successfulWrite\n\n      & successfulWrite @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  write\n\n      | write {I}\n        user info: \"The attacker can write to the location of the data, effectively modifying or deleting it.\"\n        ->  containedData.attemptWrite,\n            information.write,\n            replicatedInformation.attemptWriteFromReplica,\n            dependentApps.fullAccess,\n            attemptDelete\n\n      | authorizedWriteFromIAM @hidden\n        developer info: \"The attacker has obtained the access control permissions required to write the data.\"\n        ->  authorizedWrite\n\n      | authorizedWriteFromApplication @hidden\n        developer info: \"The attacker can reach the data via an Application, but they still require the adequate permissions to write it.\"\n        ->  authorizedWrite\n\n      & authorizedWrite @hidden\n        developer info: \"An attacker is able to write the Data through authorized permissions, this requires both access to the Data and the adequate permissions.\"\n        ->  attemptWrite\n\n      | attemptDelete @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        -> successfulDelete\n\n      & successfulDelete @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  delete\n\n      | delete {I,A}\n        user info: \"The attacker can delete the data.\"\n        ->  containedData.attemptDelete,\n            information.delete,\n            replicatedInformation.attemptDeleteFromReplica,\n            attemptDeny\n\n      | authorizedDeleteFromIAM @hidden\n        developer info: \"The attacker has obtained the access control permissions required to delete the data.\"\n        ->  authorizedDelete\n\n      | authorizedDeleteFromApplication @hidden\n        developer info: \"The attacker can reach the data via an Application, but they still require the adequate permissions to delete it.\"\n        ->  authorizedDelete\n\n      & authorizedDelete @hidden\n        developer info: \"An attacker is able to delete the Data through authorized permissions, this requires both access to the Data and the adequate permissions.\"\n        ->  attemptDelete\n\n      | attemptDeny @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  successfulDeny\n\n      & successfulDeny @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  deny\n\n      | deny {A}\n        user info: \"If a DoS is performed data are denied, it has the same effects as deleting the data.\"\n        ->  containedData.attemptDeny,\n            information.deny,\n            replicatedInformation.attemptDenyFromReplica,\n            dependentApps.deny\n\n      & denyFromLockout @hidden\n        developer info: \"This is an intermediate attack step to only trigger deny on data when all the access control roles that can read them are locked out.\"\n        ->  attemptDeny\n\n      | attemptReverseReach @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  reverseReach\n\n      & reverseReach @hidden\n        developer info: \"Reverse reach for Data is used to determine whether or not the data can be transferred to attacker.\"\n        ->  extract,\n            containedData.attemptReverseReach\n\n      & extract\n        user info: \"The attacker can extract the data. The read attack step represents just being able to make use of the data for further attack steps without the attacker obtaining it.\"\n        ->  information.extract,\n            replicatedInformation.attemptExtractFromReplica\n    }\n}\n\nassociations {\n  // ### Data related associations\n  Data        [containingData]       * <-- DataContainment       --> *    [containedData]          Data\n      user info: \"Data can be contained inside other data.\"\n  Data        [containedData]        * <-- AppContainment        --> *    [containingApp]          Application\n      user info: \"An application should be able to contain some data.\"\n  Data        [sentData]             * <-- SendData              --> *    [senderApp]              Application\n      user info: \"An application can also send some data that are supposed to be transferred over a network or connection. This expresses an active connection.\"\n  Data        [receivedData]         * <-- ReceiveData           --> *    [receiverApp]            Application\n      user info: \"An application can also receive some data that are supposed to be transferred over a network or connection. This expresses an active connection.\"\n  Data        [transitData]          * <-- DataInTransit         --> *    [transitNetwork]         Network\n      user info: \"A network can also contain some data that are supposed to be network-wide available.\"\n  Data        [hostedData]           * <-- DataHosting           --> 0..1 [hardware]               Hardware\n      user info: \"Data can be hosted on hardware.\"\n  Data        [containerData]        * <-- InfoContainment       --> *    [information]            Information\n      user info: \"Data can contain information, as for example credentials.\"\n  Data        [dataReplicas]         * <-- Replica               --> *    [replicatedInformation]  Information\n      user info: \"Information can be replicated across multiple data assets that offer redundancy.\"\n  // ### Application dependence associations\n  /* Dependence is used to represent various situations where the operations\n   * of the Application are impacted by modifying/denying the Data/Information\n   * it depends upon. Examples of this type of behavior are configurations,\n   * plugins, libraries, or other input data that is critical to the purpose\n   * of the software component represented by the Application. This\n   * association should only be used for circumstances where the workflow of\n   * the Application is not altered, but the Data/Information are modified\n   * within the regular operating process. For situations where abnormal\n   * behaviour is induced to impact the Application SoftwareVulnerabilities\n   * should be used instead.\n   */\n  Data        [dataDependedUpon]     * <-- Dependence            --> *    [dependentApps]         Application\n      user info: \"Data can be specified as a dependence for an Application.\"\n  Information [infoDependedUpon]     * <-- Dependence            --> *    [dependentApps]         Application\n      user info: \"Information can be specified as a dependence for an Application.\"\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2020-2022 Foreseeti AB <https://foreseeti.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n#id: \"org.mal-lang.examplelang\"\n#version: \"1.0.0\"\n\ncategory System {\n  asset Network {\n    | access\n      -> hosts.connect\n  }\n\n  asset Host {\n    | connect\n      -> access\n    | authenticate\n      -> access\n    | guessPassword\n      -> guessedPassword\n    | guessedPassword [Exponential(0.02)]\n      -> authenticate\n    & access\n  }\n\n  asset User {\n    | attemptPhishing\n      -> phish\n    | phish [Exponential(0.1)]\n      -> passwords.obtain\n  }\n\n  asset Password {\n    | obtain\n      -> host.authenticate\n  }\n}\n\nassociations {\n  Network [networks] * <-- NetworkAccess --> * [hosts] Host\n  Host [host] 1 <-- Credentials --> * [passwords] Password\n  User [user] 1 <-- Credentials --> * [passwords] Password\n}"}
{"instruction": "", "input": "", "output": "category IcsControlResources{\n\n    asset SIS extends IcsHardware\n        user info: \"A safety instrumented system (SIS) takes automated action to keep a plant in a safe state, or to put it into a safe state, when abnormal conditions are present.\"\n        developer info: \"https://collaborate.mitre.org/attackics/index.php/Safety_Instrumented_System/Protection_Relay\"\n      {\n        | shutdown @Override\n            +> safeguardedSystem.loss_
{"instruction": "", "input": "", "output": "category IcsControlResources{\n\n    asset SIS extends IcsHardware\n        user info: \"A safety instrumented system (SIS) takes automated action to keep a plant in a safe state, or to put it into a safe state, when abnormal conditions are present.\"\n        developer info: \"https://collaborate.mitre.org/attackics/index.php/Safety_Instrumented_System/Protection_Relay\"\n      {\n        | shutdown @Override\n            +> safeguardedSystem.lossOfSafety\n\n        # notDisabled @Override [Enabled]\n          developer info: \"The probability that a particular SIS is not actually present.\"\n          modeler info: \"The use cases for this are removing the SIS safeguarding an IcsHardware and removing redundant SIS subsystems.\"\n          -> safeguardedSystem.safetyMechanismsOffline,\n             triggerPropagateRedundantShutdown\n\n      }\n\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2019-2022 coreLang contributors <https://mal-lang.org/coreLang/contributors.html>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n#id: \"org.mal-lang.coreLang\"\n#version: \"1.0.0\"\n\ninclude \"coreLang.mal\"\n"}
{"instruction": "", "input": "", "output": "category System {\n\n    asset InfotainmentSystem extends Machine\n        user info: \"Represents the information & entertainment system found on all modern cars. It is a machine which can be connected to one or more networks.\"\n        developer info: \"It has the same functionality as a machine plus one additional attack step that is reached only when the NetworkAccessService is compromised.\"\n        {\n        | fullAccess\n                developer info: \"Adding one new connected attack step\"\n                +>  engineerNetworkAccess\n\n        | gainNetworkAccess\n                user info: \"If this attack step is reached then full network layer access is gained by the attacker.\"\n                ->\tconnectedNetworks.accessNetworkLayer\n\n        | engineerNetworkAccess [Exponential(10.0)]\n                user info: \"This attack step is another way to reach full network access if there is no network access service on the infotainment system, but it requires effort!\"\n                ->\tconnectedNetworks.accessNetworkLayer\n        }\n\n    asset NetworkAccessService extends NetworkService\n        user info: \"This service might run on an infotainment system and if compromised allows the attacker to access the networks connected to it.\"\n        {\n        | fullAccess\n                +>\thostMachine.gainNetworkAccess\n        }\n}\n\ncategory Communication {\n\n    asset OBD2Connector\n        user info: \"Represents the OBD-II connector available in all modern cars and most vehicles in general.\"\n        {\n        | physicalAccess\n                user info: \"Physical access to the connector leads to access on the network layer.\"\n                ->\tinterfacingNetworks.accessNetworkLayer\n\n        | connect\n                -> bypassConnectorProtection,\n                _connectNoProtection\n\n        | bypassConnectorProtection [Exponential(20.0)]\n                user info: \"Remove or bypass objects blocking the OBD connector, for example ripping of protective plate or ganining access to driver cabin. Requires effort\"\n                ->\tphysicalAccess\n\n        & _connectNoProtection\n                -> \tphysicalAccess\n\n        # connectorAccessProtection\n                user info: \"Any type of physical entity blocking attackers from physically connecting to the OBD-II port. For example a protective plate covering the port or port being placed where it's difficult to access.\"\n                ->\t_connectNoProtection\n        }\n\n    asset ChargingPlugConnector\n        user info: \"The charging plug on many electric vehicles provides direct CAN bus access, while on others is only connected to the same network as the Battery Management System (BMS) ECU.\"\n        developer info: \"Florian Sagstetter, Security Challenges in Automotive Hardware/Software Architecture Design (2013)\"\n        {\n        | physicalAccess\n                user info: \"No matter the case, physical access to the connector leads to access on the network layer of the connected network.\"\n                ->\tconnectedNetwork.accessNetworkLayer\n        }\n\n    asset AftermarketDongle\n        user info: \"An aftermarket dongle is a device that connects to the OBD-II port and provides some additional functionality to the vehicle's owner (e.g. error log reading, vehicle configuration, etc.\"\n        {\n        | connectDongle\n                user info: \"When a dongle is connected, the connect attack step is reached on OBD-II connector.\"\n                ->\t_connectToNetwork\n\n        & _connectToNetwork\n                ->\tconnector.connect\n\n        # dongleIsHardened\n                user info: \"If the firmware on the connected dongle cannot be modified by the attacker, then access on the network layer cannto be achieved.\"\n                developer info: \"This defense might look more logical in the future where an external attacker will be able to use the dongle as an entry point in the vehicle.\"\n                ->\t_connectToNetwork\n        }\n}\n\nassociations {\n    VehicleNetwork      [interfacingNetworks]\t\t* <-- Interface         -->\t0..1\t[connector]     OBD2Connector\n    VehicleNetwork\t[connectedNetwork]\t\t0..1 <-- Connections    --> 0..1\t[chargingPlug]  ChargingPlugConnector\n    OBD2Connector       [connector]\t\t\t0..1 <-- Connection     --> 0..1\t[dongle]        AftermarketDongle\n    VehicleNetwork      [connectedNetworks] \t\t* <-- Connection        --> *           [infotainment]  InfotainmentSystem\n}\n"}
{"instruction": "", "input": "", "output": "#id: \"org.mal-lang.scllang\"\n#version: \"1.0.0\"\n\ncategory Functional {\n        asset Substation {\n        }\n        asset Transformer {\n\t\t\t\t| execution\n        }\n        asset VoltageLevel {\n        }\n        asset Bay {\n        }\n        asset Equipment {\n                | execution\n        }\n        asset SubEquipment {\n\t\t\t\t| execution\n        }\n        asset ConnectivityNode {\n\t\t\t\t| communicate\n\t\t\t\t\t\t-> logicalNode.impact\n        }\n        asset Terminal {\n\t\t\t\t| communicate\n\t\t\t\t\t\t-> equipment.execution,\n\t\t\t\t\t\t\tconNode.communicate\n        }\n        asset Function {\n\t\t\t\t| access\n                        -> execution\n                | execution\n                        -> logicalNode.impact\n        }\n        asset Subfunction {\n                | access\n                        -> execution\n                | execution\n                        -> logicalNode.impact\n        }\n}\ncategory Product {\n        asset LogicalDevice {\n\t\t\t\t| impact\n\t\t\t\t\t-> logicalNode.impact\n\t\t\n        }\n        asset LogicalNode {\n                | impact\n                        -> equipment.execution,\n\t\t\t\t\t\t\tsubEquipment.execution,\n\t\t\t\t\t\t\ttransformer.execution,\n\t\t\t\t\t\t\tdata.impact\n        }\n        asset IED {\n                | access\n\t\t\t\t\t\t-> communicate\n\t\t\t\t& communicate\n\t\t\t\t\t\t-> accessPoint.communicate\n\t\t\t\tE hasRouter\n\t\t\t\t\t\t<- accessPoint.router\n\t\t\t\t\t\t-> communicate\t\t\t\t\n        }\n        asset Server {\n\t\t\t\t| communicate\n\t\t\t\t\t\t-> accessPoint.communicate,\n\t\t\t\t\t\t\tlogicalDev.impact\n        }\n        asset Data {\n                | impact\n                        -> logicalNode.impact\n        }\n        asset Router {\n                | communicate\n\t\t\t\t\t\t-> accessPoint.communicate\n\t\t}\n        asset Clock {\n                | impact\n\t\t\t\t| communicate\n\t\t\t\t\t\t-> accessPoint.communicate\n        }\n}\ncategory Communication {\n        asset SubNetwork {\n\t\t\t\t| access\n\t\t\t\t\t\t-> accessPoint.communicate\n        }\n        asset AccessPoint {\n\t\t\t\t| communicate\n\t\t\t\t\t\t-> logicalNode.impact,\n\t\t\t\t\t\t\tserver.communicate,\n\t\t\t\t\t\t\tied.access,\n\t\t\t\t\t\t\tsubNet.access,\n\t\t\t\t\t\t\trouter.communicate,\n\t\t\t\t\t\t\tclock.communicate,\n\t\t\t\t\t\t\tclock.impact\n        }\n}\nassociations {\n        Clock [clock] 0..1 <-- Communication --> 1 [accessPoint] AccessPoint\n        Function [function] * <-- Communication --> * [logicalNode] LogicalNode\n        IED [ied] 1 <-- Communication --> 1..* [accessPoint] AccessPoint\n        LogicalDevice [logicalDev] 1 <-- Contains --> * [logicalNode] LogicalNode\n        LogicalDevice [logicalDev] 1..* <-- HostedOn --> 1 [server] Server\n        LogicalNode [logicalNode] * <-- Communication --> * [accessPoint] AccessPoint\n        LogicalNode [logicalNode] 1 <-- Handles --> 1..* [data] Data\n        LogicalNode [logicalNode] * <-- Communication --> 1 [conNode] ConnectivityNode\n        LogicalNode [logicalNode] * <-- Communication --> 1 [transformer] Transformer\n        LogicalNode [logicalNode] * <-- Communication --> * [equipment] Equipment\n        LogicalNode [logicalNode] * <-- Communication --> * [subEquipment] SubEquipment\n        Router [router] 0..1 <-- Communication --> 1 [accessPoint] AccessPoint\n        Server [server] 0..1 <-- Communication --> 1..* [accessPoint] AccessPoint\n        Subfunction [subfunction] * <-- Communication --> * [logicalNode] LogicalNode\n        SubNetwork [subNet] 1 <-- Has --> 1..* [accessPoint] AccessPoint\n        Terminal [terminal] * <-- Communication --> 1 [equipment] Equipment\n        Terminal [terminal] * <-- Communication --> 1 [conNode] ConnectivityNode\n}\n\n\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2019-2022 coreLang contributors <https://mal-lang.org/coreLang/contributors.html>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ncategory User {\n\n    asset User\n      user info: \"This asset represents the user themselves. It is the suitable attack surface for social engineering attacks.\"\n    {\n      # noPasswordReuse [Enabled]\n        user info: \"If one credential of that user is compromised there is a probability that all other credentials of that user are also compromised.\"\n        ->  passwordReuseCompromise\n\n      # noRemovableMediaUsage [Enabled]\n        user info: \"The user does not utilise removable media and therefore the attack steps associated with it cannot be reached.\"\n        ->  successfulDeliverMaliciousRemovableMedia\n\n      # securityAwareness\n        user info: \"The security awareness of the user makes it less likely that social engineering would be successful and reduces the likelihood that the user will engage in unsafe behaviour.\"\n        ->  securityAwarenessBypassed,\n            weakCredentials\n\n      | bypassSecurityAwareness [VeryHardAndUncertain]\n        user info: \"Security awareness can be bypassed.\"\n        ->  securityAwarenessBypassed\n\n      | securityAwarenessBypassed @hidden\n        developer info: \"Security awareness is bypassed either because it was not set, the attacker was able to circumvent it through additional effort, or we simply assume that everyone has an off day every now and then.\"\n        ->  successfulSocialEngineering,\n            successfulDeliverMaliciousRemovableMedia\n\n      | oneCredentialCompromised @hidden\n        developer info: \"This intermediate attack step is needed in order to block passwordReuseCompromise when no other credential is first compromised.\"\n        ->  passwordReuseCompromise\n\n      & passwordReuseCompromise @hidden\n        developer info: \"If one reused credential of that user is compromised then, all other credentials of that user can also be compromised.\"\n        ->  userIds.credentials.attemptCredentialsReuse\n\n      | weakCredentials @hidden\n        developer info: \"Intermediate attack step that defines the strength of all of the Credentials associated with the user. This is inversely proportional with the user's securityAwareness defense.\"\n        ->  userIds.credentials.weakCredentials\n\n      | attemptSocialEngineering @entrypoint\n        user info: \"An attacker can try to perform social engineering techniques such as phishing and inducing the user to perform malicious actions.\"\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        modeler info: \"Social engineering is modeled by having the attacker trigger this attack step on the target Users.\"\n        ->  successfulSocialEngineering,\n            bypassSecurityAwareness\n\n      & successfulSocialEngineering @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  socialEngineering\n\n      | socialEngineering @hidden\n        developer info: \"Currently social engineering entails phishing credentials and tricking the user into unsafe actions that expose Applications to the attacker. In the future, other social engineering techniques should be added to this attack step.\"\n        ->  credentialTheft,\n            unsafeUserActivity\n\n      | attemptDeliverMaliciousRemovableMedia @entrypoint\n        user info: \"An attacker can try to deliver a removable media drive(i.e. USB drive) containing malicious code to a location accessible to the target users.\"\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        modeler info: \"Social engineering is modeled by having the attacker trigger this attack step on hthe target Users.\"\n        ->  successfulDeliverMaliciousRemovableMedia,\n            bypassSecurityAwareness\n\n      & successfulDeliverMaliciousRemovableMedia @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  deliverMaliciousRemovableMedia\n\n      | deliverMaliciousRemovableMedia @hidden [Exponential(0.01)]\n        developer info: \"The user is assumed to connect the removable media containing the malicious code to all of the hardware systems that they have access to. Since this is expected to unwittingly happen as part of their normal operations the attack exposes their regular security context.\"\n        ->  userIds.attemptAssume,\n            physicalZones.hardwareSystems.attemptUnsafeUserActivity,\n            hardwareSystems.attemptUnsafeUserActivity\n\n      | credentialTheft @hidden [HardAndUncertain]\n        developer info: \"Trick the user into providing their credentials.\"\n        modeler info: \"Distribution: Bernoulli(0.5) * Exponential(0.1), source: Sommestad (2011) Password authentication attacks: a survey of attacks and when they will succeed, suggest to use Bernoulli(0.05)\"\n        ->  userIds.credentials.attemptCredentialTheft\n\n      | unsafeUserActivity @hidden [Exponential(0.03)]\n        developer info: \"The user can engage in unsafe behaviour that could allow the attacker to gain access to the applications the user has access to.\"\n        modeler info: \"If the attacker is not able to reach (or be reached) via any of the Applications this garnered access does not materialise into any actual attack vectors.\"\n        ->  userIds.attemptAssume,\n            userIds.attemptUnsafeUserActivity\n    }\n}\n\nassociations {\n  User [users] * <-- ZoneAccess            --> * [physicalZones]   PhysicalZone\n      user info: \"A user may have access to different physical zones.\"\n  User [users] * <-- HardwareAccess        --> * [hardwareSystems] Hardware\n      user info: \"A user may have access to different hardware systems, rigs, or components.\"\n  User [users] * <-- UserAssignedIdentities--> * [userIds]         Identity\n      user info: \"A user may have different identities associated with it.\"\n}\n"}
{"instruction": "", "input": "", "output": "/* \n * Copyright 2021 sasLang contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninclude \"org.mal-lang.icsLang/icsLang.mal\"\n\n\ncategory sclHierarchy {\n\tasset Bay extends PhysicalZone \n\tuser info: \"Asset taken from SCL. Assets of substations are often segmented into bays.\"\n\t{\n\t\t| hierarchy\n\t\t\t-> voltageLevel.hierarchy,\n\t\t\t\tequipment.hierarchy\n\t}\n\tasset Substation extends PhysicalZone \n\tuser info: \"Asset taken from SCL-Lang. An entire substation.\"\n\t{\n\t\t| hierarchy\n\t\t\t-> voltageLevel.hierarchy\n\t}\n    \tasset VoltageLevel extends PhysicalZone \n\tuser info: \"Asset taken from SCL-Lang. A substations equipment are often divided into several voltage levels.\"\n\t{\t\n\t\t| hierarchy\n\t\t\t-> bay.hierarchy,\n\t\t\t\tsubstation.hierarchy\n\t}\n}\ncategory physical {\n\tasset AccessPoint extends ConnectionRule \n\tuser info: \"Asset taken from SCL. AccessPoint is IEC 61850 terminology and means a physical or virtual interface.\"\n\t{\n\t\t| logicalConnection\n\t\t\t-> iedRouter.logicalConnection\n\t}\n\tasset ActuatorCB extends Actuator \n\tuser info: \"Asset required to add attack steps from the actuator to a CB.\"\n\tmodeller info: \"The +> adds attack steps on top of the parent asset ones. -> would override instead.\"\n\t{\n\t\t| manipulate\n\t\t\t+> circuitBreaker.manipulationOfControl\n\t\t| block  \n\t\t\t+> circuitBreaker.lossOfControl\n\t}\n\tasset CircuitBreaker extends Equipment\n\tuser info: \"Asset taken from the review of industry SAS designs. Close or open a circuit.\"\n\t{\n\t}\n\tasset Clock extends IcsApplication \n\tuser info: \"Taken from SCL-Lang.\"\n\t{\n\t\t| logicalConnection \n\t\t\t-> accessPoint.attemptConnectToApplicationsUninspected\n\t}\n\tasset Equipment extends PhysicalObject\n\tuser info: \"Asset taken from SCL-Lang. Components that conduct electricity, circuit breaker etc.\"\n\t{\n\t\t| hierarchy\n\t\t\t-> bay.hierarchy\n\t// Start of IcsLangs Impact Attack steps\n\t\t| attemptPreemptiveShutdown @hidden\n        user info: \"Taken from icsLang. Intermediate attack step for modelling the possibility of detecting a disruption(loss of Control/View) and preemptively shutting down the system in order to prevent damage.\"\n        ->  attemptShutdown,\n            attemptUnsafeState\n\n      | attemptPreemptiveShutdownOnSafetyLoss @hidden\n        user info: \"Taken from icsLang. Intermediate attack step for modelling the possibility of detecting a disruption(loss of Safety) and preemptively shutting down the system because of concerns. The loss of safety alone does not trigger either a shutdown or generate an unsafe state as control and view are expected to maintain the system operating within normal parameters.\"\n        ->  attemptShutdown\n\n      | attemptShutdown @hidden [Bernoulli(0.1)]\n        developer info: \"Taken from icsLang. This is the actual preemptive shutdown operation. The specific probability should be researched more and maybe defined by the modeller.\"\n        ->  shutdown\n\n      | attemptUnsafeState @hidden [Bernoulli(0.1)]\n        developer info: \"Taken from icsLang. This attack step models the possibility that a naturally occurring unsafe state is reached if there is a loss of control or view. The specific probability should be researched more and maybe defined by the modeller.\"\n        ->  unsafeState\n\n      | unsafeState @hidden\n        developer info: \"Taken from icsLang. The system can only be damaged if it has reached an unsafe operating state. If the safety mechanisms are still functional the system will shutdown without taking damage, otherwise the damage done to the system will bring it down.\"\n        ->  damageToProperty,\n            shutdown\n\n      | lossOfSafety\n        user info: \"Taken from icsLang. Adversaries may cause loss of safety whether on purpose or as a consequence of actions taken to accomplish an operation.\"\n        developer info: \"MITRE ATT&CK ICS T880.\"\n        ->  safetyMechanismsOffline,\n            attemptPreemptiveShutdownOnSafetyLoss\n\n      | safetyMechanismsOffline @hidden\n        user info: \"Taken from icsLang. Physical assets should only be damaged if the safety mechanisms fail to shutdown the system to prevent damage\"\n        ->  damageToProperty\n\n      | shutdown {A}\n        user info: \"Taken from icsLang. Shutdown the system. Can be initiated by the attacker intentionally to disrupt the industrial process or unintentionally by tampering with system and accidentally triggering the safety shutdown procedures. If the staff detect anomalous behaviour and they can decide to preemptively shut the system down to prevent potential damage.\"\n        ->  lossOfAvailability\n\n      & damageToProperty {I, A}\n        user info: \"Taken from icsLang. Adversaries may cause damage and destruction of property to infrastructure, equipment, and the surrounding environment when attacking control systems.\"\n        developer info: \"MITRE ATT&CK ICS T879.\"\n        ->  shutdown,\n            lossOfProductivityAndRevenue\n\n      | lossOfControl {A}\n        user info: \"Taken from icsLang. Adversaries may seek to achieve a sustained loss of control or a runaway condition in which operators cannot issue any commands even if the malicious interference has subsided.\"\n        developer info: \"MITRE ATT&CK ICS T827.\"\n        ->  attemptPreemptiveShutdown\n\n      | lossOfView {A}\n        user info: \"Taken from icsLang. Adversaries may cause a sustained or permanent loss of view where the ICS will require local, hands-on operator intervention.\"\n        developer info: \"MITRE ATT&CK ICS T829.\"\n        ->  attemptPreemptiveShutdown\n\n      | lossOfAvailability {A}\n        user info: \"Taken from icsLang. Adversaries may attempt to disrupt essential components or systems to prevent owner and operator from delivering products or services.\"\n        developer info: \"MITRE ATT&CK ICS T826.\"\n        ->  lossOfProductivityAndRevenue\n\n      | lossOfProductivityAndRevenue\n        user info: \"Taken from icsLang. Adversaries may cause loss of productivity and revenue through disruption and even damage to the availability and integrity of control system operations, devices, and related processes.\"\n        developer info: \"MITRE ATT&CK ICS T828.\"\n\n      | manipulationOfControl {I, A}\n        user info: \"Taken from icsLang. Adversaries may manipulate control systems devices or possibly leverage their own, to communicate with and command physical control processes.\"\n        developer info: \"MITRE ATT&CK ICS T831.\"\n        ->  unsafeState\n\n      | manipulationOfView {I, A}\n        user info: \"Taken from icsLang. Adversaries may attempt to manipulate the information reported back to operators or controllers.\"\n        developer info: \"MITRE ATT&CK ICS T832.\"\n        ->  unsafeState\n\t// END of IcsLangs Impact Attack steps\n\t}\n\tasset Function \n\tuser info: \"Asset taken from SCL-Lang. Any additional functions of the substation. Can be unrelated to energy.\"\n\t{\n\t\t| execution\n\t\t\t-> logicalNode.manipulationOfControl\n\t\t\n\t}\n\tasset Gateway extends IcsApplication \n\tuser info: \"Asset taken from the review of industry SAS designs. Communicates externally and has the function to translate protocols.\"\t\n\t{\n\t}\n\tasset IEDHardware extends IcsHardware \n\tuser info: \"Taken from SCL-Lang.\"\n\t{\t\n\t}\t\n\tasset IEDRouter extends IcsHardware \n\tuser info: \"According to SCL, an IED with routing capabilities that can connect different subnetworks with accesspoints. \"\n\t{\t\n\t\t| logicalConnection\n\t\t\t-> accessPoint.attemptConnectToApplicationsUninspected\n\t}\t\n\tasset LogicalDevice extends IcsApplication \n\tuser info: \"Asset taken from SCL-Lang. Resides in a Server and contains LogicalNodes.\"\n\t{\n\t\t\n\t}\n\tasset LogicalNode extends IcsApplication \n\tuser info: \"Taken from SCL-Lang. Resides in a LogicalDevice and enables the automation process.\"\n\t{\n\t\t| manipulationOfControl\n\t\t\t+> equipment.manipulationOfControl,\n\t\t\t\tactuator.manipulate\n\t\t| lossOfControl\n\t\t\t+> equipment.manipulationOfControl,\n\t\t\t\tactuator.block\n\t}\n\n\tasset MU extends IcsHardware \n\tuser info: \"A Merging Unit (MU) merge the analog signals and translate these to electronic signals. Asset taken from the review of industry SAS designs.\"\n\t{\n\t}\n\tasset PhysicalObject  \n\t{\n\t}\n\tasset RTU extends IcsHardware\t\n\tuser info: \"A Remote Terminal Unit can be used for communication externally. Asset taken from the review of industry SAS designs.\"\n\t{\n\t}\n\tasset Server extends IcsApplication\n\tuser info: \"Asset taken from SCL-Lang. Logical Nodes in a server can be reached outside of the subnetwork. The server can reside for example in an IED or a MU.\"\n\t{\n\t}\n\tasset SubEquipment extends Equipment \n\tuser info: \"Asset taken from SCL-Lang. Each phase of a conducting equipment is defined as a subequipment.\"\n\t{\n\t}\n\tasset SubFunction extends Function \n\tuser info: \"Asset taken from SCL-Lang. Subpart of Function.\"\n\t{\n\t}\n\n\tasset SubNetwork extends Network \n\tuser info: \"Taken from SCL-Lang. SubNetwork is IEC 61850 terminology.\"\n\t{\n\t}\n\n\tasset SubstationServer extends IcsApplication\n\tuser info: \" Asset taken from the review of industry SAS designs. Since Server means something else in the IEC 61850 terminology, SubstationServer is a typical IT server found in a substation and can be for monitoring, security or power quality control.\"\n\t{\n\t}\n\tasset Transformer extends Equipment \n\tuser info: \"Asset taken from SCL-Lang. Alters the voltage or current level.\"\n\t{\n\t}\n}\nassociations {\n\tActuatorCB [actuatorCB] * <-- CloseOrTrip --> * [circuitBreaker] CircuitBreaker\n\tClock [clock] 0..1 <-- ClockCommun --> 1 [accessPoint] AccessPoint\n\tFunction [function] * <-- FuncCommun --> * [logicalNode] LogicalNode\n\tIEDRouter [iedRouter] * <-- SubnetConnection --> 1..* [accessPoint] AccessPoint\n\tLogicalNode [logicalNode] * <-- EqRepresent --> * [equipment] Equipment\n\tLogicalNode [logicalNode] * <-- ActRepresent --> * [actuator] Actuator \n\t\n\tSubstation [substation] 1 <-- SubstatIncludesVL --> * [voltageLevel] VoltageLevel\n\tVoltageLevel [voltageLevel] 1 <-- VLIncludesBay --> * [bay] Bay\n\tBay [bay] 1 <-- BayIncludesEq --> * [equipment] Equipment\n\t\n\tLogicalNode [logicalNode] * <-- BayLevelLN --> * [bay] Bay\n\tLogicalNode [logicalNode] * <-- VoltageLevelLN --> * [voltageLevel] VoltageLevel\n\tLogicalNode [logicalNode] * <-- SubstatLevelLN --> * [substation] Substation\n\tSubstation [substation] * <-- SubstatIncludesEq --> * [equipment] Equipment\n\tVoltageLevel [voltageLevel] * <-- VoltageLevelIncludesEq --> * [equipment] Equipment\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2019-2022 coreLang contributors <https://mal-lang.org/coreLang/contributors.html>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ncategory Vulnerability {\n\n  abstract asset Vulnerability\n  user info: \"Vulnerability refers to the inability (of a system, application, etc.) to withstand the effects of a hostile environment.\"\n  {\n    # notPresent [Disabled]\n      user info: \"This defense is used to reason about the attack vectors introduced by this asset. This is particularly useful for vulnerabilities where it is common to explore the possibility of patching them out.\"\n      developer info: \"Enabling this defense should make the asset behave as if it did not exist, as such all of its impactful attack steps should be disabled by it.\"\n      ->  abuse\n\n    | attemptAbuse @hidden\n      developer info: \"Intermediate attack step to allow for defenses.\"\n      ->  abuse\n\n    & abuse\n      user info: \"The attacker is trying to abuse a vulnerability in an asset.\"\n      ->  attemptExploit\n\n    | attemptExploit @hidden\n      developer info: \"Intermediate attack step to allow for defenses.\"\n      ->  exploit\n\n    | exploit\n      user info: \"Attacker is employing an exploit that makes use of this vulnerability.\"\n      ->  impact\n\n    | impact\n      user info: \"Each vulnerability has an impact (of different levels) on the vulnerable component.\"\n  }\n\n  asset SoftwareVulnerability extends Vulnerability\n    user info: \"A vulnerability that affects software (i.e. Applications or SoftwareProducts).\"\n    developer info: \"Vulnerabilities in coreLang were designed to be in line with the 3.1 CVSS specification(https://www.first.org/cvss/specification-document#Common-Vulnerability-Scoring-System-version-3-1-Specification-Document). The defenses on the SoftwareVulnerability asset represent 7 of the base metrics scores, all of them except the scope metric. The temporal and environmental metrics are beyond the language's scope.\"\n  {\n    /* The following 10 defenses are used to model the 7 metrics of the 3.1\n     * CVSS specification that we cover. Network, local, and physical access\n     * are individual defenses in coreLang but they all form attack vector\n     * score for CVSS. Similarly, low and high privileges are individual\n     * defenses, but for CVSS they are one score. If a defense is disabled\n     * that means that the SoftwareVulnerability does not require the attacker\n     * to fulfil that requirement.\n     */\n    # networkAccessRequired @suppress [Disabled]\n      user info: \"Network access is required to abuse the vulnerability.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-1-1-Attack-Vector-AV\"\n      ->  networkAccessAchieved,\n          softwareProduct.softApplications.softwareProductVulnerabilityNetworkAccessAchieved\n\n    # localAccessRequired @suppress [Disabled]\n      user info: \"Local access is required to abuse the vulnerability.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-1-1-Attack-Vector-AV\"\n      ->  localAccessAchieved,\n          softwareProduct.softApplications.softwareProductVulnerabilityLocalAccessAchieved\n\n    # physicalAccessRequired @suppress [Disabled]\n      user info: \"Physical access is required to abuse the vulnerability.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-1-1-Attack-Vector-AV\"\n      ->  physicalAccessAchieved,\n          softwareProduct.softApplications.softwareProductVulnerabilityPhysicalAccessAchieved\n\n    # lowPrivilegesRequired @suppress [Disabled]\n      user info: \"Low privileges are required to abuse the vulnerability.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-1-3-Privileges-Required-PR\"\n      ->  lowPrivilegesAchieved,\n          softwareProduct.softApplications.softwareProductVulnerabilityLowPrivilegesAchieved\n\n    # highPrivilegesRequired @suppress [Disabled]\n      user info: \"High privileges are required to abuse the vulnerability.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-1-3-Privileges-Required-PR\"\n      ->  highPrivilegesAchieved,\n          softwareProduct.softApplications.softwareProductVulnerabilityHighPrivilegesAchieved\n\n    # userInteractionRequired @suppress [Disabled]\n      user info: \"Some exploits require user interaction. This defense should specify the probability of such interaction on the given application.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-1-4-User-Interaction-UI\"\n      ->  userInteractionAchieved,\n          softwareProduct.softApplications.softwareProductVulnerabilityUserInteractionAchieved\n\n    # confidentialityImpactLimitations @suppress [Disabled]\n      user info: \"Limits the impact on confidentiality of the vulnerability.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-3-1-Confidentiality-C\"\n      ->  read\n\n    # availabilityImpactLimitations @suppress [Disabled]\n      user info: \"Limits the impact on availability of the vulnerability.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-3-3-Availability-A\"\n      ->  deny\n\n    # integrityImpactLimitations @suppress [Disabled]\n      user info: \"Limits the impact on integrity of the vulnerability.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-3-2-Integrity-I\"\n      ->  modify\n\n    # highComplexityExploitRequired @suppress [Disabled]\n      user info: \"The vulnerability relies on a high complexity exploit that requires the attacker to expend additional effort (time) in order to successfully make use of it.\"\n      developer info: \"A vulnerability that has high complexity due to its intrinsic properties that are beyond the attacker's control.\"\n      modeler info: \"https://www.first.org/cvss/v3.1/specification-document#2-1-2-Attack-Complexity-AC\"\n      ->  exploitTrivially\n\n    | inherentUserInteraction [HardAndUncertain]\n      user info: \"The user may fulfil the user interaction requirement through their regular activities, without requiring the attacker to induce them to do so.\"\n      modeler info: \"Different software vulnerabilities that require user interaction to exploit can vary substantially in how likely those interactions are. They can range from simply using a shortcut or starting a service to enabling very specific features that the user would never perform without attacker influence. The probability assigned to this attack step should be tuned to fit the description of the vulnerability.\"\n      ->  userInteractionAchieved,\n          softwareProduct.softApplications.softwareProductVulnerabilityUserInteractionAchieved\n\n    /* The following 10 attack steps are used to satisfy the requirements\n     * that the defenses above specify. They are used if the defense is not\n     * enabled or if the attacker is able to fulfil the requirement through\n     * their actions.\n     */\n    | networkAccessAchieved @hidden\n      developer info: \"Intermediate attack step to model network access requirement.\"\n      ->  abuse\n\n    | localAccessAchieved @hidden\n      developer info: \"Intermediate attack step to model local access requirement.\"\n      ->  abuse\n\n    | physicalAccessAchieved @hidden\n      developer info: \"Intermediate attack step to model physical access requirement.\"\n      ->  abuse\n\n    | lowPrivilegesAchieved @hidden\n      developer info: \"Intermediate attack step to model low privileges requirement.\"\n      ->  abuse\n\n    | highPrivilegesAchieved @hidden\n      developer info: \"Intermediate attack step to model high privileges requirement.\"\n      ->  abuse\n\n    | userInteractionAchieved @hidden\n      developer info: \"Intermediate attack step to model user interaction requirement.\"\n      ->  abuse\n\n    | impact @hidden\n      developer info: \"The actual impact caused by successfully exploiting the vulnerability.\"\n      -> read,\n         modify,\n         deny\n\n    /* Impact attack steps, the ones that actually implement the disruptions\n     * based on the Confidentiality, Integrity, and Availability scores,\n     * respectively.\n     */\n    & read\n      user info: \"The attacker can read some or all of the associated applications's code and data.\"\n      ->  application.read,\n          softwareProduct.readApplications\n\n    & modify\n     user info: \"The attacker can modify some or all of the associated application's data and/or source code.\"\n      ->  application.modify,\n          softwareProduct.modifyApplications\n\n    & deny\n      user info: \"Denial-of-Service attack is an attack in which an application is rendered unavailable to its intended users by temporarily or indefinitely disrupting it.\"\n      ->  application.deny,\n          softwareProduct.denyApplications\n\n    | attemptAbuse @hidden\n      developer info: \"Trigger inherent user interaction for software vulnerabilities, it is only relevant for vulnerabilities that do require user interaction.\"\n      +>  inherentUserInteraction\n\n    | attemptExploit @hidden @Override\n      developer info: \"Intermediate attack step to allow for defenses.\"\n      ->  exploitTrivially,\n          exploitWithEffort\n\n    /* These two attack steps are used to implement attacks of varying\n     * complexity based on the attack complexity CVSS score.\n     */\n    & exploitTrivially @hidden\n      developer info: \"The exploit is trivial and requires insignificant effort from the attacker in order to be successful.\"\n      -> exploit\n\n    & exploitWithEffort @hidden [Exponential(0.01)]\n      developer info: \"The attacker must expend effort in order to successfully exploit the vulnerability.\"\n      -> exploit\n  }\n\n  /* Hardware vulnerabilities were created to be slightly simpler versions of\n   * their software counterparts. They are not based on a vulnerability\n   * framework, but are fairly similar to the CVSS specification since they\n   * were based on the SoftwareVulnerability design.\n   *\n   * What constitutes a software or hardware vulnerability in coreLang may not\n   * be immediately intuitive. The distinction is based on where the impact of\n   * the vulnerability is observed, rather than where the fault is located.\n   * For example, if a hardware vulnerability does not negatively impact\n   * hardware, but affects software applications running on said hardware it\n   * would be depicted as a SoftwareVulnerability with a PhysicalAccess\n   * requirement in coreLang.\n   */\n  asset HardwareVulnerability extends Vulnerability\n    user info: \"A vulnerability that affects hardware.\"\n  {\n    # physicalAccessRequired @suppress [Disabled]\n      user info: \"Physical access is required to abuse the vulnerability.\"\n      modeler info: \"Some hardware vulnerabilities require physical access to the components, while some can be exploited from software.\"\n      ->  physicalAccessAchieved\n\n    # confidentialityImpactLimitations @suppress [Disabled]\n      user info: \"Limits the impact on confidentiality of the vulnerability.\"\n      modeler info: \"Analogous defense to the SoftwareVulnerability impact limitations.\"\n      ->  read\n\n    # availabilityImpactLimitations @suppress [Disabled]\n      user info: \"Limits the impact on availability of the vulnerability.\"\n      modeler info: \"Analogous defense to the SoftwareVulnerability impact limitations.\"\n      ->  deny\n\n    # integrityImpactLimitations @suppress [Disabled]\n      user info: \"Limits the impact on integrity of the vulnerability.\"\n      modeler info: \"Analogous defense to the SoftwareVulnerability impact limitations.\"\n      ->  modify\n\n    # effortRequiredToExploit @suppress [Disabled]\n      user info: \"The vulnerability requires additional effort(time) from the attacker in order to be successful.\"\n      modeler info: \"The expectation is that the attacker has prolonged or recurring access to the targeted hardware in order to repeatedly/continuously try the exploit.\"\n      ->  exploitTrivially\n\n    | physicalAccessAchieved @hidden\n      developer info: \"Intermediate attack step to model physical access requirement.\"\n      ->  abuse\n\n    | impact @hidden\n      developer info: \"The actual impact caused by successfully exploiting the vulnerability.\"\n      -> read,\n         modify,\n         deny\n\n    /* Impact attack steps, the ones that actually implement the disruptions\n     * based on the Confidentiality, Integrity, and Availability impact\n     * limitations, respectively.\n     */\n    & read\n      user info: \"The attacker can read some or all of the associated hardware's data.\"\n      ->  hardware.read\n\n    & modify\n     user info: \"The attacker can modify some or all of the associated hardware's behaviour.\"\n      ->  hardware.modify\n\n    & deny\n      user info: \"Denial-of-Service attack is an attack in which a machine or hardware component is rendered unavailable to its intended users by temporarily or indefinitely disrupting it.\"\n      ->  hardware.deny\n\n    | attemptExploit @hidden @Override\n      developer info: \"Intermediate attack step to allow for defenses.\"\n      ->  exploitTrivially,\n          exploitWithEffort\n\n    /* These two attack steps are used to implement attacks of varying\n     * complexity based on the effort required to exploit defense.\n     */\n    & exploitTrivially @hidden\n      developer info: \"The exploit is trivial and requires insignificant effort from the attacker in order to be successful.\"\n      -> exploit\n\n    & exploitWithEffort @hidden [Exponential(0.01)]\n      developer info: \"The attacker must expend effort in order to successfully exploit the vulnerability.\"\n      -> exploit\n  }\n}\n\nassociations {\n  SoftwareVulnerability               [vulnerabilities]   * <-- ApplicationVulnerability --> 0..1 [application]     Application\n      user info: \"An Application can have multiple software vulnerabilities.\"\n  SoftwareVulnerability    [softProductVulnerabilities]   * <-- ApplicationVulnerability --> 0..1 [softwareProduct] SoftwareProduct\n      user info: \"A SoftwareProduct can have multiple software vulnerabilities.\"\n  HardwareVulnerability               [vulnerabilities]   * <-- hardwareVulnerability    --> 0..1 [hardware]        Hardware\n      user info: \"A Hardware system/component can have multiple hardware vulnerabilities.\"\n}\n"}
{"instruction": "", "input": "", "output": "category IcsInterfaceResources{\n\n    asset IOServer extends IcsApplication \n        user info: \"The Input/Output (I/O) server provides the interface between the control system LAN applications and the field equipment monitored and controlled by the control system applications.\"\n        developer info: \"https://collaborate.mitre.org/attackics/index.php/Input/Output_Server\"\n      {\n      // Override view related attack steps (Impact) becase they are not relevant to this asset\n      | manipulationOfView @Override\n\n      | lossOfView @Override\n      }\n\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2020-2021 icsLang contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninclude \"org.mal-lang.coreLang/coreLang.mal\"\ninclude \"ics/Controller.mal\"\ninclude \"ics/ControlServer.mal\"\ninclude \"ics/DataHistorian.mal\"\ninclude \"ics/EngineeringWorkstation.mal\"\ninclude \"ics/HMI.mal\"\ninclude \"ics/IOServer.mal\"\ninclude \"ics/SIS.mal\"\n\ncategory ComputeResources {\n\n    asset IcsHardware extends Hardware\n      user info: \"An ICS System extends the coreLang's System with more attack vectors.\"\n      developer info: \"For example, the attacker can additionally peform ATT&CK ICS T847 'Replication Through Removable Media', T862 'Supply Chain Attack' and more.\"\n    {\n      | physicalAccess @Override\n        +>  moduleFirmware,\n            systemFirmware\n\n      | fullAccess @Override\n        +>  lossOfSafety,\n            lossOfControl,\n            lossOfAvailability,\n            manipulationOfView,\n            manipulationOfControl\n\n      & moduleFirmware\n        user info: \"Adversaries may install malicious or vulnerable firmware onto modular hardware devices. Control system devices often contain modular hardware devices.\"\n        developer info: \"MITRE ATT&CK ICS T839.\"\n        ->  fullAccess\n\n      # moduleFirmwareVerification\n        user info: \"Verify the module's firmwares from the main firmware upon boot-up or during normal operation. Mitigation for MITRE ATT&CK ICS T839.\"\n        developer info: \"Mitigation was vaguely listed on MITRE ATT&CK ICS.\"\n        ->  moduleFirmware\n\n      # useCryptographyKeyForFirmware\n        user info: \"If a cryptographic key is used for firmware updates, the firmware will be harder to be altered. Mitigation for MITRE ATT&CK ICS T839 and T857.\"\n        developer info: \"Mitigation was listed on MITRE ATT&CK ICS.\"\n        ->  moduleFirmware,\n            systemFirmware\n\n      # useAuthenticatedFirmwareUpdates\n        user info: \"If authentication of the source and data is performed, malicious firmware alteration will be significantly harder. Mitigation for MITRE ATT&CK ICS T839 and T857.\"\n        developer info: \"Mitigation was listed on MITRE ATT&CK ICS.\"\n        ->  moduleFirmware,\n            systemFirmware\n\n      & systemFirmware\n        user info: \"An adversary may exploit the firmware update feature on accessible devices to upload malicious or out-of-date firmware.\"\n        developer info: \"MITRE ATT&CK ICS T857.\"\n        ->  fullAccess\n\n      | deny @Override {A}\n        +>  lossOfAvailability\n\n      !E sisConnected @hidden\n        developer info: \"If the ICS system is not connected to an SIS the safety mechanisms should be disabled\"\n        <-  sis\n        ->  safetyMechanismsOffline\n\n      // Impact attack steps\n      | attemptPreemptiveShutdown @hidden\n        user info: \"Intermediate attack step for modelling the possibility of detecting a disruption(loss of Control/View) and preemptively shutting down the system in order to prevent damage.\"\n        ->  attemptShutdown,\n            attemptUnsafeState\n\n      | attemptPreemptiveShutdownOnSafetyLoss @hidden\n        user info: \"Intermediate attack step for modelling the possibility of detecting a disruption(loss of Safety) and preemptively shutting down the system because of concerns. The loss of safety alone does not trigger either a shutdown or generate an unsafe state as control and view are expected to maintain the system operating within normal parameters.\"\n        ->  attemptShutdown\n\n      | attemptShutdown @hidden [Bernoulli(0.1)]\n        developer info: \"This is the actual preemptive shutdown operation. The specific probability should be researched more and maybe defined by the modeller.\"\n        ->  shutdown\n\n      | attemptUnsafeState @hidden [Bernoulli(0.1)]\n        developer info: \"This attack step models the possibility that a naturally occurring unsafe state is reached if there is a loss of control or view. The specific probability should be researched more and maybe defined by the modeller.\"\n        ->  unsafeState\n\n      | unsafeState @hidden\n        developer info: \"The system can only be damaged if it has reached an unsafe operating state. If the safety mechanisms are still functional the system will shutdown without taking damage, otherwise the damage done to the system will bring it down.\"\n        ->  damageToProperty,\n            shutdown\n\n      | lossOfSafety\n        user info: \"Adversaries may cause loss of safety whether on purpose or as a consequence of actions taken to accomplish an operation.\"\n        developer info: \"MITRE ATT&CK ICS T880.\"\n        ->  safetyMechanismsOffline,\n            attemptPreemptiveShutdownOnSafetyLoss\n\n      | safetyMechanismsOffline @hidden\n        user info: \"Physical assets should only be damaged if the safety mechanisms fail to shutdown the system to prevent damage\"\n        ->  damageToProperty\n\n      | shutdown {A}\n        user info: \"Shutdown the system. Can be initiated by the attacker intentionally to disrupt the industrial process or unintentionally by tampering with system and accidentally triggering the safety shutdown procedures. If the staff detect anomalous behaviour and they can decide to preemptively shut the system down to prevent potential damage.\"\n        ->  lossOfAvailability,\n            criticalParentSystem.propagateCriticalShutdown,\n            triggerPropagateRedundantShutdown\n\n      | triggerPropagateRedundantShutdown @hidden\n        developer info: \"This is an intermediary step required for the situation where SIS redundant subsystems are disabled.\"\n        ->  redundantParentSystem.propagateRedundantShutdown\n\n      & damageToProperty {I, A}\n        user info: \"Adversaries may cause damage and destruction of property to infrastructure, equipment, and the surrounding environment when attacking control systems.\"\n        developer info: \"MITRE ATT&CK ICS T879.\"\n        ->  shutdown,\n            lossOfProductivityAndRevenue\n\n      | lossOfControl {A}\n        user info: \"Adversaries may seek to achieve a sustained loss of control or a runaway condition in which operators cannot issue any commands even if the malicious interference has subsided.\"\n        developer info: \"MITRE ATT&CK ICS T827.\"\n        ->  attemptPreemptiveShutdown,\n            criticalParentSystem.propagateCriticalLossOfControl,\n            redundantParentSystem.propagateRedundantLossOfControl\n\n      | lossOfView {A}\n        user info: \"Adversaries may cause a sustained or permanent loss of view where the ICS equipment will require local, hands-on operator intervention.\"\n        developer info: \"MITRE ATT&CK ICS T829.\"\n        ->  attemptPreemptiveShutdown,\n            criticalParentSystem.propagateCriticalLossOfView,\n            redundantParentSystem.propagateRedundantLossOfView\n\n      | lossOfAvailability {A}\n        user info: \"Adversaries may attempt to disrupt essential components or systems to prevent owner and operator from delivering products or services.\"\n        developer info: \"MITRE ATT&CK ICS T826.\"\n        ->  lossOfProductivityAndRevenue,\n            criticalParentSystem.propagateCriticalLossOfAvailability,\n            redundantParentSystem.propagateRedundantLossOfAvailability\n\n      | lossOfProductivityAndRevenue\n        user info: \"Adversaries may cause loss of productivity and revenue through disruption and even damage to the availability and integrity of control system operations, devices, and related processes.\"\n        developer info: \"MITRE ATT&CK ICS T828.\"\n        ->  criticalParentSystem.propagateCriticalLossOfProductivityAndRevenue,\n            redundantParentSystem.propagateRedundantLossOfProductivityAndRevenue\n\n      | manipulationOfControl {I, A}\n        user info: \"Adversaries may manipulate control systems devices or possibly leverage their own, to communicate with and command physical control processes.\"\n        developer info: \"MITRE ATT&CK ICS T831.\"\n        ->  unsafeState,\n            criticalParentSystem.propagateCriticalManipulationOfControl,\n            redundantParentSystem.propagateRedundantManipulationOfControl\n\n      | manipulationOfView {I, A}\n        user info: \"Adversaries may attempt to manipulate the information reported back to operators or controllers.\"\n        developer info: \"MITRE ATT&CK ICS T832.\"\n        ->  unsafeState,\n            criticalParentSystem.propagateCriticalManipulationOfView,\n            redundantParentSystem.propagateRedundantManipulationOfView\n\n      // Propagate subsystems attack steps\n      // Critical subsystems\n      | propagateCriticalShutdown @hidden\n        user info: \"Propagate shutdown to the parent system if any of the critical subsystems experience a shutdown\"\n        -> shutdown\n\n      | propagateCriticalLossOfControl @hidden\n        user info: \"Propagate loss of control to the parent system if any of the critical subsystems experience a loss of control\"\n        -> lossOfControl\n\n      | propagateCriticalLossOfView @hidden\n        user info: \"Propagate loss of view to the parent system if any of the critical subsystems experience a loss of view\"\n        -> lossOfView\n\n      | propagateCriticalManipulationOfControl @hidden\n        user info: \"Propagate manipulation of control to the parent system if any of the critical subsystems experience a manipulation of control\"\n        -> manipulationOfControl\n\n      | propagateCriticalManipulationOfView @hidden\n        user info: \"Propagate manipulation of view to the parent system if any of the critical subsystems experience a manipulation of view\"\n        -> manipulationOfView\n\n      | propagateCriticalLossOfAvailability @hidden\n        user info: \"Propagate loss of availability to the parent system if any of the critical subsystems experience a loss of availability\"\n        -> lossOfAvailability\n\n      | propagateCriticalLossOfProductivityAndRevenue @hidden\n        user info: \"Propagate loss of productivity and revenue to the parent system if any of the critical subsystems experience a loss of productivity and revenue\"\n        -> lossOfProductivityAndRevenue\n\n      // Redundant subsystems\n      & propagateRedundantShutdown @hidden\n        user info: \"Propagate shutdown to the parent system if all of the redundant subsystems experience a shutdown\"\n        -> shutdown\n\n      & propagateRedundantLossOfControl @hidden\n        user info: \"Propagate loss of control to the parent system if all of the redundant subsystems experience a loss of control\"\n        -> lossOfControl\n\n      & propagateRedundantLossOfView @hidden\n        user info: \"Propagate loss of view to the parent system if all of the redundant subsystems experience a loss of view\"\n        -> lossOfView\n\n      & propagateRedundantManipulationOfControl @hidden\n        user info: \"Propagate manipulation of control to the parent system if all of the redundant subsystems experience a manipulation of control\"\n        -> manipulationOfControl\n\n      & propagateRedundantManipulationOfView @hidden\n        user info: \"Propagate manipulation of view to the parent system if all of the redundant subsystems experience a manipulation of view\"\n        -> manipulationOfView\n\n      & propagateRedundantLossOfAvailability @hidden\n        user info: \"Propagate loss of availability to the parent system if all of the redundant subsystems experience a loss of availability\"\n        -> lossOfAvailability\n\n      & propagateRedundantLossOfProductivityAndRevenue @hidden\n        user info: \"Propagate loss of productivity and revenue to the parent system if all of the redundant subsystems experience a loss of productivity and revenue\"\n        -> lossOfProductivityAndRevenue\n\n      # notDisabled [Enabled]\n        developer info: \"The probability that a particular IcsHardware is not actually present.\"\n        modeler info: \"The use case for this is removing some of the IcsHardwares used to provide redundancy.\"\n        -> lossOfControl,\n           lossOfView,\n           lossOfAvailability,\n           lossOfProductivityAndRevenue,\n           manipulationOfControl,\n           manipulationOfView,\n           shutdown\n\n    }\n\n     asset IcsApplication extends Application\n      user info: \"An ICS Application extends the coreLang's Application with OT attack vectors.\"\n    {\n      | specificAccess @Override\n        +>  normalOperation\n\n      | fullAccess @Override\n        +>  normalOperation,\n            attemptManipulation\n\n      | normalOperation\n        user info: \"The state where the operational component is operating normally or seems to be operating normally (but is undetectably manipulated within the safety limits).\"\n        developer info: \"I am not sure if we need this. But I keep it to add one more vector that we can model! (Sotirios)\"\n        ->  attemptCovertManipulation\n\n      | restrictedOperation {I,A}\n        user info: \"When the operational component is compromised, the operation of it is affected.\"\n\n      | read @Override {C}\n        +>  theftOfOperationalInformation\n\n      | deny @Override {A}\n        +>  lossOfControl,\n            lossOfView,\n            hostHardware[IcsHardware].lossOfAvailability\n\n      & attemptCovertManipulation [HardAndUncertain]\n        user info: \"If an application is operating normally it could even be the case that it is elaborately manipulated by an adversary.\"\n        ->  attemptManipulation\n\n      | attemptManipulation\n        user info: \"The adversary is actively manipulating the system outside of normal operating parameters.\"\n        ->  manipulate\n\n      & manipulate @hidden\n        ->  manipulationOfControl,\n            manipulationOfView\n\n      // Control related attack steps (Impact)\n      | manipulationOfControl {I, A}\n        user info: \"Adversaries may manipulate control systems devices or possibly leverage their own, to communicate with and command physical control processes.\"\n        developer info: \"MITRE ATT&CK ICS T831.\"\n        ->  restrictedOperation,\n            transmittedControlSignal.manipulateSignal,\n            sentData[IcsControlData].attemptWrite,\n            hostHardware[IcsHardware].manipulationOfControl,\n            hostHardware[IcsHardware].unsafeState\n\n      | lossOfControl {A}\n        user info: \"Adversaries may seek to achieve a sustained loss of control or a runaway condition in which operators cannot issue any commands even if the malicious interference has subsided.\"\n        developer info: \"MITRE ATT&CK ICS T827.\"\n        ->  restrictedOperation,\n            transmittedControlSignal.blockSignal,\n            sentData[IcsControlData].attemptDeny,\n            hostHardware[IcsHardware].lossOfControl,\n            hostHardware[IcsHardware].attemptPreemptiveShutdown\n\n      // View related attack steps (Impact)\n      | manipulationOfView {I, A}\n        user info: \"Adversaries may attempt to manipulate the information reported back to operators or controllers.\"\n        developer info: \"MITRE ATT&CK ICS T832.\"\n        ->  restrictedOperation,\n            transmittedSignal.manipulateSignal,\n            sentData[IcsData].attemptWrite,\n            hostHardware[IcsHardware].manipulationOfView,\n            hostHardware[IcsHardware].unsafeState\n\n      | lossOfView {A}\n        user info: \"Adversaries may cause a sustained or permanent loss of view where the ICS equipment will require local, hands-on operator intervention.\"\n        developer info: \"MITRE ATT&CK ICS T829.\"\n        ->  restrictedOperation,\n            transmittedSignal.blockSignal,\n            sentData[IcsData].attemptDeny,\n            hostHardware[IcsHardware].lossOfView,\n            hostHardware[IcsHardware].attemptPreemptiveShutdown\n\n      // Other types of Impact\n      | theftOfOperationalInformation {C}\n        user info: \"Adversaries may steal operational information on a production environment as a direct mission outcome for personal gain or to inform future operations.\"\n        developer info: \"MITRE ATT&CK ICS T882.\"\n\n    }\n\n    asset Sensor\n      user info: \"An object that generates data (via a signal) but may not have any associated software or host.\"\n      modeler info: \"It would be vulnerable to an attacker that can gain physical access to it.\"\n    {\n      | physicalAccess\n        user info: \"Attacker has physical access on the location where the sensor is physically deployed.\"\n        ->  signal.manipulateSignal,\n            signal.blockSignal,\n            data.attemptWrite,\n            data.attemptDeny,\n            system.lossOfView,\n            system.manipulationOfView\n    }\n\n    asset Actuator\n      user info: \"An object that consumes data (from a signal) but may not have any associated software or host.\"\n    {\n      | manipulate {I, A}\n        user info: \"If the signal that is consumed by this actuator is manipulated then the actuator is
{"instruction": "", "input": "", "output": "/*\n * Copyright 2019-2022 coreLang contributors <https://mal-lang.org/coreLang/contributors.html>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ncategory ComputeResources {\n\n    asset Hardware\n      user info: \"Specifies the hardware on which applications can run.\"\n    {\n      | attemptUseVulnerabilityFromPhysicalAccess @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulUseVulnerabilityFromPhysicalAccess,\n            bypassHardwareModificationsProtection\n\n      & successfulUseVulnerabilityFromPhysicalAccess @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  useVulnerability\n\n      | attemptUseVulnerabilityFromSoftwareFullAccess @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  useVulnerability\n\n      | useVulnerability\n        user info: \"The attacker is able to use the associated vulnerabilities, usually as a result of obtaining physical access.\"\n        ->  vulnerabilities.attemptAbuse\n\n      | attemptSpreadWormThroughRemovableMedia @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulSpreadWormThroughRemovableMedia,\n            bypassHardwareModificationsProtection\n\n      & successfulSpreadWormThroughRemovableMedia @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  spreadWormThroughRemovableMedia\n\n      | spreadWormThroughRemovableMedia @hidden\n        developer info: \"Try to spread malware through removable media that the users connect to the hardware system.\"\n        ->  (users \\/ physicalZones.users).attemptDeliverMaliciousRemovableMedia\n\n      | fullAccess {C,I,A}\n        user info: \"Full access on a piece of hardware grants full access on the applications running on it and access to the hosted data.\"\n        ->  sysExecutedApps.fullAccess,\n            hostedData.attemptRead,\n            hostedData.attemptWrite,\n            deny,\n            attemptSpreadWormThroughRemovableMedia\n\n      | attemptSupplyChainAttack @entrypoint\n        user info: \"Adversaries may perform supply chain compromise attacks to gain control of hardware before it is put into use.\"\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        modeler info: \"Triggering this attack step is the only way to model hardware supply chain attacks in the language, therefore scenarios interested in those aspects need to employ it as an entry point.\"\n        ->  successfulSupplyChainAttack,\n            bypassSupplyChainAuditing\n\n      & successfulSupplyChainAttack @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        -> supplyChainAttack\n\n      | supplyChainAttack [VeryHardAndUncertain]\n        user info: \"A supply chain compromise means that the attacker has gained full access of the hardware.\"\n        modeler info: \"The Hardware supply chain attack represents an attacker being able to tamper with the hardware/firmware before the deployment of the product and not alterations made to the hardware/firmware once it is operating.\"\n        ->  fullAccess\n\n      # supplyChainAuditing\n        user info: \"Auditing inside the hardware supply chain can detect possible supply chain attacks.\"\n        ->  supplyChainAuditingBypassed\n\n      | bypassSupplyChainAuditing [VeryHardAndUncertain]\n        user info: \"Supply chain auditing can be bypassed.\"\n        ->  supplyChainAuditingBypassed\n\n      | supplyChainAuditingBypassed @hidden\n        developer info: \"Supply chain auditing is bypassed either because it was not set or the attacker was able to circumvent it through additional effort.\"\n        ->  successfulSupplyChainAttack\n\n      | physicalAccess @entrypoint\n        user info: \"Attacker has physical access to the location where the hardware is physically deployed. They could then deny the hardware, locally connect to the hosted applications, and exploit potential physical vulnerabilities.\"\n        modeler info: \"This attack step can be used as an entry point when analyzing scenarios that involve gaining physical access to assets.\"\n        ->  deny,\n            sysExecutedApps.localConnect,\n            attemptHardwareModifications\n\n      | attemptHardwareModifications @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulHardwareModifications,\n            bypassHardwareModificationsProtection\n\n      & successfulHardwareModifications @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  hardwareModifications\n\n      | hardwareModifications @hidden\n        developer info: \"Attacker is able to modify the hardware setup. They could then exploit physical vulnerabilities or software vulnerabilities that require physical access.\"\n        ->  attemptUseVulnerabilityFromPhysicalAccess,\n            vulnerabilities.physicalAccessAchieved,\n            sysExecutedApps.physicalAccessAchieved\n\n      # hardwareModificationsProtection\n        user info: \"This defense protects against unauthorized modifications to the hardware that would allow an attacker to exploit a hardware vulnerability or a user to connect malicious devices to it.\"\n        developer info: \"But it does not protect against denial of service attacks or local connect on hosted applications.\"\n        ->  hardwareModificationsProtectionBypassed\n\n      | bypassHardwareModificationsProtection [VeryHardAndUncertain]\n        user info: \"Hardware modifications protection can be bypassed.\"\n        ->  hardwareModificationsProtectionBypassed\n\n      | hardwareModificationsProtectionBypassed @hidden\n        developer info: \"Hardware modifications protection is bypassed either because it was not set or the attacker was able to circumvent it through additional effort.\"\n        ->  successfulUseVulnerabilityFromPhysicalAccess,\n            successfulHardwareModifications,\n            successfulSpreadWormThroughRemovableMedia,\n            successfulUnsafeUserActivity\n\n      | attemptUnsafeUserActivity @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulUnsafeUserActivity,\n            bypassHardwareModificationsProtection\n\n      & successfulUnsafeUserActivity @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  unsafeUserActivity\n\n      | unsafeUserActivity\n        user info: \"A user is performing unsafe actions on the hardware. This exposes the Applications running on top of the hardware and fulfils the physical access requirement of SoftwareVulnerabilities associated with them.\"\n        developer info: \"Currently only represents connecting a malicious removable media drive.\"\n        ->  sysExecutedApps.attemptUnsafeUserActivity,\n            sysExecutedApps.physicalAccessAchieved\n\n      | deny {A}\n        user info: \"Denial of service (DoS) attack on hardware leads to DoS on all the applications running on it and hosted data.\"\n        ->  sysExecutedApps.attemptDeny,\n            hostedData.attemptDeny\n\n      | read {C}\n        user info: \"Read on hardware leads to a read on all the applications running on it and hosted data.\"\n        ->  sysExecutedApps.attemptRead,\n            hostedData.attemptRead\n\n      | modify {I}\n        user info: \"Modify on hardware gives the attacker full access to the hardware and leads to a modify/write on all the applications running on it and hosted data.\"\n        ->  fullAccess,\n            sysExecutedApps.attemptModify,\n            hostedData.attemptWrite\n    }\n\n    asset SoftwareProduct extends Information\n      user info: \"A software product that certain applications are using which represents a specific software package, potentially even a version, which can be associated with certain vulnerabilities or have its deployment repositories compromised in a software supply chain attack.\"\n      developer info: \"This asset was introduced in order to improve the usability of the language and enable software supply chain attacks.\"\n    {\n      | compromiseApplications\n        user info: \"If the origin of a software product is compromised (modified maliciously) this is interpreted as a software supply chain attack and therefore the associated applications should also be fully compromised.\"\n        ->  softApplications.attemptFullAccessFromSupplyChainCompromise\n\n      | write @Override\n        user info: \"If the attacker is able to write the software product they are able to execute a software supply chain attack on the applications associated with it.\"\n        +>  compromiseApplications\n\n      /* The following three attack steps are used to trigger the\n       * SoftwareProduct's SoftwareVulnerabilities' impacts on each of the\n       * Applications associated with the SoftwareProduct separately.\n       */\n      | readApplications @hidden\n        developer info: \"This is an intermediary attack step to propagate read on all of the associated applications if the vulnerability has a confidentiality impact.\"\n        ->  softApplications.attemptReadFromSoftProdVulnerability\n\n      | modifyApplications @hidden\n        developer info: \"This is an intermediary attack step to propagate modify on all of the associated applications if the vulnerability has an integrity impact.\"\n        ->  softApplications.attemptModifyFromSoftProdVulnerability\n\n      | denyApplications @hidden\n        developer info: \"This is an intermediary attack step to propagate deny on all of the associated applications if the vulnerability has an availability impact.\"\n        ->  softApplications.attemptDenyFromSoftProdVulnerability\n    }\n\n    asset Application\n      user info: \"An application models any type of software process or component, from firmware and operating systems to plugins and sessions.\"\n      modeler info: \"Applications are some of the most common assets in models due to their versatility and scope.\"\n    {\n      let allVulnerabilities = vulnerabilities \\/ appSoftProduct.softProductVulnerabilities\n\n      let outgoingApplicationConnections = (appConnections \\/ outgoingAppConnections)\n      let ingoingApplicationConnections = (appConnections \\/ ingoingAppConnections)\n\n      # notPresent [Disabled]\n        user info: \"This defense is used to reason about the attack vectors introduced by this asset. It should be used to model the possibility that the Application does not actually exist. Typically this is useful to see what attack steps are removed if a particular non-essential component(e.g. a plugin, library, feature, or service).\"\n        developer info: \"This defense allows for both speculation about the presence of a particular application and to suggest that if it is possible removing it may restrict the attacker's actions.\"\n        ->  successfulUseVulnerability,\n            successfulReverseReach,\n            networkConnectFromResponse,\n            specificAccessFromLocalConnection,\n            specificAccessFromNetworkConnection,\n            localAccess,\n            networkAccess,\n            successfulUnsafeUserActivity,\n            fullAccessFromSupplyChainCompromise,\n            readFromSoftProdVulnerability,\n            modifyFromSoftProdVulnerability,\n            denyFromSoftProdVulnerability,\n            successfulApplicationRespondConnectThroughData,\n            successfulAuthorizedApplicationRespondConnectThroughData,\n            successfulRead,\n            successfulModify,\n            successfulDeny\n\n      | attemptUseVulnerability @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulUseVulnerability,\n            protectorIDPSs.bypassEffectiveness\n\n      & successfulUseVulnerability @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  useVulnerability\n\n      | useVulnerability\n        user info: \"Try to exploit the associated vulnerabilities.\"\n        developer info: \"This includes vulnerabilities associated with the SoftwareProduct that this Application is running as well.\"\n        ->  allVulnerabilities().attemptAbuse,\n            attemptSoftwareProductAbuse,\n            readFromSoftProdVulnerability,\n            modifyFromSoftProdVulnerability,\n            denyFromSoftProdVulnerability\n\n      | attemptReverseReach @entrypoint\n        user info: \"The attacker is reachable from this Application therefore start propagating reverse reach from it. Reverse reach is used to determine whether or not the attacker can be reached by the user.\"\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        modeler info: \"If the entry point of the attacker is an Application this attack step needs to be explicitly called on it by the modeler in order to have reverse reach start propagating from the Application to the rest of the assets in the model. This is the case because no other attack step on the Application asset triggers this attack step.\"\n        ->  successfulReverseReach\n\n      & successfulReverseReach @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  reverseReach\n\n      | reverseReach @hidden\n        developer info: \"Reverse reach is used to determine whether or not the attacker can be reached by the user. Reverse reach propagates toward outgoing or bidirectional communications.\"\n        ->  networks.attemptReverseReach,\n            ingoingApplicationConnections().attemptReverseReach,\n            appExecutedApps.attemptReverseReach,\n            attackerUnsafeUserActivityCapabilityWithReverseReach,\n            containedData.attemptReverseReach,\n            sentData.attemptReverseReach,\n            receivedData.attemptReverseReach,\n            networkConnectFromResponse\n\n      | localConnect\n        user info: \"The attacker can interface with the Application without going through networking communications. This is achieved by gaining full access on a hosted Application, specific access on the hosting Application, physical access on the hardware on which the Application is running, or via unsafe user activity.\"\n        ->  localAccess,\n            specificAccessFromLocalConnection,\n            attemptUseVulnerability, // Attempt to exploit all the vulnerabilities associated with the Application\n            allVulnerabilities().localAccessAchieved,\n            softwareProductVulnerabilityLocalAccessAchieved\n\n      | networkConnectUninspected\n        user info: \"An attacker can connect to any network exposed application and try to authenticate or trigger vulnerabilities.\"\n        ->  attemptUseVulnerability, // Attempt to exploit all the vulnerabilities associated with the Application\n            allVulnerabilities().networkAccessAchieved,\n            softwareProductVulnerabilityNetworkAccessAchieved,\n            networkConnect,\n            specificAccessNetworkConnect\n\n      | networkConnectInspected\n        user info: \"If the network communications occur via any ConnectionRules that have their payload inspected the attacker can still authenticate, but they cannot trigger vulnerabilities.\"\n        ->  networkConnect,\n            specificAccessNetworkConnect\n\n      | networkConnect @hidden\n        developer info: \"Intermediate attack step.\"\n        ->  networkAccess\n\n      | specificAccessNetworkConnect @hidden\n        developer info: \"Intermediate attack step.\"\n        ->  specificAccessFromNetworkConnection\n\n      | accessNetworkAndConnections @hidden\n        developer info: \"The attacker can access outgoing and bidirectional networks and connections associated with the application.\"\n        ->  networks.accessUninspected,\n            networks.accessInspected,\n            outgoingApplicationConnections().attemptConnectToApplicationsUninspected,\n            outgoingApplicationConnections().attemptConnectToApplicationsInspected,\n            outgoingApplicationConnections().attemptAccessNetworksUninspected,\n            outgoingApplicationConnections().attemptAccessNetworksInspected\n\n      | attemptNetworkConnectFromResponse @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  networkConnectFromResponse\n\n      & networkConnectFromResponse @hidden [VeryHardAndUncertain]\n        developer info: \"An attacker may be able to respond to requests submitted by a client application.\"\n        ->  networkConnectUninspected\n\n      & specificAccessFromLocalConnection @hidden\n        developer info: \"Intermediate attack steps for modeling the two requirements (reachability and authentication) for specific access.\"\n        ->  specificAccess\n\n      & specificAccessFromNetworkConnection @hidden\n        developer info: \"Intermediate attack steps for modeling the two requirements (reachability and authentication) for specific access.\"\n        ->  specificAccess\n\n      | specificAccess\n        user info: \"The adversary is able to gain low-privilege access on the Application which allows them to access the networks and connections associated with it and locally connect to hosted Applications. Additionally, if they have the required privileges the attacker may also access data hosted, sent, or received by the Application.\"\n        ->  appExecutedApps.localConnect, // An attacker with low-privilege access on the executing instance is assumed to be able to locally interact with the executed applications.\n            specificAccessRead,\n            specificAccessModify,\n            specificAccessDelete,\n            bypassContainerization,\n            attemptUseVulnerability, // Attempt to exploit all the vulnerabilities associated with the Application\n            attemptAuthorizedApplicationRespondConnectThroughData,\n            accessNetworkAndConnections // and access the network(s) and connections on/to which the app is connected\n\n      | bypassContainerization [HardAndUncertain]\n        user info: \"The attacker is able to break out of an application container/sandbox and try to exploit any vulnerability of the host application.\"\n        ->  hostApp.attemptUseVulnerability\n\n      | authenticate\n        user info: \"The attacker is able to authenticate with the appropriate high-level privileges.\"\n        ->  localAccess,\n            networkAccess,\n            allVulnerabilities().highPrivilegesAchieved,\n            softwareProductVulnerabilityHighPrivilegesAchieved\n\n      | specificAccessAuthenticate\n        user info: \"The attacker is able to authenticate with the appropriate low-level privileges.\"\n        ->  specificAccessFromLocalConnection,\n            specific
{"instruction": "", "input": "", "output": "// vehicleLang\n// Author: Sotirios Katsikeas (sotkat@kth.se)\n// Last major revision: July 2019\n\n//include \"vehicleLangEncryption.mal\"\ninclude \"vehicleLangEthernet.mal\"\ninclude \"vehicleLangPublicInterfaces.mal\"\n// All includes should be placed above this line, and not on included files for better tracebility.\n\ncategory System {\n\n    abstract asset PhysicalMachine\n        user info: \"Specifies any physical machine.\"\n    {\n        | connect\n                user info: \"Connect leads directly to access on a physical machine since no authentication is done/needed.\"\n                ->  fullAccess\n\n        | fullAccess\n                developer info: \"This is empty in order to be overriden.\"\n    }\n\n    asset SensorOrActuator extends PhysicalMachine\n        user info: \"Specifies physical machines like sensors and actuators.\"\n    {\n        | connect\n                user info: \"Connect leads directly to access on a physical machine since no authentication is done/needed.\"\n                ->  fullAccess\n\n        | fullAccess\n                user info: \"Access means that the attacker has full access on the machine, ex. he can manipulate the actuator's behavior or sensor's measurements.\"\n                ->  manipulate\n\n        | manipulate\n                developer info: \"This is empty for now because it is enough to reach this.\"\n    }\n\n    asset Machine extends Hardware\n        user info: \"Specifies any machine that has higher complexity than a simple actuator or sensor.\"\n        developer info: \"Extended from coreLang.\"\n    {\n\n        | connect\n                user info: \"Attempt to connect to a machine.\"\n                ->\tauthenticatedAccess,\n                    connectPrivileges.assume,\n                    connectionVulnerabilities.exploit\n\n        | authenticate\n                user info: \"Does the attacker have the credentials of an identity?\"\n                ->\tauthenticatedAccess\n\n        & authenticatedAccess\n                  user info: \"One way to gain access to a machine is through legitimate authentication.\"\n                ->\tfullAccess\n\n        | bypassAccessControl [Exponential(0.02)]\n                user info: \"An attacker can bypass access control and authenticate to the machine.\"\n                -> fullAccess\n\n        | fullAccess\n                developer info: \"We don't explicitly model root access; that is not a sound primitive. Instead, such an identity can be modelled explicitly by providing an account with access to all machineExecutedApps and all data.\"\n                +>\t_machineAccess\n\n        | idControl\n                user info: \"This is used when ID is compromised from dataflow.\"\n\n        | _machineAccess @hidden\n                developer info: \"Again, this is a helper attack step that will also be used from the childs of this asset.\"\n                ->\tdeny,\n                    _accessData,\n                    machineExecutedApps.localConnect,\n                    accessVulnerabilities.exploit\n\n        | deny\n                user info: \"Perform a DoS attack on the machine.\"\n                ->\tmachineExecutedApps.deny,\n                    hostedData.deny\n\n        | _accessData @hidden\n                user info: \"A helper attack step to reach request access on data stored on a machine\"\n                ->  hostedData.attemptRead,\n                    hostedData.attemptWrite,\n                    hostedData.attemptDelete\n\n        | passFirmwareValidation\n                developer info: \"Again, this is a blank helper attack step that will also be used from the childs of this asset.\"\n\n        | udsFirmwareModification\n                developer info: \"This is a blank helper attack step that should be reached from FirmwareUpdaterService.\"\n\n        | passUdsFirmwareModification\n                developer info: \"This is a blank helper attack step that should be reached from FirmwareUpdaterService.\"\n\n        | gainNetworkAccess\n                user info: \"This attack step will be only implemented on the infotainment system asset.\"\n    }\n\n    asset ECU extends Machine\n        user info: \"Specifies any ECU/MCU/controller in a vehicle.\"\n        developer info: \"Created as new parent class because the existing Machine had many unrelated attacks.\"\n    {\n        | connect\n                user info: \"Attackers can attempt to connect to the ECU and change the operation mode if they have access to the network, services, dataflows, etc...\"\n                +>  attemptChangeOperationMode\n                    //firmwareUpdater.networkConnectUninspected\n\n        | maliciousFirmwareUpload\n                user info: \"Maliciously uploading a forged firmware leads to full access on the ECU and the ability to inject/eavesdrop messages on the previous running services and network.\"\n                ->  fullAccess,\n                    _ecuNetworkAccess\n\n        & uploadFirmware\n                user info: \"Uploading firmware leads to full access on the ECU and the ability to inject/eavesdrop messages on the previous running services and network.\"\n                ->  _ecuNetworkAccess\n\n        | _ecuNetworkAccess @hidden\n                developer info: \"This a helper attack step because both above attack steps are leading to the same connections.\"\n                ->      vehiclenetworks.accessUninspected,\n                        vehiclenetworks.eavesdrop,\n                        vehiclenetworks.messageInjection,\n                        vehiclenetworks.j1939Attacks,\n                        vehiclenetworks._networkSpecificAttack,\n                        vehiclenetworks._networkForwarding\n\n        | udsFirmwareModification\n                user info: \"This attack step is reached after access on FirmwareUpdaterService.\"\n                ->  firmwareUpdater.udsFirmwareUpload\n\n        | passUdsFirmwareModification\n                user info: \"Same as below, if the cryptographic key is accessed.\"\n                ->  firmwareUpdater.passUdsFirmwareUpload\n\n        | passFirmwareValidation\n                user info: \"If the firmware validation key is stored in the ECU, this means that the firmware validation is passed and a new firmware can be uploaded.\"\n                ->  uploadFirmware\n\n        | fullAccess\n                user info: \"Attackers have access to the ECU if they have compromised its firmware (after custom firmware upload), bypassed access control (after authentication via diagnostics) or properly authenticated themselves.\"\n                +>\tsensorsOrActuators.manipulate,\n                    changeOperationMode,\n                    gainLINAccessFromCAN,\n                    bypassMessageConfliction,\n                    _ecuNetworkAccess\n\n        | idControl\n                user info: \"This attack step is reached after the ID is compromised from dataflow and allows an attacker to manipulate the connected sensors or actuators.\"\n                ->  sensorsOrActuators.manipulate\n\n        | offline\n                user info: \"When the ECU is taken offline by some other attack step. Offline means that the ECU is still powered on but unable to communicate on its bus. The effort needed to achieve this is applied on the distributions of the parent attacks. This also means that the connected sensors or actuators can be manipulated.\"\n                ->\tdeny,\n                    bypassMessageConfliction\n\n        | shutdown\n                user info: \"When the ECU is powered off by some other attack step. The effort needed to achieve this is applied on the distributions of the parent attacks.\"\n                ->\tbypassMessageConfliction,\n                    deny // Deny access to data and machineExecutedApps\n\n        & changeOperationMode\n                user info: \"Put the ECU into diagnostics (if vehicle is moving slowly or is stopped) or even update mode (bootmode). Leads to shutdown since attacker must have achieved access on this ECU to reach this step.\"\n                // This can bypass message conflictions and IDPS because the legitimate ECU will no lorger send messages and the attacker can imitate it, if carefull.\n                -> \tshutdown,\n                    firmware.maliciousFirmwareModification,\n                    uploadFirmware\n\n        & attemptChangeOperationMode [Exponential(0.1)]\n                user info: \"Put the ECU into diagnostics (if vehicle is moving slowly or is stopped) or even update mode (bootmode) but after some effort. This stops ECU from communicating on its bus -> offline\"\n                -> \toffline,\n                    bypassMessageConfliction,\n                    firmware.maliciousFirmwareModification\n\n        # operationModeProtection\n                user info: \"Either prevent diagnostics mode after vehicles starts moving or allow diagnostics mode only after some physical change is done on vehicle.\"\n                developer info: \"Charlie Miller and Chris Valasek, CAN message injection (2016).\"\n                ->\tchangeOperationMode,\n                    attemptChangeOperationMode\n\n        | bypassMessageConfliction\n                user info: \"Bypass message confliction protection mechanisms by changing ECU's operation mode -> no conflicts -> service message injection.\"\n                ->  machineExecutedApps.serviceMessageInjection\n\n        & _networkServiceMessageInjection @hidden\n                user info: \"Inject forged service messages that could notify about vehicle's fault or report fake status (speed, operation mode, etc.). This can even lead to unresponsive ECU (TPMS). This is reached from network access.\"\n                ->\tmachineExecutedApps.serviceMessageInjection\n\n        # messageConflictionProtection\n                user info: \"Defend against message injection by using message confliction mechanisms (detect messages with own ID). This acts like a host-based IDS.\"\n                developer info: \"Pierre Kleberger, Tomas Olovsson, and Erland Jonsson, Security Aspects of the In-Vehicle Network in the Connected Car (2011).\"\n                ->\t_networkServiceMessageInjection\n\n        | gainLINAccessFromCAN\n                user info: \"There are techniques that make it easy to gain access to the LIN bus through a CAN-bus node.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                //  NOTE: This should happen only with a probability and not always maybe?\n                ->\tvehiclenetworks.gainLINAccessFromCAN\n\n    }\n\n    asset GatewayECU extends ECU\n        user info: \"Specifies the ECU that acts as a gateway/firewall on a vehicle.\"\n    {\n        | fullAccess\n                developer info: \"Overriding from ECU\"\n                +>\ttrafficVNetworks.adversaryInTheMiddle, // This will act as Firewall and IDPS are disabled!\n                    forwarding\n\n        | forwarding\n                developer info: \"Forwarding is the lightest interaction with the gateway, where the gateway simply retransmits received messages. Vulnerabilities may, however, lead to compromise of the gateway as well as of the associated firewall. Therefore, Forwarding leads to Connect.\"\n                -> \tconnect,\n                    bypassFirewall  // If firewall is not enabled then bypass it.\n\n        & bypassFirewall\n                user info: \"If firewall is disabled, then attacker can bypass it.\"\n                ->\tgatewayBypassIDPS, // Added here to stop those attacks when firewall is enabled.\n                    gatewayNoIDPS,\n                    trafficVNetworks.accessUDSservices\n\n        # firewallProtection // Firewall is just a defense on gateway ECU.\n                user info: \"Firewall protection comes from the existence of a correctly configured firewall.\"\n                -> bypassFirewall\n\n        | deny\n                user info: \"Perform denial of service attack on the connected networks.\"\n                -> \ttrafficVNetworks.deny\n\n        // IDPS is modeled as a centralized inline IDPS\n        E  idpsExists\n                user info: \"Check for the existence of an IDPS.\"\n                <- idps\n                -> gatewayBypassIDPS\n\n        & gatewayBypassIDPS\n                user info: \"Bypass IDPS protection when IDPS is in place, but only if firewall is disabled.\"\n                -> trafficVNetworks._bypassIDPS\n\n        !E idpsDoesNotExist\n                user info: \"Check for the non existence of an IDPS.\"\n                <-\tidps\n                ->\tgatewayNoIDPS\n\n        & gatewayNoIDPS\n                user info: \"IDPS is disabled so the attacker can access the network unrestricted, but only if firewall is also disabled.\"\n                -> trafficVNetworks._noIDPS,\n                   trafficVNetworks.accessNetworkLayer // Moved it here from forwarding to allow imediate network access only if idps does not exist.\n    }\n\n    abstract asset VehicularApplication extends Application\n        developer info: \"Extended from coreLang.\"\n    {\n        | specificAccess\n                +>      hostMachine.connect\n        | fullAccess\n                +>      hostMachine.connect,\n                        assignedVehicularIdentity.attemptAssume\n\n        | serviceMessageInjection\n                developer info: \"This is an empty attack step that will only be used from the childs of this asset.\"\n    }\n\n    asset Firmware extends VehicularApplication\n        user info: \"Specifies the firmware running on an ECU as an application.\"\n    {\n        | maliciousFirmwareModification\n                user info: \"Perform a firmware update either by cracking Secure Boot or worse by exploiting the absence of it.\"\n                ->  bypassSecureBoot,\n                    crackSecureBoot\n\n        & crackFirmwareValidation [Exponential(0.2)]\n                user info: \"Crack firmware validation if it is enabled.\"\n                ->  hardware.maliciousFirmwareUpload\n\n        & bypassFirmwareValidation\n                user info: \"Bypass firmware validation if it is not enabled.\"\n                ->  hardware.maliciousFirmwareUpload\n\n        # firmwareValidation\n                user info: \"Code signing and verification during upload, use of strong checksum functions and/or don't distribute the private keys for signing.\"\n                developer info: \"Rubicon - Zero-knowledge Armor for Automotive Security, RubiconLabs\"\n                ->\tbypassFirmwareValidation\n\n        & bypassSecureBoot\n                user info: \"Bypass Secure Boot if it is not enabled Then validate a firmware update either by cracking (brute forcing) the checksum or worse by exploiting the absence of verification.\"\n                ->  bypassFirmwareValidation,\n                    crackFirmwareValidation\n\n        | crackSecureBoot [Exponential(0.1)]\n                user info: \"Crack Secure Boot if it is enabled is hard\"\n                ->  hardware.maliciousFirmwareUpload\n\n        # secureBoot\n                user info: \"SecureBoot is a protection mechanism that validates the boot software and the firmware at system boot time.\"\n                developer info: \"SecureBoot should make running of forged firmware even harder when enabled. Therefore, it stops firmware validation attack steps.\"\n                ->  bypassSecureBoot\n    }\n\n    asset OperatingSystem extends VehicularApplication {\n       // Currently simple ECUs and GatewayECUs don't have an OS. But the infotainment system has.\n    }\n\n    asset Service extends VehicularApplication {\n        // Intentionally left blank\n    }\n\n    asset Client extends VehicularApplication {\n        // Intentionally left blank\n    }\n\n    asset NetworkClient extends Client\n        user info: \"Represents a client connected to a service running on a network.\"\n    {\n        | fullAccess\n                +>\tdataflows.request\n    }\n\n    asset VehicleNetworkReceiver extends Client\n        user info: \"Represents a receiver/client for connectionless dataflows connected to a transmitter running on a vehicle network.\"\n    {\n        | fullAccess\n                +>\tdataflows.eavesdrop\n\n        | impersonateId\n                ->  hostMachine.idControl\n    }\n\n    asset NetworkService extends Service\n        user info: \"Represents a service running on top of a network.\"\n    {\n\n        | fullAccess\n                +>\tdataflows.respond\n    }\n\n    asset UDSService extends NetworkService\n        user info: \"Represents an ISO 14229 - Unified Diagnostics Service (UDS) running on an ECU.\"\n        developer info: \"Pierre Kleberger, On Securing the Connected Car: Methods and Protocols for Secure Vehicle Diagnostics, PhD Thesis (2015)\"\n    {\n        | fullAccess\n                user info: \"Access on an UDS service provides access on stored data, possibility to update firmware and change operation status of the ECU.\"\n                +>\tdataflows.respond,\n                    hostMachine._accessData\n    }\n\n    asset TransmitterService extends Service\n        user info: \"Represents a service/transmitter running on an ECU and on top of a vehicle network.\"\n    {\n        | fullAccess\n                +>\tdataflows.transmit,\n                    dataflows.deny // This is only possible here because only one Transmitter can be connected to a conectionless dataflow\n\n        | serviceMessageInjection\n                user info: \"Tamper dataflows that are conneceted to this network transmitter after bypassing message confliction on the ECU.\"\n                ->\tdataflows.maliciousTransmit,\n                    dataflows.eavesdropId\n    }\n\n    asset FirmwareUpdaterService extends UDSService\n        user info:\"Specifies the firmware updating procedure/UDS service on an ECU.\"\n    {\n        | fullAccess\n                +>  firmwareTarget.udsFirmwareModification\n\n        & udsFirmwareUpload\n                user info: \"If UDS Security Access defense is disabled, attacker can maliciously upload firmware.\"\n                ->  firmwareTarget.maliciousFirmwareUpload\n\n        | passUdsFirmwareUpload\n                user info: \"If the cryptographic key of Security Access is read then, the firmware
{"instruction": "", "input": "", "output": "/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n#id: \"org.mal-lang.trainingLang\"\n#version: \"1.0.0\"\n\ncategory Basic {\n\n\n  asset Host {\n\n    # notPresent [Disabled]\n      -> connect,\n         access\n\n    | authenticate\n      -> access\n\n    & connect\n      -> access\n\n    & access\n      -> data.read,\n         data.modify,\n         networks.access\n\n  }\n\n  asset Data {\n\n    # notPresent [Disabled]\n      -> read,\n         modify\n\n    & read\n\n    & modify\n\n  }\n\n  asset Network {\n\n    | access\n      -> hosts.connect,\n         toNetworks.access\n\n  }\n\n  asset User {\n\n    # notPresent [Disabled]\n      -> compromise\n\n    & compromise\n      -> hosts.authenticate\n\n    | phishing\n      -> compromise\n\n  }\n\n}\n\nassociations {\n  Network [fromNetworks] * <-- InterNetworkConnectivity --> * [toNetworks] Network\n  Host [hosts] * <-- HostsInNetworks --> * [networks] Network\n  User [users] * <-- UsersOnHosts --> * [hosts] Host\n  Data [data] * <-- DataOnHosts --> * [hosts] Host\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2020-2021 icsLang contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n#id: \"org.mal-lang.icsLang\"\n#version: \"0.0.2\"\n\ninclude \"icsLang.mal\"\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2019-2022 coreLang contributors <https://mal-lang.org/coreLang/contributors.html>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ncategory Networking {\n\n    asset Network\n      user info: \"A network (zone) is a set of network accessible applications and data.\"\n      developer info: \"The network asset tries to cover all the levels of the OSI stack in a very abstract and compact way (i.e. it tries to represent all the OSI layers). For example it will try to cover both ARP attacks (that are Level 2) but also DNS/HTTP spoofing attacks (that are Level 7).\"\n    {\n      let outboundAllowedConnections = (netConnections \\/ outgoingNetConnections)\n      let inboundAllowedConnections = (netConnections \\/ ingoingNetConnections \\/ diodeIngoingNetConnections)\n      let allNetConnections = (netConnections \\/ ingoingNetConnections \\/ outgoingNetConnections \\/ diodeIngoingNetConnections)\n      let allowedApplicationConnectionsApplications = (applications \\/ allNetConnections().applications)\n\n      | physicalAccess @entrypoint {C, A}\n        user info: \"Attacker has physical access on the network. This means they can cut wires/fibers, connect using iLOs, eavesdrop and get proper network access.\"\n        modeler info: \"This attack step can be used as an entry point when analyzing scenarios that involve gaining physical access to assets.\"\n        ->  deny,\n            attemptAccessUninspectedFromPhysicalAccess,\n            attemptAccessInspectedFromPhysicalAccess,\n            bypassEavesdropDefenseFromPhysicalAccess,\n            bypassAdversaryInTheMiddleDefenseFromPhysicalAccess\n\n      | bypassEavesdropDefenseFromPhysicalAccess\n        user info: \"The eavesdrop defense can be bypassed more easily if the attacker has physical access to the network. This attack step will add its impact to the unconditional bypass.\"\n        ->  eavesdropDefenseBypassed\n\n      | bypassAdversaryInTheMiddleDefenseFromPhysicalAccess\n        user info: \"The adversary in the middle defense can be bypassed more easily if the attacker has physical access to the network. This attack step will add its impact to the unconditional bypass.\"\n        ->  adversaryInTheMiddleDefenseBypassed\n\n      # networkAccessControl\n        user info: \"Access control protects from unauthorized physical access on the network.\"\n        ->  accessControlBypassed\n\n      | bypassAccessControl [VeryHardAndUncertain]\n        user info: \"If access control is enabled, the attacker can still try to bypass it and gain access on the network.\"\n        ->  accessControlBypassed\n\n      | accessControlBypassed @hidden\n        developer info: \"Access control is bypassed either because it was not set, the attacker was able to circumvent it through additional effort.\"\n        ->  successfulAccessUninspectedFromPhysicalAccess,\n            successfulAccessInspectedFromPhysicalAccess\n\n      | attemptAccessUninspectedFromPhysicalAccess @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulAccessUninspectedFromPhysicalAccess,\n            bypassAccessControl\n\n      | attemptAccessInspectedFromPhysicalAccess @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulAccessInspectedFromPhysicalAccess,\n            bypassAccessControl\n\n      & successfulAccessUninspectedFromPhysicalAccess @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  accessUninspected\n\n      & successfulAccessInspectedFromPhysicalAccess @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  accessInspected\n\n      | accessUninspected\n        user info: \"Uninspected access provides connect to all reachable applications without any restrictions.\"\n        ->  outboundAllowedConnections().attemptConnectToApplicationsUninspected,\n            applications.networkConnectUninspected,\n            networkForwardingUninspected,\n            attemptReverseReach,\n            accessNetworkData,\n            deny\n\n      | accessInspected\n        user info: \"Inspected access provides connect to all reachable applications, but with limitations.\"\n        ->  outboundAllowedConnections().attemptConnectToApplicationsInspected,\n            applications.networkConnectInspected,\n            networkForwardingInspected,\n            accessNetworkData,\n            deny\n\n      | attemptReverseReach @hidden\n        developer info: \"Intermediate attack step to allow for defenses.\"\n        ->  reverseReach\n\n      & reverseReach @hidden\n        developer info: \"Reverse reach is used to determine whether or not the attacker can be reached by the user. Reverse reach propagates toward outgoing or bidirectional communications.\"\n        ->  inboundAllowedConnections().attemptReverseReach,\n            applications.attemptReverseReach\n\n      | networkForwardingUninspected @hidden\n        developer info: \"By using the allowed connections (connection rules), uninspected forwarding from one network to another network or applications can happen.\"\n          ->  outboundAllowedConnections().attemptAccessNetworksUninspected,\n              outboundAllowedConnections().attemptConnectToApplicationsUninspected,\n              networkForwardingInspected\n\n      | networkForwardingInspected @hidden\n        developer info: \"By using the allowed connections (connection rules), inspected forwarding from one network to another network or applications can happen.\"\n          ->  outboundAllowedConnections().attemptAccessNetworksInspected,\n              outboundAllowedConnections().attemptConnectToApplicationsInspected\n\n      | deny {A}\n        user info: \"If a DoS is performed it affects, the applications communicating over the network as well as the connected application.\"\n        ->  allNetConnections().attemptDeny,\n            allowedApplicationConnectionsApplications().denyFromNetworkingAsset\n\n      | accessNetworkData @hidden\n        developer info: \"Access also the data that are network-wide available.\"\n        ->  attemptEavesdrop,\n            attemptAdversaryInTheMiddle\n\n      # eavesdropDefense\n        user info: \"This defense protects from eavesdrop attacks. If this defense is disabled, then it is equivalent to the network being considered a broadcast network.\"\n        modeler info: \"If this defense is enabled, attacks such as ARP spoofing should however, still be possible.\"\n        ->  eavesdropDefenseBypassed\n\n      | bypassEavesdropDefense [VeryHardAndUncertain]\n        user info: \"The eavesdrop defense can be bypassed.\"\n        ->  eavesdropDefenseBypassed\n\n      | eavesdropDefenseBypassed @hidden\n        developer info: \"The Eavesdrop defense is bypassed either because it was not set, the attacker was able to circumvent it through additional effort.\"\n        ->  successfulEavesdrop\n\n      | attemptEavesdrop @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulEavesdrop,\n            bypassEavesdropDefense\n\n      & successfulEavesdrop @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  eavesdrop\n\n      | eavesdrop {C}\n        user info: \"An attacker that performs an eavesdrop attack on a network tries to access all the transferred data over that network.\"\n        ->  transitData.attemptRead\n\n      # adversaryInTheMiddleDefense\n        user info: \"This defense protects against adversary-in-the-middle (AitM) attacks that are originating either form the network layer (like ARP spoofing) or by manipulating the higher network layers (like DNS poisoning).\"\n        ->  adversaryInTheMiddleDefenseBypassed\n\n      | bypassAdversaryInTheMiddleDefense [VeryHardAndUncertain]\n        user info: \"The adversary in the middle defense can be bypassed.\"\n        ->  adversaryInTheMiddleDefenseBypassed\n\n      | adversaryInTheMiddleDefenseBypassed @hidden\n        developer info: \"The adversary in the middle defense is bypassed either because it was not set, the attacker was able to circumvent it through additional effort.\"\n        ->  successfulAdversaryInTheMiddle\n\n      | attemptAdversaryInTheMiddle @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulAdversaryInTheMiddle,\n            bypassAdversaryInTheMiddleDefense\n\n      & successfulAdversaryInTheMiddle @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  adversaryInTheMiddle\n\n      | adversaryInTheMiddle {C, I}\n        user info: \"An attacker that performs a AitM attack on a network tries to read and modify all the transferred data over that network.\"\n        ->  eavesdrop,\n            transitData.attemptWrite,\n            transitData.attemptApplicationRespondConnect\n    }\n\n    asset RoutingFirewall extends Application\n      user info: \"A routing firewall specifies a router with firewall capabilities that connects many networks.\"\n    {\n      | deny {A}\n       user info: \"A DoS attack should cascade on the connected networks and associated connections\"\n        ->  connectionRules.attemptDeny\n\n      | fullAccess {I, A}\n        developer info: \"If full access is achieved on RoutingFirewall then it is 0wned and all connections can be allowed! This can happen by compromising the manager application.\"\n        +>  (connectionRules.networks \\/ connectionRules.outNetworks \\/ connectionRules.inNetworks \\/ connectionRules.diodeInNetworks).accessUninspected,\n            connectionRules.applications.networkConnectUninspected\n    }\n\n    asset ConnectionRule\n      user info: \"This asset is used to model firewall rules between Applications and/or Networks. The association selected (bi/uni-directional) only describes the connection initiation.\"\n      developer info: \"This asset is mainly used to model the functionality of a network connection through a firewall. If Data is added, then it also models the data in transit.\"\n    {\n      let allApplications = (applications \\/ inApplications \\/ outApplications)\n      let senderApplications = (applications \\/ outApplications)\n      let receiverApplications = (applications \\/ inApplications)\n\n      # restricted [Disabled]\n        user info: \"The restricted defense can be used to probabilistically model the likelihood of both the protocols required by the attack being enabled or the existence of the ConnectionRule altogether.\"\n        ->  restrictedBypassed\n\n      | bypassRestricted [VeryHardAndUncertain]\n        user info: \"The restricted defense can be bypassed.\"\n        ->  restrictedBypassed\n\n      | restrictedBypassed @hidden\n        developer info: \"The restricted defense is bypassed either because it was not set, the attacker was able to circumvent it through additional effort.\"\n        ->  successfulAccessNetworksUninspected,\n            successfulAccessNetworksInspected,\n            connectToApplicationsUninspected,\n            connectToApplicationsInspected,\n            deny,\n            reverseReach\n\n      # payloadInspection [Disabled]\n        user info: \"If enabled, then the traffic is considered to be inspected and filtered by an IDPS that can detect and stop malicious payloads, effectively allowing only legitimate communication(i.e. network-level vulnerabilities cannot be exploited, unsafe actions that the user may taken that would benefit the attacker are also prevented).\"\n        ->  payloadInspectionBypassed\n\n      | bypassPayloadInspection [VeryHardAndUncertain]\n        user info: \"Payload inspection can be bypassed.\"\n        ->  payloadInspectionBypassed\n\n      | payloadInspectionBypassed @hidden\n        developer info: \"Payload inspection is bypassed either because it was not set, the attacker was able to circumvent it through additional effort.\"\n        ->  successfulAccessNetworksUninspected,\n            connectToApplicationsUninspected,\n            reverseReach\n\n      // All the hidden attack steps below are hidden because they are just used for the internal mechanics of the ConnectionRules\n      | attemptReverseReach @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  reverseReach,\n            bypassRestricted,\n            bypassPayloadInspection\n\n      & reverseReach @hidden\n        developer info: \"Reverse reach is used to determine whether or not the attacker can be reached by the user. Reverse reach propagates via outgoing or bidirectional communications.\"\n        ->  senderApplications().attemptReverseReach,\n            (networks \\/ outNetworks).attemptReverseReach\n\n      | attemptAccessNetworksUninspected @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulAccessNetworksUninspected,\n            bypassRestricted,\n            bypassPayloadInspection\n\n      | attemptAccessNetworksInspected @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  successfulAccessNetworksInspected,\n            bypassRestricted\n\n      & successfulAccessNetworksUninspected @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  accessNetworksUninspected\n\n      & successfulAccessNetworksInspected @hidden\n        developer info: \"Intermediate attack step to model defenses.\"\n        ->  accessNetworksInspected\n\n      | accessNetworksUninspected\n        developer info: \"Access all networks that are associated with this ConnectionRule, without any restriction due to inspection.\"\n        ->  (networks  \\/ inNetworks  \\/ diodeInNetworks).accessUninspected,\n            accessNetworksInspected\n\n      | accessNetworksInspected\n        developer info: \"Access all networks that are associated with this ConnectionRule, but taking into account that the traffic payload is being inspected.\"\n        ->  (networks  \\/ inNetworks  \\/ diodeInNetworks).accessInspected\n\n      | attemptConnectToApplicationsUninspected @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  connectToApplicationsUninspected,\n            bypassRestricted,\n            bypassPayloadInspection\n\n      | attemptConnectToApplicationsInspected @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  connectToApplicationsInspected,\n            bypassRestricted\n\n      & connectToApplicationsUninspected @hidden\n        developer info: \"Connect to all the (server) Applications that are associated with this ConnectionRule, without any restriction due to inspection.\"\n        ->  receiverApplications().networkConnectUninspected,\n            receiverApplications().networkConnectInspected\n\n      & connectToApplicationsInspected @hidden\n        developer info: \"Connect to all the (server) Applications that are associated with this ConnectionRule, but taking into account that the traffic payload is being inspected. This attack step is used to allow legitimate traffic even when payload inspection is enabled on the connection.\"\n        ->  receiverApplications().networkConnectInspected\n\n      | attemptDeny @hidden\n        developer info: \"Intermediate attack step to allow for defenses and trigger bypasses.\"\n        ->  deny,\n            bypassRestricted\n\n      & deny {A}\n        user info: \"If a connection rule is denied it affects the applications communicating over it.\"\n        ->  allApplications().denyFromNetworkingAsset\n    }\n}\n\nassociations {\n  // ### Networking associations\n  RoutingFirewall  [routingFirewalls]  0..1 <-- FirewallConnectionRule --> *    [connectionRules]       ConnectionRule\n      user info: \"A routing firewall has routing or firewall rules specified by connections between networks or applications respectively.\"\n  RoutingFirewall  [managedRoutingFw]     * <-- ManagedBy             --> 0..1 [managerApp]             Application\n      user info: \"A routing firewall can have an admin/manager interface (application) that is accessible from a network location.\"\n  Network          [networks]             * <-- NetworkExposure       --> *    [applications]           Application\n      user info: \"An application can communicate / be exposed on a network.\"\n      modeler info: \"This is DEPRECATED and should only be used by fully aware modelers.\"\n      developer info: \"This can equivalently be modeled using a ConnectionRule but this direct approach should be prefered in the case where the application is “located” in the same network as the host on which it is running.\"\n  Application      [applications]         * <-- ApplicationConnection --> *    [appConnections]         ConnectionRule\n      user info: \"An application can communicate over one or more (mesh type) bidirectional connections.\"\n      modeler info: \"ConnectionRules associated with Applications are practically expressing a traffic flow.\"\n  Application      [inApplications]       * <-- InApplicationConnection --> *  [ingoingAppConnections]  ConnectionRule\n      user info: \"Two or more applications can also be inter-connected via a uni-directional connection. In means that this is the server side application, awaiting incoming connections.\"\n  Application      [outApplications]      * <-- OutApplicationConnection --> * [outgoingAppConnections] ConnectionRule\n      user info: \"Two or more applications can also be inter-connected via a uni-directional connection. Out means that this is the client side application initiating connections.\"\n  Network          [networks]             * <-- NetworkConnection     --> *    [netConnections]         ConnectionRule\n      user info: \"Two or more networks can also be inter-connected via a bidirectional connection.\"\n  Network          [inNetworks]           * <-- InNetworkConnection   --> *    [ingoingNetConnections]  ConnectionRule\n      user info: \"Two or more networks can also be inter-connected via a uni-directional connection. In means that ingoing traffic to the network is allowed.\"\n  Network          [outNetworks]          * <-- OutNetworkConnection  --> *    [outgoingNetConnections] ConnectionRule\n      user info: \"Two or more networks can also be inter-connected via a uni-directional connection. Out means that outgoing traffic from the network is allowed.\"\n  Network          [diodeInNetworks]      * <-- DiodeInNetworkConnection --> * [diodeIngoingNetConnections] ConnectionRule\n      user info: \"Two or more networks can also be inter-connected via a uni-directional connection that acts like a diode. That means that no responses can come back after connection initiation.\"\n}\n"}
{"instruction": "", "input": "", "output": "/*\n * Copyright 2022-2022 vehicleLang contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n#id: \"org.mal-lang.vehicleLang\"\n#version: \"2.0.0\"\n\ninclude \"org.mal-lang.coreLang/coreLang.mal\"\ninclude \"vehicleLang.mal\"\n"}
{"instruction": "", "input": "", "output": "category IcsControlResources{\n\n    asset EngineeringWorkstation extends IcsApplication \n        user info: \"The engineering workstation is usually a high-end very reliable computing platform designed for configuration, maintenance and diagnostics of the control system applications and other control system equipment.\"\n        developer info: \"https://collaborate.mitre.org/attackics/index.php/Engineering_Workstation\"\n      {\n        | fullAccess @Override\n          +> reprogramControllers\n\n        | reprogramControllers\n          user info: \"Reprogram all of the controllers that the engineering station has access to.\"\n          modeler info: \"This is meant to simulate situations where how the controllers are programmed is unknown, irrelevant, or over a temporary connection. Otherwise the Network and ConnectionRule assets should be used to propagate the attack.\"\n          ->  programmableControllers.attemptManipulation\n      }\n\n}\n\nassociations {\n  EngineeringWorkstation [programmingWorkstations]  * <-- programLogic     --> *   [programmableControllers] Controller\n      user info: \"Engineering workstations are responsible for programming the logic on controllers used both in the industrial control processes and the safety systems.\"\n}\n"}
{"instruction": "", "input": "", "output": "category Communication {\n\n\tasset CoreEncryptedData extends Data\n \t\tuser info: \"Data is a concrete, syntactic representation of Information at rest.\"\n\t\tdeveloper info: \"Extended from coreLang.\"\n   {\n\n\t   & authorizedRead\n\t      user info: \"Access and authentication will allow reading of data.\"\n\t      -> readEncrypted\n\n\t   & authorizedWrite\n\t      user info: \"Access and authentication will allow writing of data.\"\n\t      -> writeEncrypted\n\n\t\t& readEncrypted\n\t\t\t->\tread\n\n\t\t& writeEncrypted\n\t\t\t-> write\n\n        E decryptionKeysExist\n      \t\tuser info: \"If any decryption keys exist, this defense step is compromised, but if not, this will prevent readEncrypted from being reached.\"\n      \t\tdeveloper info: \"Without this step, readEncrypted will, in the case of no modelled keys, be compromised, which is counterintuitive.\"\n         \t<- decryptionKeys\n         \t-> readEncrypted\n\n\t   E encryptionKeysExist\n\t      user info: \"If any encryption keys exist, this defense step is compromised, but if not, this will prevent witeEncrypted from being reached.\"\n\t      developer info: \"Without this step, writeEncrypted will, in the case of no modelled keys, be compromised, which is counterintuitive.\"\n          <- encryptionKeys\n\t\t  -> writeEncrypted\n\t\t}\n}\n\ncategory Security{\n\n\tasset CryptographicKey extends Data \n\t\tdeveloper info: \"Extended from coreLang.\"\n\t{\n\t\t| read\n\t\t -> decryptedData.readEncrypted,\n\t\t\tencryptedData.writeEncrypted\n\n\t}\n\n}\n\nassociations {\n\tCoreEncryptedData\t[decryptedData]\t\t\t\t*\t<-- Decryption\t\t\t\t\t\t-->\t*\t[decryptionKeys]\t\t\t\tCryptographicKey\n   \tCoreEncryptedData\t[encryptedData]\t\t\t\t*\t<-- Encryption\t\t\t\t\t\t-->\t*\t[encryptionKeys]\t\t\t\tCryptographicKey\n}\n"}
{"instruction": "", "input": "", "output": "category IcsControlResources{\n\n    asset Controller extends IcsApplication \n        user info: \"Controllers utilize a programmable logic-based application that provides scanning and writing of data to and from the IO interface modules and communicates with the control system network via various communications methods, including serial and network communications.\"\n        developer info: \"https://collaborate.mitre.org/attackics/index.php/Field_Controller/RTU/PLC/IED\"\n      {\n        # physicalLock\n          user info: \"A controller can have a physical lock in place that disallows modifications on the programmable logic, thus making it invulnerable to manipulations.\"\n          ->  manipulate\n\n      }\n\n}\n"}
