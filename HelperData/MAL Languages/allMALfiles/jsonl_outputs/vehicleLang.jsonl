{"Output": "// vehicleLang\n// Author: Sotirios Katsikeas (sotkat@kth.se)\n// Last major revision: July 2019\n\n//include \"vehicleLangEncryption.mal\"\ninclude \"vehicleLangEthernet.mal\"\ninclude \"vehicleLangPublicInterfaces.mal\"\n// All includes should be placed above this line, and not on included files for better tracebility.\n\ncategory System {\n    \n    abstract asset PhysicalMachine\n        user info: \"Specifies any physical machine.\"\n    {\n        | connect\n                user info: \"Connect leads directly to access on a physical machine since no authentication is done/needed.\"\n                ->  fullAccess\n\n        | fullAccess\n                developer info: \"This is empty in order to be overriden.\"\n    }\n\n    asset SensorOrActuator extends PhysicalMachine\n        user info: \"Specifies physical machines like sensors and actuators.\"\n    {\n        | connect\n                user info: \"Connect leads directly to access on a physical machine since no authentication is done/needed.\"\n                ->  fullAccess\n\n        | fullAccess\n                user info: \"Access means that the attacker has full access on the machine, ex. he can manipulate the actuator's behavior or sensor's measurements.\"\n                ->  manipulate\n\n        | manipulate\n                developer info: \"This is empty for now because it is enough to reach this.\"\n    }\n\n    asset Machine extends Hardware\n        user info: \"Specifies any machine that has higher complexity than a simple actuator or sensor.\"\n        developer info: \"Extended from coreLang.\"\n    {\n\n        | connect\n                user info: \"Attempt to connect to a machine.\"\n                ->\tauthenticatedAccess,\n                    connectPrivileges.assume,\n                    connectionVulnerabilities.exploit\n\n        | authenticate\n                user info: \"Does the attacker have the credentials of an identity?\"\n                ->\tauthenticatedAccess\n\n        & authenticatedAccess\n                  user info: \"One way to gain access to a machine is through legitimate authentication.\"\n                ->\tfullAccess\n\n        | bypassAccessControl [Exponential(0.02)]\n                user info: \"An attacker can bypass access control and authenticate to the machine.\"\n                -> fullAccess\n\n        | fullAccess\n                developer info: \"We don't explicitly model root access; that is not a sound primitive. Instead, such an identity can be modelled explicitly by providing an account with access to all machineExecutedApps and all data.\"\n                +>\t_machineAccess\n\n        | idControl\n                user info: \"This is used when ID is compromised from dataflow.\"\n\n        | _machineAccess @hidden\n                developer info: \"Again, this is a helper attack step that will also be used from the childs of this asset.\"\n                ->\tdeny,\n                    _accessData,\n                    machineExecutedApps.localConnect,\n                    accessVulnerabilities.exploit\n\n        | deny\n                user info: \"Perform a DoS attack on the machine.\"\n                ->\tmachineExecutedApps.deny,\n                    hostedData.deny\n\n        | _accessData @hidden\n                user info: \"A helper attack step to reach request access on data stored on a machine\"\n                ->  hostedData.attemptRead,\n                    hostedData.attemptWrite,\n                    hostedData.attemptDelete\n\n        | passFirmwareValidation\n                developer info: \"Again, this is a blank helper attack step that will also be used from the childs of this asset.\"\n\n        | udsFirmwareModification\n                developer info: \"This is a blank helper attack step that should be reached from FirmwareUpdaterService.\"\n\n        | passUdsFirmwareModification\n                developer info: \"This is a blank helper attack step that should be reached from FirmwareUpdaterService.\"\n\n        | gainNetworkAccess\n                user info: \"This attack step will be only implemented on the infotainment system asset.\"\n    }\n\n    asset ECU extends Machine\n        user info: \"Specifies any ECU/MCU/controller in a vehicle.\"\n        developer info: \"Created as new parent class because the existing Machine had many unrelated attacks.\"\n    {\n        | connect\n                user info: \"Attackers can attempt to connect to the ECU and change the operation mode if they have access to the network, services, dataflows, etc...\"\n                +>  attemptChangeOperationMode\n                    //firmwareUpdater.networkConnectUninspected\n\n        | maliciousFirmwareUpload\n                user info: \"Maliciously uploading a forged firmware leads to full access on the ECU and the ability to inject/eavesdrop messages on the previous running services and network.\"\n                ->  fullAccess,\n                    _ecuNetworkAccess\n\n        & uploadFirmware\n                user info: \"Uploading firmware leads to full access on the ECU and the ability to inject/eavesdrop messages on the previous running services and network.\"\n                ->  _ecuNetworkAccess\n\n        | _ecuNetworkAccess @hidden\n                developer info: \"This a helper attack step because both above attack steps are leading to the same connections.\"\n                ->      vehiclenetworks.accessUninspected,\n                        vehiclenetworks.eavesdrop,\n                        vehiclenetworks.messageInjection,\n                        vehiclenetworks.j1939Attacks,\n                        vehiclenetworks._networkSpecificAttack,\n                        vehiclenetworks._networkForwarding\n\n        | udsFirmwareModification\n                user info: \"This attack step is reached after access on FirmwareUpdaterService.\"\n                ->  firmwareUpdater.udsFirmwareUpload\n\n        | passUdsFirmwareModification\n                user info: \"Same as below, if the cryptographic key is accessed.\"\n                ->  firmwareUpdater.passUdsFirmwareUpload\n\n        | passFirmwareValidation\n                user info: \"If the firmware validation key is stored in the ECU, this means that the firmware validation is passed and a new firmware can be uploaded.\"\n                ->  uploadFirmware\n\n        | fullAccess\n                user info: \"Attackers have access to the ECU if they have compromised its firmware (after custom firmware upload), bypassed access control (after authentication via diagnostics) or properly authenticated themselves.\"\n                +>\tsensorsOrActuators.manipulate,\n                    changeOperationMode,\n                    gainLINAccessFromCAN,\n                    bypassMessageConfliction,\n                    _ecuNetworkAccess\n\n        | idControl\n                user info: \"This attack step is reached after the ID is compromised from dataflow and allows an attacker to manipulate the connected sensors or actuators.\"\n                ->  sensorsOrActuators.manipulate\n\n        | offline\n                user info: \"When the ECU is taken offline by some other attack step. Offline means that the ECU is still powered on but unable to communicate on its bus. The effort needed to achieve this is applied on the distributions of the parent attacks. This also means that the connected sensors or actuators can be manipulated.\"\n                ->\tdeny,\n                    bypassMessageConfliction\n\n        | shutdown\n                user info: \"When the ECU is powered off by some other attack step. The effort needed to achieve this is applied on the distributions of the parent attacks.\"\n                ->\tbypassMessageConfliction,\n                    deny // Deny access to data and machineExecutedApps\n\n        & changeOperationMode\n                user info: \"Put the ECU into diagnostics (if vehicle is moving slowly or is stopped) or even update mode (bootmode). Leads to shutdown since attacker must have achieved access on this ECU to reach this step.\"\n                // This can bypass message conflictions and IDPS because the legitimate ECU will no lorger send messages and the attacker can imitate it, if carefull.\n                -> \tshutdown,\n                    firmware.maliciousFirmwareModification,\n                    uploadFirmware\n\n        & attemptChangeOperationMode [Exponential(0.1)]\n                user info: \"Put the ECU into diagnostics (if vehicle is moving slowly or is stopped) or even update mode (bootmode) but after some effort. This stops ECU from communicating on its bus -> offline\"\n                -> \toffline,\n                    bypassMessageConfliction,\n                    firmware.maliciousFirmwareModification\n\n        # operationModeProtection\n                user info: \"Either prevent diagnostics mode after vehicles starts moving or allow diagnostics mode only after some physical change is done on vehicle.\"\n                developer info: \"Charlie Miller and Chris Valasek, CAN message injection (2016).\"\n                ->\tchangeOperationMode,\n                    attemptChangeOperationMode\n\n        | bypassMessageConfliction\n                user info: \"Bypass message confliction protection mechanisms by changing ECU's operation mode -> no conflicts -> service message injection.\"\n                ->  machineExecutedApps.serviceMessageInjection\n\n        & _networkServiceMessageInjection @hidden\n                user info: \"Inject forged service messages that could notify about vehicle's fault or report fake status (speed, operation mode, etc.). This can even lead to unresponsive ECU (TPMS). This is reached from network access.\"\n                ->\tmachineExecutedApps.serviceMessageInjection\n\n        # messageConflictionProtection\n                user info: \"Defend against message injection by using message confliction mechanisms (detect messages with own ID). This acts like a host-based IDS.\"\n                developer info: \"Pierre Kleberger, Tomas Olovsson, and Erland Jonsson, Security Aspects of the In-Vehicle Network in the Connected Car (2011).\"\n                ->\t_networkServiceMessageInjection\n\n        | gainLINAccessFromCAN\n                user info: \"There are techniques that make it easy to gain access to the LIN bus through a CAN-bus node.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                //  NOTE: This should happen only with a probability and not always maybe?\n                ->\tvehiclenetworks.gainLINAccessFromCAN\n\n    }\n\n    asset GatewayECU extends ECU\n        user info: \"Specifies the ECU that acts as a gateway/firewall on a vehicle.\"\n    {\n        | fullAccess\n                developer info: \"Overriding from ECU\"\n                +>\ttrafficVNetworks.adversaryInTheMiddle, // This will act as Firewall and IDPS are disabled!\n                    forwarding\n\n        | forwarding\n                developer info: \"Forwarding is the lightest interaction with the gateway, where the gateway simply retransmits received messages. Vulnerabilities may, however, lead to compromise of the gateway as well as of the associated firewall. Therefore, Forwarding leads to Connect.\"\n                -> \tconnect,\n                    bypassFirewall  // If firewall is not enabled then bypass it.\n\n        & bypassFirewall\n                user info: \"If firewall is disabled, then attacker can bypass it.\"\n                ->\tgatewayBypassIDPS, // Added here to stop those attacks when firewall is enabled.\n                    gatewayNoIDPS,\n                    trafficVNetworks.accessUDSservices\n\n        # firewallProtection // Firewall is just a defense on gateway ECU.\n                user info: \"Firewall protection comes from the existence of a correctly configured firewall.\"\n                -> bypassFirewall\n\n        | deny\n                user info: \"Perform denial of service attack on the connected networks.\"\n                -> \ttrafficVNetworks.deny\n\n        // IDPS is modeled as a centralized inline IDPS\n        E  idpsExists\n                user info: \"Check for the existence of an IDPS.\"\n                <- idps\n                -> gatewayBypassIDPS\n\n        & gatewayBypassIDPS\n                user info: \"Bypass IDPS protection when IDPS is in place, but only if firewall is disabled.\"\n                -> trafficVNetworks._bypassIDPS\n\n        !E idpsDoesNotExist\n                user info: \"Check for the non existence of an IDPS.\"\n                <-\tidps\n                ->\tgatewayNoIDPS\n\n        & gatewayNoIDPS\n                user info: \"IDPS is disabled so the attacker can access the network unrestricted, but only if firewall is also disabled.\"\n                -> trafficVNetworks._noIDPS,\n                   trafficVNetworks.accessNetworkLayer // Moved it here from forwarding to allow imediate network access only if idps does not exist.\n    }\n\n    abstract asset VehicularApplication extends Application\n        developer info: \"Extended from coreLang.\"\n    {   \n        | specificAccess\n                +>      hostMachine.connect\n        | fullAccess\n                +>      hostMachine.connect,\n                        assignedVehicularIdentity.attemptAssume\n\n        | serviceMessageInjection\n                developer info: \"This is an empty attack step that will only be used from the childs of this asset.\"\n    }\n\n    asset Firmware extends VehicularApplication\n        user info: \"Specifies the firmware running on an ECU as an application.\"\n    {\n        | maliciousFirmwareModification\n                user info: \"Perform a firmware update either by cracking Secure Boot or worse by exploiting the absence of it.\"\n                ->  bypassSecureBoot,\n                    crackSecureBoot\n\n        & crackFirmwareValidation [Exponential(0.2)]\n                user info: \"Crack firmware validation if it is enabled.\"\n                ->  hardware.maliciousFirmwareUpload\n\n        & bypassFirmwareValidation\n                user info: \"Bypass firmware validation if it is not enabled.\"\n                ->  hardware.maliciousFirmwareUpload\n\n        # firmwareValidation\n                user info: \"Code signing and verification during upload, use of strong checksum functions and/or don't distribute the private keys for signing.\"\n                developer info: \"Rubicon - Zero-knowledge Armor for Automotive Security, RubiconLabs\"\n                ->\tbypassFirmwareValidation\n\n        & bypassSecureBoot\n                user info: \"Bypass Secure Boot if it is not enabled Then validate a firmware update either by cracking (brute forcing) the checksum or worse by exploiting the absence of verification.\"\n                ->  bypassFirmwareValidation,\n                    crackFirmwareValidation\n\n        | crackSecureBoot [Exponential(0.1)]\n                user info: \"Crack Secure Boot if it is enabled is hard\"\n                ->  hardware.maliciousFirmwareUpload\n\n        # secureBoot\n                user info: \"SecureBoot is a protection mechanism that validates the boot software and the firmware at system boot time.\"\n                developer info: \"SecureBoot should make running of forged firmware even harder when enabled. Therefore, it stops firmware validation attack steps.\"\n                ->  bypassSecureBoot\n    }\n\n    asset OperatingSystem extends VehicularApplication {\n       // Currently simple ECUs and GatewayECUs don't have an OS. But the infotainment system has.\n    }\n\n    asset Service extends VehicularApplication {\n        // Intentionally left blank\n    }\n\n    asset Client extends VehicularApplication {\n        // Intentionally left blank\n    }\n\n    asset NetworkClient extends Client\n        user info: \"Represents a client connected to a service running on a network.\"\n    {\n        | fullAccess\n                +>\tdataflows.request\n    }\n\n    asset VehicleNetworkReceiver extends Client\n        user info: \"Represents a receiver/client for connectionless dataflows connected to a transmitter running on a vehicle network.\"\n    {\n        | fullAccess\n                +>\tdataflows.eavesdrop\n\n        | impersonateId\n                ->  hostMachine.idControl\n    }\n\n    asset NetworkService extends Service\n        user info: \"Represents a service running on top of a network.\"\n    {\n\n        | fullAccess\n                +>\tdataflows.respond\n    }\n\n    asset UDSService extends NetworkService\n        user info: \"Represents an ISO 14229 - Unified Diagnostics Service (UDS) running on an ECU.\"\n        developer info: \"Pierre Kleberger, On Securing the Connected Car: Methods and Protocols for Secure Vehicle Diagnostics, PhD Thesis (2015)\"\n    {\n        | fullAccess\n                user info: \"Access on an UDS service provides access on stored data, possibility to update firmware and change operation status of the ECU.\"\n                +>\tdataflows.respond,\n                    hostMachine._accessData\n    }\n\n    asset TransmitterService extends Service\n        user info: \"Represents a service/transmitter running on an ECU and on top of a vehicle network.\"\n    {\n        | fullAccess\n                +>\tdataflows.transmit,\n                    dataflows.deny // This is only possible here because only one Transmitter can be connected to a conectionless dataflow\n\n        | serviceMessageInjection\n                user info: \"Tamper dataflows that are conneceted to this network transmitter after bypassing message confliction on the ECU.\"\n                ->\tdataflows.maliciousTransmit,\n                    dataflows.eavesdropId\n    }\n\n    asset FirmwareUpdaterService extends UDSService\n        user info:\"Specifies the firmware updating procedure/UDS service on an ECU.\"\n    {\n        | fullAccess\n                +>  firmwareTarget.udsFirmwareModification\n\n        & udsFirmwareUpload\n                user info: \"If UDS Security Access defense is disabled, attacker can maliciously upload firmware.\"\n                ->  firmwareTarget.maliciousFirmwareUpload\n\n        | passUdsFirmwareUpload\n                user info: \"If the cryptographic key of Security Access is read then, the firmware upload procedure can easily be initiated.\"\n                ->  firmwareTarget.passFirmwareValidation\n\n        # udsSecurityAccess\n                user info: \"Firmware upload via UDS is protected by a UDS service called Security Access. This is an authentication protocol which uses a challenge-response scheme with cryptographic keys.\"\n                developer info: \"Interview with domain experts conducted by Nedo\"\n                ->  udsFirmwareUpload\n    }\n\n}\n\ncategory Networking {\n\n    asset VehicleNetwork extends Network\n        user info: \"Vehicle Networks include CAN bus, FlexRay and LIN bus.\"\n        developer info: \"Extended from coreLang.\"\n    {\n        //Override\n        | physicalAccess\n                user info: \"Physical access to the network. Merged coreLang asset Network with vehicleLang asset Network\"\n                +>\taccessNetworkLayer\n        \n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n\n        | accessUninspected\n                user info: \"Access implies the possibility to submit packets over the network. In a generic network, it does not imply the possibility to listen to others' traffic on the network. You are outside the router but with a possibility to communicate in to the network.\"\n                developer info: \"Overriding from network\"\n                +>\tdeny,\n                    applications.networkConnectUninspected,\n                    networkECUs.connect, // Reach ECUs connected network and try to connect, not access!\n                    accessUDSservices // But access on UDS services is possible because they can be protected by UdsSecurityAccess\n\n        | accessNetworkLayer\n                user info: \"Network layer access implies the possibility to submit messages over the network and the possibility to listen to others' traffic on the network.\"\n                developer info: \"Overriding from network\"\n                ->\taccessUninspected,\n                    _networkForwarding,\n                    eavesdrop,\n                    messageInjection,\n                    _networkSpecificAttack,\n                    j1939Attacks,\n                    networkECUs._networkServiceMessageInjection // This is for the case where the message confliction is disabled but attacking from the network.\n\n        | _networkForwarding @hidden\n                user info: \"An attacker that has access to a network connected ECU can also perform forwarding on that network using the connected GatewayECU. (helper attack)\"\n                -> trafficGatewayECU.forwarding\n\n        // Override\n        | eavesdrop\n                developer info: \"Those two extra attack steps are needed so that the compromised MessageID scenario to be able to work. Merged coreLang asset Network with vehicleLang asset Network\"\n                +>  dataflows.eavesdrop,\n                    dataflows.eavesdropId,\n                    dataflows.eavesdropAndBypassMsgConflictionProtection\n        // Override\n        | adversaryInTheMiddle\n                user info: \"This attack is reached only as an attacker's entry point or from GatewayEcu.fullAccess. It leads, among others, to dataflows MitM. Merged coreLang asset Network with vehicleLang asset Network\"\n                +>\taccessNetworkLayer,\n                    eavesdrop,\n                    dataflows.adversaryInTheMiddle,\n                    trafficGatewayECU.deny\n        // Override\n        | deny\n                user info: \"The network is made unavailable. Merged coreLang asset Network with vehicleLang asset Network\"\n                +> \tdataflows.deny\n        // This will require, by default, some effort especially for maliciousRespond, because message conflictions mechanisms are by default enabled.\n        // This attack is only reached as an entry point or from GatewayEcu.fullAccess, also see serviceMessageInjection.\n        | messageInjection\n                user info: \"Inject messages to dataflows means that attacker can try to transmit messages on the vehicle network but might not be sucessful because of the message confliction protection. It is also possible to perform a DoS.\"\n                ->\tdataflows.maliciousTransmitBypassConflitionProtection,\n                    deny\n\n        | _bypassIDPS @hidden\n                user info: \"Bypass IDPS on dataflows when the GatewayECU has IDPS enabled. (helper attack)\"\n                ->\tdataflows.maliciousTransmitBypassIDPS\n\n        | _noIDPS @hidden\n                user info: \"When no IDPS is connected/present on the GatewayECU. (helper attack)\"\n                ->\tdataflows.maliciousTransmitNoIDPS\n\n        | gainLINAccessFromCAN\n                developer info: \"This is an empty attack that will only be implemented on LINNetwork and it will be invoked by the ECU.\"\n\n        | j1939Attacks\n                user info: \"This is an empty attack that will only be implemented on J1939Network and it will be invoked by the ECU or by having network access.\"\n                developer info: \"Yelizaveta Burakova, Bill Hass, Leif Millar, and Andre Weimerskirch, Truck Hacking: An Experimental Analysis of the SAE J1939 Standard (2016)\"\n\n        | accessUDSservices\n                ->  networkFwUpdater.fullAccess\n    }\n\n    asset CANNetwork extends VehicleNetwork\n        user info: \"Represents the CAN bus network and the attacks that are possible on it.\"\n    {\n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n                ->\tbusOffAttack,\n                    exploitArbitration\n\n        | exploitArbitration [Exponential(0.1)]\n                user info: \"Exploiting the arbitration mechanism for message prioritization in CAN bus can lead to invalidation of legitimate messages/DoS and allow message tampering/injection.\"\n                developer info: \"Charlie Miller and Chris Valasek, 'Jeep Hack' & Pal-Stefan Murvay and Bogdan Groza, Security shortcomings and countermeasures for the SAE J1939 commercial vehicle bus protocol (2017)\"\n                ->\tdataflows.maliciousTransmit, // This is different from the messageInjection attack because, if successful, allows direct malicious respond and request.\n                    deny\n\n        & busOffAttack [Exponential(0.1)]\n                user info: \"Exploits the error-handling scheme of in-vehicle networks to disconnect good/uncompromised ECUs or cause DoS on the entire network. This is an easy to mount attack. This is also applicable on CAN-FD.\"\n                developer info: \"Kyong-Tak Cho and Kang G. Shin, Error Handling of In-vehicle Networks Makes Them Vulnerable (2016)\"\n                ->\tnetworkECUs.offline,\n                    deny\n\n        # busOffProtection\n                user info: \"Based on the defence mechanism proposed by the related paper\"\n                developer info: \"Kyong-Tak Cho and Kang G. Shin, Error Handling of In-vehicle Networks Makes Them Vulnerable (2016)\"\n                ->\tbusOffAttack\n    }\n\n    asset J1939Network extends CANNetwork\n        user info: \"SAE J1939 is a CAN-based protocol employed in many heavy duty vehicles.\"\n    {\n        // Override\n        | accessNetworkLayer\n                user info: \"Network layer access implies the possibility to submit messages over the network. It does not imply the possibility to listen to others' trafic on the network.\"\n                ->\tdeny,\n                    eavesdrop,\n                    messageInjection,\n                    networkECUs.connect\n\n        | eavesdrop\n                user info: \"An attacker can eavesdrop/sniff the network.\"\n                developer info: \"Luca Dariz, Massimiliano Ruggeri, Gianpiero Costantino and Fabio Martinelli, A Survey over Low-Level Security Issues in Heavy Duty Vehicles (2016)\"\n                -> \tj1939dataflows.eavesdrop\n\n        | adversaryInTheMiddle\n                    user info: \"Attackers can sometimes intercept and tamper with communications.\"\n                +> \taccessNetworkLayer,\n                    eavesdrop,\n                    j1939dataflows.adversaryInTheMiddle\n\n        | deny\n                user info: \"A DoS attack can happen on a J1939 network with three possible ways as described on the paper below.\"\n                developer info: \"Subhojeet Mukherjee et al., Practical DoS Attacks on Embedded Networks in Commercial Vehicles (2016)\"\n                -> \tj1939dataflows.deny\n\n        | messageInjection\n                developer info: \"Overriding from parent because in this type of networks, messageInjection should not happen with the same way.\"\n\n        | j1939MessageInjection\n                user info: \"Inject messages to J1939 means that attacker can make requests towards other J1939 nodes or PGNs (Parameter Group Number) and after effort to maliciously respond.\"\n                ->\tj1939dataflows.request,\n                    j1939dataflows.maliciousRespond\n\n        | j1939Attacks\n                user info: \"This attack step should work as an intermediate step to reach J1939 network specific attacks.\"\n                ->\teavesdrop,\n                    _advancedJ1939Attacks,\n                    j1939dataflows.maliciousRespond // Respond is generally always supported but requests might not.\n\n        & _advancedJ1939Attacks @hidden\n                user info: \"The attacks on this step are advanced in way that if the J1939 protocol is not fully supported, then those might not be sucessful.\"\n                developer info: \"Pal-Stefan Murvay and Bogdan Groza, Security shortcomings and countermeasures for the SAE J1939 commercial vehicle bus protocol (2017)\"\n                ->\tdeny,\n                    j1939MessageInjection\n\n        # noFullJ1939Support\n                user info: \"If only limited parts of the J1939 protocol are used then the J1939 specific attacks might not work. For example, requests might not be supported.\"\n                developer info: \"Pal-Stefan Murvay and Bogdan Groza, Security shortcomings and countermeasures for the SAE J1939 commercial vehicle bus protocol (2017)\"\n                -> _advancedJ1939Attacks\n    }\n\n    asset FlexRayNetwork extends VehicleNetwork\n        user info: \"Represents the FlexRay network and the attacks that are possible on it.\"\n    {\n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n                ->\tcommonTimeBaseAttack,\n                    exploitBusGuardian,\n                    sleepFrameAttack\n\n        | commonTimeBaseAttack [Gamma(2.0,5.0)]\n                user info: \"Send more than needed (> n/3 where n=# of nodes) SYNC messages within one communication cycle to make the whole network inoperable.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                ->\tdeny\n\n        | exploitBusGuardian [Exponential(0.15)]\n                user info: \"Utilize Bus Guardian for sending well-directed faked error messages to deactivate controllers. BusGuardian is hardened so much effort is needed.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009) & Philipp Mundhenk, Sebastian Steinhorst and Suhaib A. Fahmy, Security Analysis of Automotive Architectures using Probabilistic Model Checking (2015)\"\n                ->\tnetworkECUs.offline\n\n        & sleepFrameAttack [Exponential(0.1)]\n                user info: \"Send well-directed forged sleep frames to deactivate power-saving capable FlexRay controller.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                ->\tnetworkECUs.offline\n\n        # powerSavingIncapableNodes // Might need to be moved on ECU ??? But I leave it here for now...\n                user info: \"If FlexRay power-saving is not enabled then perform sleep frame attack.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                ->\tsleepFrameAttack\n    }\n\n    asset LINNetwork extends VehicleNetwork\n        user info: \"Represents the LIN bus network and the attacks that are possible on it\"\n    {\n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n                ->\tinjectHeaderOrTimedResponse,\n                    injectBogusSyncBytes\n\n        | injectBogusSyncBytes [Exponential(0.1)]\n                user info: \"Sending frames with bogus synchronization bytes within the SYNCH field makes the local LIN network inoperative or causes at least serious malfunctions\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                -> deny\n\n        | gainLINAccessFromCAN\n                // This attack is reached from ECU\n                user info: \"There are techniques that make it easy to gain access to the LIN bus through a CAN-bus node.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                ->\taccessNetworkLayer\n\n        & injectHeaderOrTimedResponse [Exponential(0.1)]\n                user info: \"This is a specific attack that can happen on LIN bus exploiting the error handling mechanism, but it is not so easy.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                ->\tdataflows.maliciousTransmit // This is different from the messageInjection attack because, if successful, allows direct malicious respond and request.\n\n        # headerOrTimedResponseProtection\n                user info: \"Based on the defense mechanism proposed by the related paper.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                ->\tinjectHeaderOrTimedResponse\n\n        // LIN is also unprotected against forged messages. So messageInjection exists also here.\n    }\n}\n\ncategory Communication {\n\n    abstract asset Dataflow\n        user info: \"Dataflow is a channel that contains Data in transit.\"\n    {\n        | eavesdrop\n                user info: \"An attacker that eavesdrops on the data flow, can access the contained data. That data may, in turn, be encrypted, thus preventing a breach of confidentiality.\"\n                ->\tdata.read\n\n        | deny\n                user info: \"A denial-of-service-attack on the dataflow makes the contained data inaccessible. The information may, however also be available elsewhere.\"\n                ->\tdata.delete\n\n        | adversaryInTheMiddle\n\n        | request\n\n        | respond\n\n        | maliciousTransmitNoIDPS\n\n        | maliciousTransmitBypassConflitionProtection\n\n        | maliciousTransmitBypassIDPS\n\n        | maliciousTransmit\n\n        & eavesdropId\n\n        & eavesdropAndBypassMsgConflictionProtection\n    }\n\n    asset ConnectionOrientedDataflow extends Dataflow\n        user info: \"A connection oriented dataflow is a unicast/multicast transmission that contains Data in transit.\"\n    {\n        | adversaryInTheMiddle\n                user info: \"An attacker that man-in-the-middles the data flow, can control the contained data. That data may, in turn, be encrypted and authenticated, thus preventing a breach of confidentiality and integrity.\"\n                +>\teavesdrop,\n                    deny,\n                    request,\n                    respond,\n                    data.write,\n                    data.read,\n                    data.delete\n\n        | request\n                ->\tservices.networkConnectUninspected\n\n        | respond\n                ->\tclients.networkConnectUninspected\n\n        | maliciousRespond [Exponential(0.614)]\n                user info: \"Confliction protection mechanism does not prevent malicious responds, but it typically takes time for the attacker to bypass it.\"\n                -> respond\n    }\n\n    asset ConnectionlessDataflow extends Dataflow\n        user info: \"A connectionless dataflow is a multicast/broadcast transmission that contains Data in transit.\"\n        developer info: \"In a broadcast network, there is no need to have clients because everyone receives the message. Additionally, in an event-driven network like CAN, there is no need for request.\"\n    {\n        | eavesdrop\n                user info: \"An attacker that eavesdrops on the data flow, can access the contained data. That data may, in turn, be encrypted, thus preventing a breach of confidentiality.\"\n                -> \tdata.read\n\n        | adversaryInTheMiddle\n                user info: \"An attacker that man-in-the-middles the data flow, can control the contained data. That data may, in turn, be encrypted and authenticated, thus preventing a breach of confidentiality and integrity.\"\n                +> \teavesdrop,\n                    deny,\n                    data.write,\n                    data.read,\n                    data.delete,\n                    transmit // Acts like IDPS is disabled, because MitM attacks are not easily, or not at all, detected by IDPS.\n                    // This agrees with the current securiCore implementation. MiTM leads to direct request/respond.\n\n        | maliciousTransmitNoIDPS\n                user info: \"Perform a malicious transmission when IDPS is disabled on GatewayECU. However even when IDPS is off effort is needed to bypass message confliction mechanism.\"\n                ->\tmaliciousTransmitBypassConflitionProtection\n\n        | maliciousTransmitBypassConflitionProtection [Exponential(0.314)]\n                user info: \"Confliction protection mechanism does not prevent malicious transmissions, but it typically takes time for the attacker to bypass it.\"\n                ->  transmit,\n                    eavesdropAndBypassMsgConflictionProtection\n\n        | maliciousTransmitBypassIDPS [Exponential(0.613)]\n                user info: \"IDPS's does not prevent all malicious transmissions, and it typically takes time for the attacker to bypass it.\"\n                developer info: \"The time to bypass a tuned and updated IDPS is studied in 'T. Sommestad, H. Holm, M. Ekstedt, Estimates of success rates of remote arbitrary code execution attacks, Information Management & Computer Security (2012)' and 'H.Holm, T.Sommestad, U.Franke, M.Ekstedt, Success rate of remote code execution attacks - expert assessments and observations, Journal of Universal Computer Science 18 (6) (2012)'\"\n                ->\ttransmit\n\n        | maliciousTransmit\n                user info: \"The act of trying to maliciously transmit. This happens when IDPS is not in place so the attacker can make malicious transmissions unobstructed. Reached only from network specific attacks and network service.\"\n                ->\ttransmit\n\n        | transmit\n                user info: \"The result of a successful transmit.\"\n                ->\ttransmitter.networkConnectUninspected\n\n        & eavesdropId\n                user info: \"The attacker was able to eavesdrop the unique ID of the message.\"\n                ->  dataflowId.read\n\n        & eavesdropAndBypassMsgConflictionProtection\n                user info: \"The attacker was able to eavesdrop the unique ID of the message while he also managed to bypass the confliction protection mechanism .\"\n                ->  dataflowId.read\n    }\n}\n\ncategory Security {\n\n    asset VehicularIdentity extends Identity\n        developer info: \"Extended from coreLang.\"\n    {\n        | assume\n                user info: \"A compromised identity leads to authentication on machines, access rights on data and also authentication on other connected identities.\"\n                +> \taccessedMachines.authenticate,\n                    connectMachines.authenticate,\n                    readPrivData.authorizedRead,\n                    writePrivData.authorizedWrite,\n                    deletePrivData.authorizedDelete,\n                    childId.attemptAssume\n    }\n\n    asset VehicularCredentials extends Credentials\n        developer info: \"Extended from coreLang.\"\n    {\n        | read\n                +> \tidentities.attemptAssume,\n                    readFirmwareAccessKey\n\n        | readFirmwareAccessKey\n                user info: \"The action of reading a stored firmware validation/access key.\"\n                ->  identities[VehicularIdentity].connectMachines.passFirmwareValidation,\n                    identities[VehicularIdentity].connectMachines.passUdsFirmwareModification,\n                    identities[VehicularIdentity].accessedMachines.passFirmwareValidation,\n                    identities[VehicularIdentity].accessedMachines.passUdsFirmwareModification\n    }\n\n    asset MessageID\n        user info: \"Represents the ID that resides on the header of a transmitted packet/message/dataflow.\"\n    {\n        | read\n                user info: \"The action of reading the message ID transfered by the dataflow.\"\n                ->  dataflow.receiver.impersonateId\n    }\n\n}\n\nassociations {\n    Machine\t[hostMachine]                   0..1 <-- machineExecution       --> *           [machineExecutedApps]   VehicularApplication\n    VehicularIdentity \t[vehicularIdentity]     * <-- AccessPrivileges\t        --> *           [accessedMachines]      Machine\n        user info: \"These identities grant access to the machine.\"\n    VehicularIdentity \t[connectPrivileges]     * <-- ConnectionPrivileges      --> *           [connectMachines]       Machine\n        user info: \"These privileges are granted to anyone who connects to a machine.\"\n    VehicularIdentity \t[assignedVehicularIdentity]     * <-- Assignment                --> *           [assignedApplications]  VehicularApplication\n        user info: \"Applications needs to be granted certain privileges when executing on a platform. When the application is compromised, the attacker gains its privileges on the platform.\"\n    //VehicularIdentity     [vehicularIdentities]         * <-- Credentials               --> *           [vehicularCredentials]  VehicularCredentials\n    VehicleNetwork \t[networks]                      * <-- Communication             --> *           [dataflows]             Dataflow\n        user info: \"In general, networks use dataflows for communication.\"\n    //VehicleNetwork     [machineNetworks]               * <-- MachineConnection         --> *           [networkMachines]       Machine\n    //     user info: \"Machines can be connected to networks. If services are not explicitly connected to other networks, it is assumed that they are communicating over the physically connected one.\"\n    J1939Network        [j1939networks]         * <-- J1939Communication        --> *           [j1939dataflows]         ConnectionOrientedDataflow\n        user info: \"A J1939 network uses connection oriented dataflows for communication although it is a CAN-based network.\"\n    Dataflow    [dataflow]                      0..1 <-- DataTransfer           --> 0..1        [data]                  Data\n        user info: \"The dataflow transmits data.\"\n        developer info: \"A dataflow cannot feature multiple data, as these may have different properties, e.g. one authenticated and one not.\"\n    Dataflow    [dataflows]                     * <-- Request                   --> *           [clients]               NetworkClient\n    Dataflow\t[dataflows]                     * <-- Response                  --> *           [services]              NetworkService\n        user info: \"A network service or a network client makes use of dataflows that can be either connection oriented or connectionless.\"\n    ConnectionlessDataflow      [dataflows]     * <-- Transmission              --> 0..1        [transmitter]           TransmitterService\n        user info: \"A transmitter service on a vehicle network uses connectionless dataflows for transmitting data.\"\n    ConnectionlessDataflow      [dataflows]     * <-- Transmission              --> *           [receiver]              VehicleNetworkReceiver\n        user info: \"A receiver uses connectionless dataflows for receiving data on a vehicle network.\"\n    ConnectionlessDataflow      [dataflow]      * <-- DataflowID                --> 0..1        [dataflowId]            MessageID\n        user info: \"Each bus network dataflow has a unique identifier.\"\n    IDPS        [idps]                          0..1 <-- IDPSProtection         --> 1\t        [idpsGatewayECU]        GatewayECU\n        user info: \"An IDPS can be connected to a GatewayECU. Here it is modeled as a centralized inline IDPS.\"\n    Machine     [connectionVulnerableMachine]   * <-- ConnectionVulnerability   --> 0..1        [connectionVulnerabilities]     Vulnerability\n    Machine\t[accessVulnerableMachine]       * <-- AccessVulnerability       --> 0..1        [accessVulnerabilities]         Vulnerability\n    VehicleNetwork      [vehiclenetworks]       * <-- EcuConnection             --> *           [networkECUs]           ECU\n    VehicleNetwork \t[trafficVNetworks]      * <-- GatewayConnection         --> *           [trafficGatewayECU]     GatewayECU\n    ECU         [hardware]                      1 <-- FirmwareExecution         --> 0..1        [firmware]              Firmware\n        user info: \"Every ECU can have (up to one) firmware running on it.\"\n    ECU\t\t[firmwareTarget]                1 <-- FirmwareUpdate            --> 0..1        [firmwareUpdater]       FirmwareUpdaterService\n        user info: \"Every ECU can have a firmware updater UDS service responsible for handling the firmware updates.\"\n    ECU \t[hardwarePlatform]              0..1 <-- SensorsOrActuators     --> *           [sensorsOrActuators]    SensorOrActuator\n        user info: \"An ECU can be connected with physical machines such as actuators and/or sensors.\"\n    VehicleNetwork      [fwUpdaterNetworks]     0..1 <-- FwUpdaterServices      --> *           [networkFwUpdater]      FirmwareUpdaterService\n        user info: \"A FirmwareUpdaterService can be connected to a vehicle network for accepting incoming connections.\"\n}", "Type": "language"}
{"Output": "category System {\n    \n    abstract asset PhysicalMachine\n        user info: \"Specifies any physical machine.\"\n    {\n        | connect\n                user info: \"Connect leads directly to access on a physical machine since no authentication is done/needed.\"\n                ->  fullAccess\n\n        | fullAccess\n                developer info: \"This is empty in order to be overriden.\"\n    }\n\n    asset SensorOrActuator extends PhysicalMachine\n        user info: \"Specifies physical machines like sensors and actuators.\"\n    {\n        | connect\n                user info: \"Connect leads directly to access on a physical machine since no authentication is done/needed.\"\n                ->  fullAccess\n\n        | fullAccess\n                user info: \"Access means that the attacker has full access on the machine, ex. he can manipulate the actuator's behavior or sensor's measurements.\"\n                ->  manipulate\n\n        | manipulate\n                developer info: \"This is empty for now because it is enough to reach this.\"\n    }\n\n    asset Machine extends Hardware\n        user info: \"Specifies any machine that has higher complexity than a simple actuator or sensor.\"\n        developer info: \"Extended from coreLang.\"\n    {\n\n        | connect\n                user info: \"Attempt to connect to a machine.\"\n                ->\tauthenticatedAccess,\n                    connectPrivileges.assume,\n                    connectionVulnerabilities.exploit\n\n        | authenticate\n                user info: \"Does the attacker have the credentials of an identity?\"\n                ->\tauthenticatedAccess\n\n        & authenticatedAccess\n                  user info: \"One way to gain access to a machine is through legitimate authentication.\"\n                ->\tfullAccess\n\n        | bypassAccessControl [Exponential(0.02)]\n                user info: \"An attacker can bypass access control and authenticate to the machine.\"\n                -> fullAccess\n\n        | fullAccess\n                developer info: \"We don't explicitly model root access; that is not a sound primitive. Instead, such an identity can be modelled explicitly by providing an account with access to all machineExecutedApps and all data.\"\n                +>\t_machineAccess\n\n        | idControl\n                user info: \"This is used when ID is compromised from dataflow.\"\n\n        | _machineAccess @hidden\n                developer info: \"Again, this is a helper attack step that will also be used from the childs of this asset.\"\n                ->\tdeny,\n                    _accessData,\n                    machineExecutedApps.localConnect,\n                    accessVulnerabilities.exploit\n\n        | deny\n                user info: \"Perform a DoS attack on the machine.\"\n                ->\tmachineExecutedApps.deny,\n                    hostedData.deny\n\n        | _accessData @hidden\n                user info: \"A helper attack step to reach request access on data stored on a machine\"\n                ->  hostedData.attemptRead,\n                    hostedData.attemptWrite,\n                    hostedData.attemptDelete\n\n        | passFirmwareValidation\n                developer info: \"Again, this is a blank helper attack step that will also be used from the childs of this asset.\"\n\n        | udsFirmwareModification\n                developer info: \"This is a blank helper attack step that should be reached from FirmwareUpdaterService.\"\n\n        | passUdsFirmwareModification\n                developer info: \"This is a blank helper attack step that should be reached from FirmwareUpdaterService.\"\n\n        | gainNetworkAccess\n                user info: \"This attack step will be only implemented on the infotainment system asset.\"\n    }\n\n    asset ECU extends Machine\n        user info: \"Specifies any ECU/MCU/controller in a vehicle.\"\n        developer info: \"Created as new parent class because the existing Machine had many unrelated attacks.\"\n    {\n        | connect\n                user info: \"Attackers can attempt to connect to the ECU and change the operation mode if they have access to the network, services, dataflows, etc...\"\n                +>  attemptChangeOperationMode\n                    //firmwareUpdater.networkConnectUninspected\n\n        | maliciousFirmwareUpload\n                user info: \"Maliciously uploading a forged firmware leads to full access on the ECU and the ability to inject/eavesdrop messages on the previous running services and network.\"\n                ->  fullAccess,\n                    _ecuNetworkAccess\n\n        & uploadFirmware\n                user info: \"Uploading firmware leads to full access on the ECU and the ability to inject/eavesdrop messages on the previous running services and network.\"\n                ->  _ecuNetworkAccess\n\n        | _ecuNetworkAccess @hidden\n                developer info: \"This a helper attack step because both above attack steps are leading to the same connections.\"\n                ->      vehiclenetworks.accessUninspected,\n                        vehiclenetworks.eavesdrop,\n                        vehiclenetworks.messageInjection,\n                        vehiclenetworks.j1939Attacks,\n                        vehiclenetworks._networkSpecificAttack,\n                        vehiclenetworks._networkForwarding\n\n        | udsFirmwareModification\n                user info: \"This attack step is reached after access on FirmwareUpdaterService.\"\n                ->  firmwareUpdater.udsFirmwareUpload\n\n        | passUdsFirmwareModification\n                user info: \"Same as below, if the cryptographic key is accessed.\"\n                ->  firmwareUpdater.passUdsFirmwareUpload\n\n        | passFirmwareValidation\n                user info: \"If the firmware validation key is stored in the ECU, this means that the firmware validation is passed and a new firmware can be uploaded.\"\n                ->  uploadFirmware\n\n        | fullAccess\n                user info: \"Attackers have access to the ECU if they have compromised its firmware (after custom firmware upload), bypassed access control (after authentication via diagnostics) or properly authenticated themselves.\"\n                +>\tsensorsOrActuators.manipulate,\n                    changeOperationMode,\n                    gainLINAccessFromCAN,\n                    bypassMessageConfliction,\n                    _ecuNetworkAccess\n\n        | idControl\n                user info: \"This attack step is reached after the ID is compromised from dataflow and allows an attacker to manipulate the connected sensors or actuators.\"\n                ->  sensorsOrActuators.manipulate\n\n        | offline\n                user info: \"When the ECU is taken offline by some other attack step. Offline means that the ECU is still powered on but unable to communicate on its bus. The effort needed to achieve this is applied on the distributions of the parent attacks. This also means that the connected sensors or actuators can be manipulated.\"\n                ->\tdeny,\n                    bypassMessageConfliction\n\n        | shutdown\n                user info: \"When the ECU is powered off by some other attack step. The effort needed to achieve this is applied on the distributions of the parent attacks.\"\n                ->\tbypassMessageConfliction,\n                    deny // Deny access to data and machineExecutedApps\n\n        & changeOperationMode\n                user info: \"Put the ECU into diagnostics (if vehicle is moving slowly or is stopped) or even update mode (bootmode). Leads to shutdown since attacker must have achieved access on this ECU to reach this step.\"\n                // This can bypass message conflictions and IDPS because the legitimate ECU will no lorger send messages and the attacker can imitate it, if carefull.\n                -> \tshutdown,\n                    firmware.maliciousFirmwareModification,\n                    uploadFirmware\n\n        & attemptChangeOperationMode [Exponential(0.1)]\n                user info: \"Put the ECU into diagnostics (if vehicle is moving slowly or is stopped) or even update mode (bootmode) but after some effort. This stops ECU from communicating on its bus -> offline\"\n                -> \toffline,\n                    bypassMessageConfliction,\n                    firmware.maliciousFirmwareModification\n\n        # operationModeProtection\n                user info: \"Either prevent diagnostics mode after vehicles starts moving or allow diagnostics mode only after some physical change is done on vehicle.\"\n                developer info: \"Charlie Miller and Chris Valasek, CAN message injection (2016).\"\n                ->\tchangeOperationMode,\n                    attemptChangeOperationMode\n\n        | bypassMessageConfliction\n                user info: \"Bypass message confliction protection mechanisms by changing ECU's operation mode -> no conflicts -> service message injection.\"\n                ->  machineExecutedApps.serviceMessageInjection\n\n        & _networkServiceMessageInjection @hidden\n                user info: \"Inject forged service messages that could notify about vehicle's fault or report fake status (speed, operation mode, etc.). This can even lead to unresponsive ECU (TPMS). This is reached from network access.\"\n                ->\tmachineExecutedApps.serviceMessageInjection\n\n        # messageConflictionProtection\n                user info: \"Defend against message injection by using message confliction mechanisms (detect messages with own ID). This acts like a host-based IDS.\"\n                developer info: \"Pierre Kleberger, Tomas Olovsson, and Erland Jonsson, Security Aspects of the In-Vehicle Network in the Connected Car (2011).\"\n                ->\t_networkServiceMessageInjection\n\n        | gainLINAccessFromCAN\n                user info: \"There are techniques that make it easy to gain access to the LIN bus through a CAN-bus node.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                //  NOTE: This should happen only with a probability and not always maybe?\n                ->\tvehiclenetworks.gainLINAccessFromCAN\n\n    }\n\n    asset GatewayECU extends ECU\n        user info: \"Specifies the ECU that acts as a gateway/firewall on a vehicle.\"\n    {\n        | fullAccess\n                developer info: \"Overriding from ECU\"\n                +>\ttrafficVNetworks.adversaryInTheMiddle, // This will act as Firewall and IDPS are disabled!\n                    forwarding\n\n        | forwarding\n                developer info: \"Forwarding is the lightest interaction with the gateway, where the gateway simply retransmits received messages. Vulnerabilities may, however, lead to compromise of the gateway as well as of the associated firewall. Therefore, Forwarding leads to Connect.\"\n                -> \tconnect,\n                    bypassFirewall  // If firewall is not enabled then bypass it.\n\n        & bypassFirewall\n                user info: \"If firewall is disabled, then attacker can bypass it.\"\n                ->\tgatewayBypassIDPS, // Added here to stop those attacks when firewall is enabled.\n                    gatewayNoIDPS,\n                    trafficVNetworks.accessUDSservices\n\n        # firewallProtection // Firewall is just a defense on gateway ECU.\n                user info: \"Firewall protection comes from the existence of a correctly configured firewall.\"\n                -> bypassFirewall\n\n        | deny\n                user info: \"Perform denial of service attack on the connected networks.\"\n                -> \ttrafficVNetworks.deny\n\n        // IDPS is modeled as a centralized inline IDPS\n        E  idpsExists\n                user info: \"Check for the existence of an IDPS.\"\n                <- idps\n                -> gatewayBypassIDPS\n\n        & gatewayBypassIDPS\n                user info: \"Bypass IDPS protection when IDPS is in place, but only if firewall is disabled.\"\n                -> trafficVNetworks._bypassIDPS\n\n        !E idpsDoesNotExist\n                user info: \"Check for the non existence of an IDPS.\"\n                <-\tidps\n                ->\tgatewayNoIDPS\n\n        & gatewayNoIDPS\n                user info: \"IDPS is disabled so the attacker can access the network unrestricted, but only if firewall is also disabled.\"\n                -> trafficVNetworks._noIDPS,\n                   trafficVNetworks.accessNetworkLayer // Moved it here from forwarding to allow imediate network access only if idps does not exist.\n    }\n\n    abstract asset VehicularApplication extends Application\n        developer info: \"Extended from coreLang.\"\n    {   \n        | specificAccess\n                +>      hostMachine.connect\n        | fullAccess\n                +>      hostMachine.connect,\n                        assignedVehicularIdentity.attemptAssume\n\n        | serviceMessageInjection\n                developer info: \"This is an empty attack step that will only be used from the childs of this asset.\"\n    }\n\n    asset Firmware extends VehicularApplication\n        user info: \"Specifies the firmware running on an ECU as an application.\"\n    {\n        | maliciousFirmwareModification\n                user info: \"Perform a firmware update either by cracking Secure Boot or worse by exploiting the absence of it.\"\n                ->  bypassSecureBoot,\n                    crackSecureBoot\n\n        & crackFirmwareValidation [Exponential(0.2)]\n                user info: \"Crack firmware validation if it is enabled.\"\n                ->  hardware.maliciousFirmwareUpload\n\n        & bypassFirmwareValidation\n                user info: \"Bypass firmware validation if it is not enabled.\"\n                ->  hardware.maliciousFirmwareUpload\n\n        # firmwareValidation\n                user info: \"Code signing and verification during upload, use of strong checksum functions and/or don't distribute the private keys for signing.\"\n                developer info: \"Rubicon - Zero-knowledge Armor for Automotive Security, RubiconLabs\"\n                ->\tbypassFirmwareValidation\n\n        & bypassSecureBoot\n                user info: \"Bypass Secure Boot if it is not enabled Then validate a firmware update either by cracking (brute forcing) the checksum or worse by exploiting the absence of verification.\"\n                ->  bypassFirmwareValidation,\n                    crackFirmwareValidation\n\n        | crackSecureBoot [Exponential(0.1)]\n                user info: \"Crack Secure Boot if it is enabled is hard\"\n                ->  hardware.maliciousFirmwareUpload\n\n        # secureBoot\n                user info: \"SecureBoot is a protection mechanism that validates the boot software and the firmware at system boot time.\"\n                developer info: \"SecureBoot should make running of forged firmware even harder when enabled. Therefore, it stops firmware validation attack steps.\"\n                ->  bypassSecureBoot\n    }\n\n    asset OperatingSystem extends VehicularApplication {\n       // Currently simple ECUs and GatewayECUs don't have an OS. But the infotainment system has.\n    }\n\n    asset Service extends VehicularApplication {\n        // Intentionally left blank\n    }\n\n    asset Client extends VehicularApplication {\n        // Intentionally left blank\n    }\n\n    asset NetworkClient extends Client\n        user info: \"Represents a client connected to a service running on a network.\"\n    {\n        | fullAccess\n                +>\tdataflows.request\n    }\n\n    asset VehicleNetworkReceiver extends Client\n        user info: \"Represents a receiver/client for connectionless dataflows connected to a transmitter running on a vehicle network.\"\n    {\n        | fullAccess\n                +>\tdataflows.eavesdrop\n\n        | impersonateId\n                ->  hostMachine.idControl\n    }\n\n    asset NetworkService extends Service\n        user info: \"Represents a service running on top of a network.\"\n    {\n\n        | fullAccess\n                +>\tdataflows.respond\n    }\n\n    asset UDSService extends NetworkService\n        user info: \"Represents an ISO 14229 - Unified Diagnostics Service (UDS) running on an ECU.\"\n        developer info: \"Pierre Kleberger, On Securing the Connected Car: Methods and Protocols for Secure Vehicle Diagnostics, PhD Thesis (2015)\"\n    {\n        | fullAccess\n                user info: \"Access on an UDS service provides access on stored data, possibility to update firmware and change operation status of the ECU.\"\n                +>\tdataflows.respond,\n                    hostMachine._accessData\n    }\n\n    asset TransmitterService extends Service\n        user info: \"Represents a service/transmitter running on an ECU and on top of a vehicle network.\"\n    {\n        | fullAccess\n                +>\tdataflows.transmit,\n                    dataflows.deny // This is only possible here because only one Transmitter can be connected to a conectionless dataflow\n\n        | serviceMessageInjection\n                user info: \"Tamper dataflows that are conneceted to this network transmitter after bypassing message confliction on the ECU.\"\n                ->\tdataflows.maliciousTransmit,\n                    dataflows.eavesdropId\n    }\n\n    asset FirmwareUpdaterService extends UDSService\n        user info:\"Specifies the firmware updating procedure/UDS service on an ECU.\"\n    {\n        | fullAccess\n                +>  firmwareTarget.udsFirmwareModification\n\n        & udsFirmwareUpload\n                user info: \"If UDS Security Access defense is disabled, attacker can maliciously upload firmware.\"\n                ->  firmwareTarget.maliciousFirmwareUpload\n\n        | passUdsFirmwareUpload\n                user info: \"If the cryptographic key of Security Access is read then, the firmware upload procedure can easily be initiated.\"\n                ->  firmwareTarget.passFirmwareValidation\n\n        # udsSecurityAccess\n                user info: \"Firmware upload via UDS is protected by a UDS service called Security Access. This is an authentication protocol which uses a challenge-response scheme with cryptographic keys.\"\n                developer info: \"Interview with domain experts conducted by Nedo\"\n                ->  udsFirmwareUpload\n    }\n\n}", "Type": "category"}
{"Output": "category Networking {\n\n    asset VehicleNetwork extends Network\n        user info: \"Vehicle Networks include CAN bus, FlexRay and LIN bus.\"\n        developer info: \"Extended from coreLang.\"\n    {\n        //Override\n        | physicalAccess\n                user info: \"Physical access to the network. Merged coreLang asset Network with vehicleLang asset Network\"\n                +>\taccessNetworkLayer\n        \n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n\n        | accessUninspected\n                user info: \"Access implies the possibility to submit packets over the network. In a generic network, it does not imply the possibility to listen to others' traffic on the network. You are outside the router but with a possibility to communicate in to the network.\"\n                developer info: \"Overriding from network\"\n                +>\tdeny,\n                    applications.networkConnectUninspected,\n                    networkECUs.connect, // Reach ECUs connected network and try to connect, not access!\n                    accessUDSservices // But access on UDS services is possible because they can be protected by UdsSecurityAccess\n\n        | accessNetworkLayer\n                user info: \"Network layer access implies the possibility to submit messages over the network and the possibility to listen to others' traffic on the network.\"\n                developer info: \"Overriding from network\"\n                ->\taccessUninspected,\n                    _networkForwarding,\n                    eavesdrop,\n                    messageInjection,\n                    _networkSpecificAttack,\n                    j1939Attacks,\n                    networkECUs._networkServiceMessageInjection // This is for the case where the message confliction is disabled but attacking from the network.\n\n        | _networkForwarding @hidden\n                user info: \"An attacker that has access to a network connected ECU can also perform forwarding on that network using the connected GatewayECU. (helper attack)\"\n                -> trafficGatewayECU.forwarding\n\n        // Override\n        | eavesdrop\n                developer info: \"Those two extra attack steps are needed so that the compromised MessageID scenario to be able to work. Merged coreLang asset Network with vehicleLang asset Network\"\n                +>  dataflows.eavesdrop,\n                    dataflows.eavesdropId,\n                    dataflows.eavesdropAndBypassMsgConflictionProtection\n        // Override\n        | adversaryInTheMiddle\n                user info: \"This attack is reached only as an attacker's entry point or from GatewayEcu.fullAccess. It leads, among others, to dataflows MitM. Merged coreLang asset Network with vehicleLang asset Network\"\n                +>\taccessNetworkLayer,\n                    eavesdrop,\n                    dataflows.adversaryInTheMiddle,\n                    trafficGatewayECU.deny\n        // Override\n        | deny\n                user info: \"The network is made unavailable. Merged coreLang asset Network with vehicleLang asset Network\"\n                +> \tdataflows.deny\n        // This will require, by default, some effort especially for maliciousRespond, because message conflictions mechanisms are by default enabled.\n        // This attack is only reached as an entry point or from GatewayEcu.fullAccess, also see serviceMessageInjection.\n        | messageInjection\n                user info: \"Inject messages to dataflows means that attacker can try to transmit messages on the vehicle network but might not be sucessful because of the message confliction protection. It is also possible to perform a DoS.\"\n                ->\tdataflows.maliciousTransmitBypassConflitionProtection,\n                    deny\n\n        | _bypassIDPS @hidden\n                user info: \"Bypass IDPS on dataflows when the GatewayECU has IDPS enabled. (helper attack)\"\n                ->\tdataflows.maliciousTransmitBypassIDPS\n\n        | _noIDPS @hidden\n                user info: \"When no IDPS is connected/present on the GatewayECU. (helper attack)\"\n                ->\tdataflows.maliciousTransmitNoIDPS\n\n        | gainLINAccessFromCAN\n                developer info: \"This is an empty attack that will only be implemented on LINNetwork and it will be invoked by the ECU.\"\n\n        | j1939Attacks\n                user info: \"This is an empty attack that will only be implemented on J1939Network and it will be invoked by the ECU or by having network access.\"\n                developer info: \"Yelizaveta Burakova, Bill Hass, Leif Millar, and Andre Weimerskirch, Truck Hacking: An Experimental Analysis of the SAE J1939 Standard (2016)\"\n\n        | accessUDSservices\n                ->  networkFwUpdater.fullAccess\n    }\n\n    asset CANNetwork extends VehicleNetwork\n        user info: \"Represents the CAN bus network and the attacks that are possible on it.\"\n    {\n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n                ->\tbusOffAttack,\n                    exploitArbitration\n\n        | exploitArbitration [Exponential(0.1)]\n                user info: \"Exploiting the arbitration mechanism for message prioritization in CAN bus can lead to invalidation of legitimate messages/DoS and allow message tampering/injection.\"\n                developer info: \"Charlie Miller and Chris Valasek, 'Jeep Hack' & Pal-Stefan Murvay and Bogdan Groza, Security shortcomings and countermeasures for the SAE J1939 commercial vehicle bus protocol (2017)\"\n                ->\tdataflows.maliciousTransmit, // This is different from the messageInjection attack because, if successful, allows direct malicious respond and request.\n                    deny\n\n        & busOffAttack [Exponential(0.1)]\n                user info: \"Exploits the error-handling scheme of in-vehicle networks to disconnect good/uncompromised ECUs or cause DoS on the entire network. This is an easy to mount attack. This is also applicable on CAN-FD.\"\n                developer info: \"Kyong-Tak Cho and Kang G. Shin, Error Handling of In-vehicle Networks Makes Them Vulnerable (2016)\"\n                ->\tnetworkECUs.offline,\n                    deny\n\n        # busOffProtection\n                user info: \"Based on the defence mechanism proposed by the related paper\"\n                developer info: \"Kyong-Tak Cho and Kang G. Shin, Error Handling of In-vehicle Networks Makes Them Vulnerable (2016)\"\n                ->\tbusOffAttack\n    }\n\n    asset J1939Network extends CANNetwork\n        user info: \"SAE J1939 is a CAN-based protocol employed in many heavy duty vehicles.\"\n    {\n        // Override\n        | accessNetworkLayer\n                user info: \"Network layer access implies the possibility to submit messages over the network. It does not imply the possibility to listen to others' trafic on the network.\"\n                ->\tdeny,\n                    eavesdrop,\n                    messageInjection,\n                    networkECUs.connect\n\n        | eavesdrop\n                user info: \"An attacker can eavesdrop/sniff the network.\"\n                developer info: \"Luca Dariz, Massimiliano Ruggeri, Gianpiero Costantino and Fabio Martinelli, A Survey over Low-Level Security Issues in Heavy Duty Vehicles (2016)\"\n                -> \tj1939dataflows.eavesdrop\n\n        | adversaryInTheMiddle\n                    user info: \"Attackers can sometimes intercept and tamper with communications.\"\n                +> \taccessNetworkLayer,\n                    eavesdrop,\n                    j1939dataflows.adversaryInTheMiddle\n\n        | deny\n                user info: \"A DoS attack can happen on a J1939 network with three possible ways as described on the paper below.\"\n                developer info: \"Subhojeet Mukherjee et al., Practical DoS Attacks on Embedded Networks in Commercial Vehicles (2016)\"\n                -> \tj1939dataflows.deny\n\n        | messageInjection\n                developer info: \"Overriding from parent because in this type of networks, messageInjection should not happen with the same way.\"\n\n        | j1939MessageInjection\n                user info: \"Inject messages to J1939 means that attacker can make requests towards other J1939 nodes or PGNs (Parameter Group Number) and after effort to maliciously respond.\"\n                ->\tj1939dataflows.request,\n                    j1939dataflows.maliciousRespond\n\n        | j1939Attacks\n                user info: \"This attack step should work as an intermediate step to reach J1939 network specific attacks.\"\n                ->\teavesdrop,\n                    _advancedJ1939Attacks,\n                    j1939dataflows.maliciousRespond // Respond is generally always supported but requests might not.\n\n        & _advancedJ1939Attacks @hidden\n                user info: \"The attacks on this step are advanced in way that if the J1939 protocol is not fully supported, then those might not be sucessful.\"\n                developer info: \"Pal-Stefan Murvay and Bogdan Groza, Security shortcomings and countermeasures for the SAE J1939 commercial vehicle bus protocol (2017)\"\n                ->\tdeny,\n                    j1939MessageInjection\n\n        # noFullJ1939Support\n                user info: \"If only limited parts of the J1939 protocol are used then the J1939 specific attacks might not work. For example, requests might not be supported.\"\n                developer info: \"Pal-Stefan Murvay and Bogdan Groza, Security shortcomings and countermeasures for the SAE J1939 commercial vehicle bus protocol (2017)\"\n                -> _advancedJ1939Attacks\n    }\n\n    asset FlexRayNetwork extends VehicleNetwork\n        user info: \"Represents the FlexRay network and the attacks that are possible on it.\"\n    {\n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n                ->\tcommonTimeBaseAttack,\n                    exploitBusGuardian,\n                    sleepFrameAttack\n\n        | commonTimeBaseAttack [Gamma(2.0,5.0)]\n                user info: \"Send more than needed (> n/3 where n=# of nodes) SYNC messages within one communication cycle to make the whole network inoperable.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                ->\tdeny\n\n        | exploitBusGuardian [Exponential(0.15)]\n                user info: \"Utilize Bus Guardian for sending well-directed faked error messages to deactivate controllers. BusGuardian is hardened so much effort is needed.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009) & Philipp Mundhenk, Sebastian Steinhorst and Suhaib A. Fahmy, Security Analysis of Automotive Architectures using Probabilistic Model Checking (2015)\"\n                ->\tnetworkECUs.offline\n\n        & sleepFrameAttack [Exponential(0.1)]\n                user info: \"Send well-directed forged sleep frames to deactivate power-saving capable FlexRay controller.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                ->\tnetworkECUs.offline\n\n        # powerSavingIncapableNodes // Might need to be moved on ECU ??? But I leave it here for now...\n                user info: \"If FlexRay power-saving is not enabled then perform sleep frame attack.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                ->\tsleepFrameAttack\n    }\n\n    asset LINNetwork extends VehicleNetwork\n        user info: \"Represents the LIN bus network and the attacks that are possible on it\"\n    {\n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n                ->\tinjectHeaderOrTimedResponse,\n                    injectBogusSyncBytes\n\n        | injectBogusSyncBytes [Exponential(0.1)]\n                user info: \"Sending frames with bogus synchronization bytes within the SYNCH field makes the local LIN network inoperative or causes at least serious malfunctions\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                -> deny\n\n        | gainLINAccessFromCAN\n                // This attack is reached from ECU\n                user info: \"There are techniques that make it easy to gain access to the LIN bus through a CAN-bus node.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                ->\taccessNetworkLayer\n\n        & injectHeaderOrTimedResponse [Exponential(0.1)]\n                user info: \"This is a specific attack that can happen on LIN bus exploiting the error handling mechanism, but it is not so easy.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                ->\tdataflows.maliciousTransmit // This is different from the messageInjection attack because, if successful, allows direct malicious respond and request.\n\n        # headerOrTimedResponseProtection\n                user info: \"Based on the defense mechanism proposed by the related paper.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                ->\tinjectHeaderOrTimedResponse\n\n        // LIN is also unprotected against forged messages. So messageInjection exists also here.\n    }\n}", "Type": "category"}
{"Output": "category Communication {\n\n    abstract asset Dataflow\n        user info: \"Dataflow is a channel that contains Data in transit.\"\n    {\n        | eavesdrop\n                user info: \"An attacker that eavesdrops on the data flow, can access the contained data. That data may, in turn, be encrypted, thus preventing a breach of confidentiality.\"\n                ->\tdata.read\n\n        | deny\n                user info: \"A denial-of-service-attack on the dataflow makes the contained data inaccessible. The information may, however also be available elsewhere.\"\n                ->\tdata.delete\n\n        | adversaryInTheMiddle\n\n        | request\n\n        | respond\n\n        | maliciousTransmitNoIDPS\n\n        | maliciousTransmitBypassConflitionProtection\n\n        | maliciousTransmitBypassIDPS\n\n        | maliciousTransmit\n\n        & eavesdropId\n\n        & eavesdropAndBypassMsgConflictionProtection\n    }\n\n    asset ConnectionOrientedDataflow extends Dataflow\n        user info: \"A connection oriented dataflow is a unicast/multicast transmission that contains Data in transit.\"\n    {\n        | adversaryInTheMiddle\n                user info: \"An attacker that man-in-the-middles the data flow, can control the contained data. That data may, in turn, be encrypted and authenticated, thus preventing a breach of confidentiality and integrity.\"\n                +>\teavesdrop,\n                    deny,\n                    request,\n                    respond,\n                    data.write,\n                    data.read,\n                    data.delete\n\n        | request\n                ->\tservices.networkConnectUninspected\n\n        | respond\n                ->\tclients.networkConnectUninspected\n\n        | maliciousRespond [Exponential(0.614)]\n                user info: \"Confliction protection mechanism does not prevent malicious responds, but it typically takes time for the attacker to bypass it.\"\n                -> respond\n    }\n\n    asset ConnectionlessDataflow extends Dataflow\n        user info: \"A connectionless dataflow is a multicast/broadcast transmission that contains Data in transit.\"\n        developer info: \"In a broadcast network, there is no need to have clients because everyone receives the message. Additionally, in an event-driven network like CAN, there is no need for request.\"\n    {\n        | eavesdrop\n                user info: \"An attacker that eavesdrops on the data flow, can access the contained data. That data may, in turn, be encrypted, thus preventing a breach of confidentiality.\"\n                -> \tdata.read\n\n        | adversaryInTheMiddle\n                user info: \"An attacker that man-in-the-middles the data flow, can control the contained data. That data may, in turn, be encrypted and authenticated, thus preventing a breach of confidentiality and integrity.\"\n                +> \teavesdrop,\n                    deny,\n                    data.write,\n                    data.read,\n                    data.delete,\n                    transmit // Acts like IDPS is disabled, because MitM attacks are not easily, or not at all, detected by IDPS.\n                    // This agrees with the current securiCore implementation. MiTM leads to direct request/respond.\n\n        | maliciousTransmitNoIDPS\n                user info: \"Perform a malicious transmission when IDPS is disabled on GatewayECU. However even when IDPS is off effort is needed to bypass message confliction mechanism.\"\n                ->\tmaliciousTransmitBypassConflitionProtection\n\n        | maliciousTransmitBypassConflitionProtection [Exponential(0.314)]\n                user info: \"Confliction protection mechanism does not prevent malicious transmissions, but it typically takes time for the attacker to bypass it.\"\n                ->  transmit,\n                    eavesdropAndBypassMsgConflictionProtection\n\n        | maliciousTransmitBypassIDPS [Exponential(0.613)]\n                user info: \"IDPS's does not prevent all malicious transmissions, and it typically takes time for the attacker to bypass it.\"\n                developer info: \"The time to bypass a tuned and updated IDPS is studied in 'T. Sommestad, H. Holm, M. Ekstedt, Estimates of success rates of remote arbitrary code execution attacks, Information Management & Computer Security (2012)' and 'H.Holm, T.Sommestad, U.Franke, M.Ekstedt, Success rate of remote code execution attacks - expert assessments and observations, Journal of Universal Computer Science 18 (6) (2012)'\"\n                ->\ttransmit\n\n        | maliciousTransmit\n                user info: \"The act of trying to maliciously transmit. This happens when IDPS is not in place so the attacker can make malicious transmissions unobstructed. Reached only from network specific attacks and network service.\"\n                ->\ttransmit\n\n        | transmit\n                user info: \"The result of a successful transmit.\"\n                ->\ttransmitter.networkConnectUninspected\n\n        & eavesdropId\n                user info: \"The attacker was able to eavesdrop the unique ID of the message.\"\n                ->  dataflowId.read\n\n        & eavesdropAndBypassMsgConflictionProtection\n                user info: \"The attacker was able to eavesdrop the unique ID of the message while he also managed to bypass the confliction protection mechanism .\"\n                ->  dataflowId.read\n    }\n}", "Type": "category"}
{"Output": "category Security {\n\n    asset VehicularIdentity extends Identity\n        developer info: \"Extended from coreLang.\"\n    {\n        | assume\n                user info: \"A compromised identity leads to authentication on machines, access rights on data and also authentication on other connected identities.\"\n                +> \taccessedMachines.authenticate,\n                    connectMachines.authenticate,\n                    readPrivData.authorizedRead,\n                    writePrivData.authorizedWrite,\n                    deletePrivData.authorizedDelete,\n                    childId.attemptAssume\n    }\n\n    asset VehicularCredentials extends Credentials\n        developer info: \"Extended from coreLang.\"\n    {\n        | read\n                +> \tidentities.attemptAssume,\n                    readFirmwareAccessKey\n\n        | readFirmwareAccessKey\n                user info: \"The action of reading a stored firmware validation/access key.\"\n                ->  identities[VehicularIdentity].connectMachines.passFirmwareValidation,\n                    identities[VehicularIdentity].connectMachines.passUdsFirmwareModification,\n                    identities[VehicularIdentity].accessedMachines.passFirmwareValidation,\n                    identities[VehicularIdentity].accessedMachines.passUdsFirmwareModification\n    }\n\n    asset MessageID\n        user info: \"Represents the ID that resides on the header of a transmitted packet/message/dataflow.\"\n    {\n        | read\n                user info: \"The action of reading the message ID transfered by the dataflow.\"\n                ->  dataflow.receiver.impersonateId\n    }\n\n}", "Type": "category"}
{"Output": "asset PhysicalMachine\n        user info: \"Specifies any physical machine.\"\n    {\n        | connect\n                user info: \"Connect leads directly to access on a physical machine since no authentication is done/needed.\"\n                ->  fullAccess\n\n        | fullAccess\n                developer info: \"This is empty in order to be overriden.\"\n    }", "Type": "asset"}
{"Output": "asset SensorOrActuator extends PhysicalMachine\n        user info: \"Specifies physical machines like sensors and actuators.\"\n    {\n        | connect\n                user info: \"Connect leads directly to access on a physical machine since no authentication is done/needed.\"\n                ->  fullAccess\n\n        | fullAccess\n                user info: \"Access means that the attacker has full access on the machine, ex. he can manipulate the actuator's behavior or sensor's measurements.\"\n                ->  manipulate\n\n        | manipulate\n                developer info: \"This is empty for now because it is enough to reach this.\"\n    }", "Type": "asset"}
{"Output": "asset Machine extends Hardware\n        user info: \"Specifies any machine that has higher complexity than a simple actuator or sensor.\"\n        developer info: \"Extended from coreLang.\"\n    {\n\n        | connect\n                user info: \"Attempt to connect to a machine.\"\n                ->\tauthenticatedAccess,\n                    connectPrivileges.assume,\n                    connectionVulnerabilities.exploit\n\n        | authenticate\n                user info: \"Does the attacker have the credentials of an identity?\"\n                ->\tauthenticatedAccess\n\n        & authenticatedAccess\n                  user info: \"One way to gain access to a machine is through legitimate authentication.\"\n                ->\tfullAccess\n\n        | bypassAccessControl [Exponential(0.02)]\n                user info: \"An attacker can bypass access control and authenticate to the machine.\"\n                -> fullAccess\n\n        | fullAccess\n                developer info: \"We don't explicitly model root access; that is not a sound primitive. Instead, such an identity can be modelled explicitly by providing an account with access to all machineExecutedApps and all data.\"\n                +>\t_machineAccess\n\n        | idControl\n                user info: \"This is used when ID is compromised from dataflow.\"\n\n        | _machineAccess @hidden\n                developer info: \"Again, this is a helper attack step that will also be used from the childs of this asset.\"\n                ->\tdeny,\n                    _accessData,\n                    machineExecutedApps.localConnect,\n                    accessVulnerabilities.exploit\n\n        | deny\n                user info: \"Perform a DoS attack on the machine.\"\n                ->\tmachineExecutedApps.deny,\n                    hostedData.deny\n\n        | _accessData @hidden\n                user info: \"A helper attack step to reach request access on data stored on a machine\"\n                ->  hostedData.attemptRead,\n                    hostedData.attemptWrite,\n                    hostedData.attemptDelete\n\n        | passFirmwareValidation\n                developer info: \"Again, this is a blank helper attack step that will also be used from the childs of this asset.\"\n\n        | udsFirmwareModification\n                developer info: \"This is a blank helper attack step that should be reached from FirmwareUpdaterService.\"\n\n        | passUdsFirmwareModification\n                developer info: \"This is a blank helper attack step that should be reached from FirmwareUpdaterService.\"\n\n        | gainNetworkAccess\n                user info: \"This attack step will be only implemented on the infotainment system asset.\"\n    }", "Type": "asset"}
{"Output": "asset ECU extends Machine\n        user info: \"Specifies any ECU/MCU/controller in a vehicle.\"\n        developer info: \"Created as new parent class because the existing Machine had many unrelated attacks.\"\n    {\n        | connect\n                user info: \"Attackers can attempt to connect to the ECU and change the operation mode if they have access to the network, services, dataflows, etc...\"\n                +>  attemptChangeOperationMode\n                    //firmwareUpdater.networkConnectUninspected\n\n        | maliciousFirmwareUpload\n                user info: \"Maliciously uploading a forged firmware leads to full access on the ECU and the ability to inject/eavesdrop messages on the previous running services and network.\"\n                ->  fullAccess,\n                    _ecuNetworkAccess\n\n        & uploadFirmware\n                user info: \"Uploading firmware leads to full access on the ECU and the ability to inject/eavesdrop messages on the previous running services and network.\"\n                ->  _ecuNetworkAccess\n\n        | _ecuNetworkAccess @hidden\n                developer info: \"This a helper attack step because both above attack steps are leading to the same connections.\"\n                ->      vehiclenetworks.accessUninspected,\n                        vehiclenetworks.eavesdrop,\n                        vehiclenetworks.messageInjection,\n                        vehiclenetworks.j1939Attacks,\n                        vehiclenetworks._networkSpecificAttack,\n                        vehiclenetworks._networkForwarding\n\n        | udsFirmwareModification\n                user info: \"This attack step is reached after access on FirmwareUpdaterService.\"\n                ->  firmwareUpdater.udsFirmwareUpload\n\n        | passUdsFirmwareModification\n                user info: \"Same as below, if the cryptographic key is accessed.\"\n                ->  firmwareUpdater.passUdsFirmwareUpload\n\n        | passFirmwareValidation\n                user info: \"If the firmware validation key is stored in the ECU, this means that the firmware validation is passed and a new firmware can be uploaded.\"\n                ->  uploadFirmware\n\n        | fullAccess\n                user info: \"Attackers have access to the ECU if they have compromised its firmware (after custom firmware upload), bypassed access control (after authentication via diagnostics) or properly authenticated themselves.\"\n                +>\tsensorsOrActuators.manipulate,\n                    changeOperationMode,\n                    gainLINAccessFromCAN,\n                    bypassMessageConfliction,\n                    _ecuNetworkAccess\n\n        | idControl\n                user info: \"This attack step is reached after the ID is compromised from dataflow and allows an attacker to manipulate the connected sensors or actuators.\"\n                ->  sensorsOrActuators.manipulate\n\n        | offline\n                user info: \"When the ECU is taken offline by some other attack step. Offline means that the ECU is still powered on but unable to communicate on its bus. The effort needed to achieve this is applied on the distributions of the parent attacks. This also means that the connected sensors or actuators can be manipulated.\"\n                ->\tdeny,\n                    bypassMessageConfliction\n\n        | shutdown\n                user info: \"When the ECU is powered off by some other attack step. The effort needed to achieve this is applied on the distributions of the parent attacks.\"\n                ->\tbypassMessageConfliction,\n                    deny // Deny access to data and machineExecutedApps\n\n        & changeOperationMode\n                user info: \"Put the ECU into diagnostics (if vehicle is moving slowly or is stopped) or even update mode (bootmode). Leads to shutdown since attacker must have achieved access on this ECU to reach this step.\"\n                // This can bypass message conflictions and IDPS because the legitimate ECU will no lorger send messages and the attacker can imitate it, if carefull.\n                -> \tshutdown,\n                    firmware.maliciousFirmwareModification,\n                    uploadFirmware\n\n        & attemptChangeOperationMode [Exponential(0.1)]\n                user info: \"Put the ECU into diagnostics (if vehicle is moving slowly or is stopped) or even update mode (bootmode) but after some effort. This stops ECU from communicating on its bus -> offline\"\n                -> \toffline,\n                    bypassMessageConfliction,\n                    firmware.maliciousFirmwareModification\n\n        # operationModeProtection\n                user info: \"Either prevent diagnostics mode after vehicles starts moving or allow diagnostics mode only after some physical change is done on vehicle.\"\n                developer info: \"Charlie Miller and Chris Valasek, CAN message injection (2016).\"\n                ->\tchangeOperationMode,\n                    attemptChangeOperationMode\n\n        | bypassMessageConfliction\n                user info: \"Bypass message confliction protection mechanisms by changing ECU's operation mode -> no conflicts -> service message injection.\"\n                ->  machineExecutedApps.serviceMessageInjection\n\n        & _networkServiceMessageInjection @hidden\n                user info: \"Inject forged service messages that could notify about vehicle's fault or report fake status (speed, operation mode, etc.). This can even lead to unresponsive ECU (TPMS). This is reached from network access.\"\n                ->\tmachineExecutedApps.serviceMessageInjection\n\n        # messageConflictionProtection\n                user info: \"Defend against message injection by using message confliction mechanisms (detect messages with own ID). This acts like a host-based IDS.\"\n                developer info: \"Pierre Kleberger, Tomas Olovsson, and Erland Jonsson, Security Aspects of the In-Vehicle Network in the Connected Car (2011).\"\n                ->\t_networkServiceMessageInjection\n\n        | gainLINAccessFromCAN\n                user info: \"There are techniques that make it easy to gain access to the LIN bus through a CAN-bus node.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                //  NOTE: This should happen only with a probability and not always maybe?\n                ->\tvehiclenetworks.gainLINAccessFromCAN\n\n    }", "Type": "asset"}
{"Output": "asset GatewayECU extends ECU\n        user info: \"Specifies the ECU that acts as a gateway/firewall on a vehicle.\"\n    {\n        | fullAccess\n                developer info: \"Overriding from ECU\"\n                +>\ttrafficVNetworks.adversaryInTheMiddle, // This will act as Firewall and IDPS are disabled!\n                    forwarding\n\n        | forwarding\n                developer info: \"Forwarding is the lightest interaction with the gateway, where the gateway simply retransmits received messages. Vulnerabilities may, however, lead to compromise of the gateway as well as of the associated firewall. Therefore, Forwarding leads to Connect.\"\n                -> \tconnect,\n                    bypassFirewall  // If firewall is not enabled then bypass it.\n\n        & bypassFirewall\n                user info: \"If firewall is disabled, then attacker can bypass it.\"\n                ->\tgatewayBypassIDPS, // Added here to stop those attacks when firewall is enabled.\n                    gatewayNoIDPS,\n                    trafficVNetworks.accessUDSservices\n\n        # firewallProtection // Firewall is just a defense on gateway ECU.\n                user info: \"Firewall protection comes from the existence of a correctly configured firewall.\"\n                -> bypassFirewall\n\n        | deny\n                user info: \"Perform denial of service attack on the connected networks.\"\n                -> \ttrafficVNetworks.deny\n\n        // IDPS is modeled as a centralized inline IDPS\n        E  idpsExists\n                user info: \"Check for the existence of an IDPS.\"\n                <- idps\n                -> gatewayBypassIDPS\n\n        & gatewayBypassIDPS\n                user info: \"Bypass IDPS protection when IDPS is in place, but only if firewall is disabled.\"\n                -> trafficVNetworks._bypassIDPS\n\n        !E idpsDoesNotExist\n                user info: \"Check for the non existence of an IDPS.\"\n                <-\tidps\n                ->\tgatewayNoIDPS\n\n        & gatewayNoIDPS\n                user info: \"IDPS is disabled so the attacker can access the network unrestricted, but only if firewall is also disabled.\"\n                -> trafficVNetworks._noIDPS,\n                   trafficVNetworks.accessNetworkLayer // Moved it here from forwarding to allow imediate network access only if idps does not exist.\n    }", "Type": "asset"}
{"Output": "asset VehicularApplication extends Application\n        developer info: \"Extended from coreLang.\"\n    {   \n        | specificAccess\n                +>      hostMachine.connect\n        | fullAccess\n                +>      hostMachine.connect,\n                        assignedVehicularIdentity.attemptAssume\n\n        | serviceMessageInjection\n                developer info: \"This is an empty attack step that will only be used from the childs of this asset.\"\n    }", "Type": "asset"}
{"Output": "asset Firmware extends VehicularApplication\n        user info: \"Specifies the firmware running on an ECU as an application.\"\n    {\n        | maliciousFirmwareModification\n                user info: \"Perform a firmware update either by cracking Secure Boot or worse by exploiting the absence of it.\"\n                ->  bypassSecureBoot,\n                    crackSecureBoot\n\n        & crackFirmwareValidation [Exponential(0.2)]\n                user info: \"Crack firmware validation if it is enabled.\"\n                ->  hardware.maliciousFirmwareUpload\n\n        & bypassFirmwareValidation\n                user info: \"Bypass firmware validation if it is not enabled.\"\n                ->  hardware.maliciousFirmwareUpload\n\n        # firmwareValidation\n                user info: \"Code signing and verification during upload, use of strong checksum functions and/or don't distribute the private keys for signing.\"\n                developer info: \"Rubicon - Zero-knowledge Armor for Automotive Security, RubiconLabs\"\n                ->\tbypassFirmwareValidation\n\n        & bypassSecureBoot\n                user info: \"Bypass Secure Boot if it is not enabled Then validate a firmware update either by cracking (brute forcing) the checksum or worse by exploiting the absence of verification.\"\n                ->  bypassFirmwareValidation,\n                    crackFirmwareValidation\n\n        | crackSecureBoot [Exponential(0.1)]\n                user info: \"Crack Secure Boot if it is enabled is hard\"\n                ->  hardware.maliciousFirmwareUpload\n\n        # secureBoot\n                user info: \"SecureBoot is a protection mechanism that validates the boot software and the firmware at system boot time.\"\n                developer info: \"SecureBoot should make running of forged firmware even harder when enabled. Therefore, it stops firmware validation attack steps.\"\n                ->  bypassSecureBoot\n    }", "Type": "asset"}
{"Output": "asset OperatingSystem extends VehicularApplication {\n       // Currently simple ECUs and GatewayECUs don't have an OS. But the infotainment system has.\n    }", "Type": "asset"}
{"Output": "asset Service extends VehicularApplication {\n        // Intentionally left blank\n    }", "Type": "asset"}
{"Output": "asset Client extends VehicularApplication {\n        // Intentionally left blank\n    }", "Type": "asset"}
{"Output": "asset NetworkClient extends Client\n        user info: \"Represents a client connected to a service running on a network.\"\n    {\n        | fullAccess\n                +>\tdataflows.request\n    }", "Type": "asset"}
{"Output": "asset VehicleNetworkReceiver extends Client\n        user info: \"Represents a receiver/client for connectionless dataflows connected to a transmitter running on a vehicle network.\"\n    {\n        | fullAccess\n                +>\tdataflows.eavesdrop\n\n        | impersonateId\n                ->  hostMachine.idControl\n    }", "Type": "asset"}
{"Output": "asset NetworkService extends Service\n        user info: \"Represents a service running on top of a network.\"\n    {\n\n        | fullAccess\n                +>\tdataflows.respond\n    }", "Type": "asset"}
{"Output": "asset UDSService extends NetworkService\n        user info: \"Represents an ISO 14229 - Unified Diagnostics Service (UDS) running on an ECU.\"\n        developer info: \"Pierre Kleberger, On Securing the Connected Car: Methods and Protocols for Secure Vehicle Diagnostics, PhD Thesis (2015)\"\n    {\n        | fullAccess\n                user info: \"Access on an UDS service provides access on stored data, possibility to update firmware and change operation status of the ECU.\"\n                +>\tdataflows.respond,\n                    hostMachine._accessData\n    }", "Type": "asset"}
{"Output": "asset TransmitterService extends Service\n        user info: \"Represents a service/transmitter running on an ECU and on top of a vehicle network.\"\n    {\n        | fullAccess\n                +>\tdataflows.transmit,\n                    dataflows.deny // This is only possible here because only one Transmitter can be connected to a conectionless dataflow\n\n        | serviceMessageInjection\n                user info: \"Tamper dataflows that are conneceted to this network transmitter after bypassing message confliction on the ECU.\"\n                ->\tdataflows.maliciousTransmit,\n                    dataflows.eavesdropId\n    }", "Type": "asset"}
{"Output": "asset FirmwareUpdaterService extends UDSService\n        user info:\"Specifies the firmware updating procedure/UDS service on an ECU.\"\n    {\n        | fullAccess\n                +>  firmwareTarget.udsFirmwareModification\n\n        & udsFirmwareUpload\n                user info: \"If UDS Security Access defense is disabled, attacker can maliciously upload firmware.\"\n                ->  firmwareTarget.maliciousFirmwareUpload\n\n        | passUdsFirmwareUpload\n                user info: \"If the cryptographic key of Security Access is read then, the firmware upload procedure can easily be initiated.\"\n                ->  firmwareTarget.passFirmwareValidation\n\n        # udsSecurityAccess\n                user info: \"Firmware upload via UDS is protected by a UDS service called Security Access. This is an authentication protocol which uses a challenge-response scheme with cryptographic keys.\"\n                developer info: \"Interview with domain experts conducted by Nedo\"\n                ->  udsFirmwareUpload\n    }", "Type": "asset"}
{"Output": "asset VehicleNetwork extends Network\n        user info: \"Vehicle Networks include CAN bus, FlexRay and LIN bus.\"\n        developer info: \"Extended from coreLang.\"\n    {\n        //Override\n        | physicalAccess\n                user info: \"Physical access to the network. Merged coreLang asset Network with vehicleLang asset Network\"\n                +>\taccessNetworkLayer\n        \n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n\n        | accessUninspected\n                user info: \"Access implies the possibility to submit packets over the network. In a generic network, it does not imply the possibility to listen to others' traffic on the network. You are outside the router but with a possibility to communicate in to the network.\"\n                developer info: \"Overriding from network\"\n                +>\tdeny,\n                    applications.networkConnectUninspected,\n                    networkECUs.connect, // Reach ECUs connected network and try to connect, not access!\n                    accessUDSservices // But access on UDS services is possible because they can be protected by UdsSecurityAccess\n\n        | accessNetworkLayer\n                user info: \"Network layer access implies the possibility to submit messages over the network and the possibility to listen to others' traffic on the network.\"\n                developer info: \"Overriding from network\"\n                ->\taccessUninspected,\n                    _networkForwarding,\n                    eavesdrop,\n                    messageInjection,\n                    _networkSpecificAttack,\n                    j1939Attacks,\n                    networkECUs._networkServiceMessageInjection // This is for the case where the message confliction is disabled but attacking from the network.\n\n        | _networkForwarding @hidden\n                user info: \"An attacker that has access to a network connected ECU can also perform forwarding on that network using the connected GatewayECU. (helper attack)\"\n                -> trafficGatewayECU.forwarding\n\n        // Override\n        | eavesdrop\n                developer info: \"Those two extra attack steps are needed so that the compromised MessageID scenario to be able to work. Merged coreLang asset Network with vehicleLang asset Network\"\n                +>  dataflows.eavesdrop,\n                    dataflows.eavesdropId,\n                    dataflows.eavesdropAndBypassMsgConflictionProtection\n        // Override\n        | adversaryInTheMiddle\n                user info: \"This attack is reached only as an attacker's entry point or from GatewayEcu.fullAccess. It leads, among others, to dataflows MitM. Merged coreLang asset Network with vehicleLang asset Network\"\n                +>\taccessNetworkLayer,\n                    eavesdrop,\n                    dataflows.adversaryInTheMiddle,\n                    trafficGatewayECU.deny\n        // Override\n        | deny\n                user info: \"The network is made unavailable. Merged coreLang asset Network with vehicleLang asset Network\"\n                +> \tdataflows.deny\n        // This will require, by default, some effort especially for maliciousRespond, because message conflictions mechanisms are by default enabled.\n        // This attack is only reached as an entry point or from GatewayEcu.fullAccess, also see serviceMessageInjection.\n        | messageInjection\n                user info: \"Inject messages to dataflows means that attacker can try to transmit messages on the vehicle network but might not be sucessful because of the message confliction protection. It is also possible to perform a DoS.\"\n                ->\tdataflows.maliciousTransmitBypassConflitionProtection,\n                    deny\n\n        | _bypassIDPS @hidden\n                user info: \"Bypass IDPS on dataflows when the GatewayECU has IDPS enabled. (helper attack)\"\n                ->\tdataflows.maliciousTransmitBypassIDPS\n\n        | _noIDPS @hidden\n                user info: \"When no IDPS is connected/present on the GatewayECU. (helper attack)\"\n                ->\tdataflows.maliciousTransmitNoIDPS\n\n        | gainLINAccessFromCAN\n                developer info: \"This is an empty attack that will only be implemented on LINNetwork and it will be invoked by the ECU.\"\n\n        | j1939Attacks\n                user info: \"This is an empty attack that will only be implemented on J1939Network and it will be invoked by the ECU or by having network access.\"\n                developer info: \"Yelizaveta Burakova, Bill Hass, Leif Millar, and Andre Weimerskirch, Truck Hacking: An Experimental Analysis of the SAE J1939 Standard (2016)\"\n\n        | accessUDSservices\n                ->  networkFwUpdater.fullAccess\n    }", "Type": "asset"}
{"Output": "asset CANNetwork extends VehicleNetwork\n        user info: \"Represents the CAN bus network and the attacks that are possible on it.\"\n    {\n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n                ->\tbusOffAttack,\n                    exploitArbitration\n\n        | exploitArbitration [Exponential(0.1)]\n                user info: \"Exploiting the arbitration mechanism for message prioritization in CAN bus can lead to invalidation of legitimate messages/DoS and allow message tampering/injection.\"\n                developer info: \"Charlie Miller and Chris Valasek, 'Jeep Hack' & Pal-Stefan Murvay and Bogdan Groza, Security shortcomings and countermeasures for the SAE J1939 commercial vehicle bus protocol (2017)\"\n                ->\tdataflows.maliciousTransmit, // This is different from the messageInjection attack because, if successful, allows direct malicious respond and request.\n                    deny\n\n        & busOffAttack [Exponential(0.1)]\n                user info: \"Exploits the error-handling scheme of in-vehicle networks to disconnect good/uncompromised ECUs or cause DoS on the entire network. This is an easy to mount attack. This is also applicable on CAN-FD.\"\n                developer info: \"Kyong-Tak Cho and Kang G. Shin, Error Handling of In-vehicle Networks Makes Them Vulnerable (2016)\"\n                ->\tnetworkECUs.offline,\n                    deny\n\n        # busOffProtection\n                user info: \"Based on the defence mechanism proposed by the related paper\"\n                developer info: \"Kyong-Tak Cho and Kang G. Shin, Error Handling of In-vehicle Networks Makes Them Vulnerable (2016)\"\n                ->\tbusOffAttack\n    }", "Type": "asset"}
{"Output": "asset J1939Network extends CANNetwork\n        user info: \"SAE J1939 is a CAN-based protocol employed in many heavy duty vehicles.\"\n    {\n        // Override\n        | accessNetworkLayer\n                user info: \"Network layer access implies the possibility to submit messages over the network. It does not imply the possibility to listen to others' trafic on the network.\"\n                ->\tdeny,\n                    eavesdrop,\n                    messageInjection,\n                    networkECUs.connect\n\n        | eavesdrop\n                user info: \"An attacker can eavesdrop/sniff the network.\"\n                developer info: \"Luca Dariz, Massimiliano Ruggeri, Gianpiero Costantino and Fabio Martinelli, A Survey over Low-Level Security Issues in Heavy Duty Vehicles (2016)\"\n                -> \tj1939dataflows.eavesdrop\n\n        | adversaryInTheMiddle\n                    user info: \"Attackers can sometimes intercept and tamper with communications.\"\n                +> \taccessNetworkLayer,\n                    eavesdrop,\n                    j1939dataflows.adversaryInTheMiddle\n\n        | deny\n                user info: \"A DoS attack can happen on a J1939 network with three possible ways as described on the paper below.\"\n                developer info: \"Subhojeet Mukherjee et al., Practical DoS Attacks on Embedded Networks in Commercial Vehicles (2016)\"\n                -> \tj1939dataflows.deny\n\n        | messageInjection\n                developer info: \"Overriding from parent because in this type of networks, messageInjection should not happen with the same way.\"\n\n        | j1939MessageInjection\n                user info: \"Inject messages to J1939 means that attacker can make requests towards other J1939 nodes or PGNs (Parameter Group Number) and after effort to maliciously respond.\"\n                ->\tj1939dataflows.request,\n                    j1939dataflows.maliciousRespond\n\n        | j1939Attacks\n                user info: \"This attack step should work as an intermediate step to reach J1939 network specific attacks.\"\n                ->\teavesdrop,\n                    _advancedJ1939Attacks,\n                    j1939dataflows.maliciousRespond // Respond is generally always supported but requests might not.\n\n        & _advancedJ1939Attacks @hidden\n                user info: \"The attacks on this step are advanced in way that if the J1939 protocol is not fully supported, then those might not be sucessful.\"\n                developer info: \"Pal-Stefan Murvay and Bogdan Groza, Security shortcomings and countermeasures for the SAE J1939 commercial vehicle bus protocol (2017)\"\n                ->\tdeny,\n                    j1939MessageInjection\n\n        # noFullJ1939Support\n                user info: \"If only limited parts of the J1939 protocol are used then the J1939 specific attacks might not work. For example, requests might not be supported.\"\n                developer info: \"Pal-Stefan Murvay and Bogdan Groza, Security shortcomings and countermeasures for the SAE J1939 commercial vehicle bus protocol (2017)\"\n                -> _advancedJ1939Attacks\n    }", "Type": "asset"}
{"Output": "asset FlexRayNetwork extends VehicleNetwork\n        user info: \"Represents the FlexRay network and the attacks that are possible on it.\"\n    {\n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n                ->\tcommonTimeBaseAttack,\n                    exploitBusGuardian,\n                    sleepFrameAttack\n\n        | commonTimeBaseAttack [Gamma(2.0,5.0)]\n                user info: \"Send more than needed (> n/3 where n=# of nodes) SYNC messages within one communication cycle to make the whole network inoperable.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                ->\tdeny\n\n        | exploitBusGuardian [Exponential(0.15)]\n                user info: \"Utilize Bus Guardian for sending well-directed faked error messages to deactivate controllers. BusGuardian is hardened so much effort is needed.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009) & Philipp Mundhenk, Sebastian Steinhorst and Suhaib A. Fahmy, Security Analysis of Automotive Architectures using Probabilistic Model Checking (2015)\"\n                ->\tnetworkECUs.offline\n\n        & sleepFrameAttack [Exponential(0.1)]\n                user info: \"Send well-directed forged sleep frames to deactivate power-saving capable FlexRay controller.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                ->\tnetworkECUs.offline\n\n        # powerSavingIncapableNodes // Might need to be moved on ECU ??? But I leave it here for now...\n                user info: \"If FlexRay power-saving is not enabled then perform sleep frame attack.\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                ->\tsleepFrameAttack\n    }", "Type": "asset"}
{"Output": "asset LINNetwork extends VehicleNetwork\n        user info: \"Represents the LIN bus network and the attacks that are possible on it\"\n    {\n        | _networkSpecificAttack @hidden\n                user info: \"This attack step should work as an intermediate step to reach network specific attacks.\"\n                ->\tinjectHeaderOrTimedResponse,\n                    injectBogusSyncBytes\n\n        | injectBogusSyncBytes [Exponential(0.1)]\n                user info: \"Sending frames with bogus synchronization bytes within the SYNCH field makes the local LIN network inoperative or causes at least serious malfunctions\"\n                developer info: \"Marko Wolf, Security Engineering for Vehicular IT Systems, Vieweg+Teubner (2009)\"\n                -> deny\n\n        | gainLINAccessFromCAN\n                // This attack is reached from ECU\n                user info: \"There are techniques that make it easy to gain access to the LIN bus through a CAN-bus node.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                ->\taccessNetworkLayer\n\n        & injectHeaderOrTimedResponse [Exponential(0.1)]\n                user info: \"This is a specific attack that can happen on LIN bus exploiting the error handling mechanism, but it is not so easy.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                ->\tdataflows.maliciousTransmit // This is different from the messageInjection attack because, if successful, allows direct malicious respond and request.\n\n        # headerOrTimedResponseProtection\n                user info: \"Based on the defense mechanism proposed by the related paper.\"\n                developer info: \"Junko Takahashi et al., Automotive Attacks and Countermeasures on LIN-Bus (2017)\"\n                ->\tinjectHeaderOrTimedResponse\n\n        // LIN is also unprotected against forged messages. So messageInjection exists also here.\n    }", "Type": "asset"}
{"Output": "asset Dataflow\n        user info: \"Dataflow is a channel that contains Data in transit.\"\n    {\n        | eavesdrop\n                user info: \"An attacker that eavesdrops on the data flow, can access the contained data. That data may, in turn, be encrypted, thus preventing a breach of confidentiality.\"\n                ->\tdata.read\n\n        | deny\n                user info: \"A denial-of-service-attack on the dataflow makes the contained data inaccessible. The information may, however also be available elsewhere.\"\n                ->\tdata.delete\n\n        | adversaryInTheMiddle\n\n        | request\n\n        | respond\n\n        | maliciousTransmitNoIDPS\n\n        | maliciousTransmitBypassConflitionProtection\n\n        | maliciousTransmitBypassIDPS\n\n        | maliciousTransmit\n\n        & eavesdropId\n\n        & eavesdropAndBypassMsgConflictionProtection\n    }", "Type": "asset"}
{"Output": "asset ConnectionOrientedDataflow extends Dataflow\n        user info: \"A connection oriented dataflow is a unicast/multicast transmission that contains Data in transit.\"\n    {\n        | adversaryInTheMiddle\n                user info: \"An attacker that man-in-the-middles the data flow, can control the contained data. That data may, in turn, be encrypted and authenticated, thus preventing a breach of confidentiality and integrity.\"\n                +>\teavesdrop,\n                    deny,\n                    request,\n                    respond,\n                    data.write,\n                    data.read,\n                    data.delete\n\n        | request\n                ->\tservices.networkConnectUninspected\n\n        | respond\n                ->\tclients.networkConnectUninspected\n\n        | maliciousRespond [Exponential(0.614)]\n                user info: \"Confliction protection mechanism does not prevent malicious responds, but it typically takes time for the attacker to bypass it.\"\n                -> respond\n    }", "Type": "asset"}
{"Output": "asset ConnectionlessDataflow extends Dataflow\n        user info: \"A connectionless dataflow is a multicast/broadcast transmission that contains Data in transit.\"\n        developer info: \"In a broadcast network, there is no need to have clients because everyone receives the message. Additionally, in an event-driven network like CAN, there is no need for request.\"\n    {\n        | eavesdrop\n                user info: \"An attacker that eavesdrops on the data flow, can access the contained data. That data may, in turn, be encrypted, thus preventing a breach of confidentiality.\"\n                -> \tdata.read\n\n        | adversaryInTheMiddle\n                user info: \"An attacker that man-in-the-middles the data flow, can control the contained data. That data may, in turn, be encrypted and authenticated, thus preventing a breach of confidentiality and integrity.\"\n                +> \teavesdrop,\n                    deny,\n                    data.write,\n                    data.read,\n                    data.delete,\n                    transmit // Acts like IDPS is disabled, because MitM attacks are not easily, or not at all, detected by IDPS.\n                    // This agrees with the current securiCore implementation. MiTM leads to direct request/respond.\n\n        | maliciousTransmitNoIDPS\n                user info: \"Perform a malicious transmission when IDPS is disabled on GatewayECU. However even when IDPS is off effort is needed to bypass message confliction mechanism.\"\n                ->\tmaliciousTransmitBypassConflitionProtection\n\n        | maliciousTransmitBypassConflitionProtection [Exponential(0.314)]\n                user info: \"Confliction protection mechanism does not prevent malicious transmissions, but it typically takes time for the attacker to bypass it.\"\n                ->  transmit,\n                    eavesdropAndBypassMsgConflictionProtection\n\n        | maliciousTransmitBypassIDPS [Exponential(0.613)]\n                user info: \"IDPS's does not prevent all malicious transmissions, and it typically takes time for the attacker to bypass it.\"\n                developer info: \"The time to bypass a tuned and updated IDPS is studied in 'T. Sommestad, H. Holm, M. Ekstedt, Estimates of success rates of remote arbitrary code execution attacks, Information Management & Computer Security (2012)' and 'H.Holm, T.Sommestad, U.Franke, M.Ekstedt, Success rate of remote code execution attacks - expert assessments and observations, Journal of Universal Computer Science 18 (6) (2012)'\"\n                ->\ttransmit\n\n        | maliciousTransmit\n                user info: \"The act of trying to maliciously transmit. This happens when IDPS is not in place so the attacker can make malicious transmissions unobstructed. Reached only from network specific attacks and network service.\"\n                ->\ttransmit\n\n        | transmit\n                user info: \"The result of a successful transmit.\"\n                ->\ttransmitter.networkConnectUninspected\n\n        & eavesdropId\n                user info: \"The attacker was able to eavesdrop the unique ID of the message.\"\n                ->  dataflowId.read\n\n        & eavesdropAndBypassMsgConflictionProtection\n                user info: \"The attacker was able to eavesdrop the unique ID of the message while he also managed to bypass the confliction protection mechanism .\"\n                ->  dataflowId.read\n    }", "Type": "asset"}
{"Output": "asset VehicularIdentity extends Identity\n        developer info: \"Extended from coreLang.\"\n    {\n        | assume\n                user info: \"A compromised identity leads to authentication on machines, access rights on data and also authentication on other connected identities.\"\n                +> \taccessedMachines.authenticate,\n                    connectMachines.authenticate,\n                    readPrivData.authorizedRead,\n                    writePrivData.authorizedWrite,\n                    deletePrivData.authorizedDelete,\n                    childId.attemptAssume\n    }", "Type": "asset"}
{"Output": "asset VehicularCredentials extends Credentials\n        developer info: \"Extended from coreLang.\"\n    {\n        | read\n                +> \tidentities.attemptAssume,\n                    readFirmwareAccessKey\n\n        | readFirmwareAccessKey\n                user info: \"The action of reading a stored firmware validation/access key.\"\n                ->  identities[VehicularIdentity].connectMachines.passFirmwareValidation,\n                    identities[VehicularIdentity].connectMachines.passUdsFirmwareModification,\n                    identities[VehicularIdentity].accessedMachines.passFirmwareValidation,\n                    identities[VehicularIdentity].accessedMachines.passUdsFirmwareModification\n    }", "Type": "asset"}
{"Output": "asset MessageID\n        user info: \"Represents the ID that resides on the header of a transmitted packet/message/dataflow.\"\n    {\n        | read\n                user info: \"The action of reading the message ID transfered by the dataflow.\"\n                ->  dataflow.receiver.impersonateId\n    }", "Type": "asset"}
{"Output": "associations {\n    Machine\t[hostMachine]                   0..1 <-- machineExecution       --> *           [machineExecutedApps]   VehicularApplication\n    VehicularIdentity \t[vehicularIdentity]     * <-- AccessPrivileges\t        --> *           [accessedMachines]      Machine\n        user info: \"These identities grant access to the machine.\"\n    VehicularIdentity \t[connectPrivileges]     * <-- ConnectionPrivileges      --> *           [connectMachines]       Machine\n        user info: \"These privileges are granted to anyone who connects to a machine.\"\n    VehicularIdentity \t[assignedVehicularIdentity]     * <-- Assignment                --> *           [assignedApplications]  VehicularApplication\n        user info: \"Applications needs to be granted certain privileges when executing on a platform. When the application is compromised, the attacker gains its privileges on the platform.\"\n    //VehicularIdentity     [vehicularIdentities]         * <-- Credentials               --> *           [vehicularCredentials]  VehicularCredentials\n    VehicleNetwork \t[networks]                      * <-- Communication             --> *           [dataflows]             Dataflow\n        user info: \"In general, networks use dataflows for communication.\"\n    //VehicleNetwork     [machineNetworks]               * <-- MachineConnection         --> *           [networkMachines]       Machine\n    //     user info: \"Machines can be connected to networks. If services are not explicitly connected to other networks, it is assumed that they are communicating over the physically connected one.\"\n    J1939Network        [j1939networks]         * <-- J1939Communication        --> *           [j1939dataflows]         ConnectionOrientedDataflow\n        user info: \"A J1939 network uses connection oriented dataflows for communication although it is a CAN-based network.\"\n    Dataflow    [dataflow]                      0..1 <-- DataTransfer           --> 0..1        [data]                  Data\n        user info: \"The dataflow transmits data.\"\n        developer info: \"A dataflow cannot feature multiple data, as these may have different properties, e.g. one authenticated and one not.\"\n    Dataflow    [dataflows]                     * <-- Request                   --> *           [clients]               NetworkClient\n    Dataflow\t[dataflows]                     * <-- Response                  --> *           [services]              NetworkService\n        user info: \"A network service or a network client makes use of dataflows that can be either connection oriented or connectionless.\"\n    ConnectionlessDataflow      [dataflows]     * <-- Transmission              --> 0..1        [transmitter]           TransmitterService\n        user info: \"A transmitter service on a vehicle network uses connectionless dataflows for transmitting data.\"\n    ConnectionlessDataflow      [dataflows]     * <-- Transmission              --> *           [receiver]              VehicleNetworkReceiver\n        user info: \"A receiver uses connectionless dataflows for receiving data on a vehicle network.\"\n    ConnectionlessDataflow      [dataflow]      * <-- DataflowID                --> 0..1        [dataflowId]            MessageID\n        user info: \"Each bus network dataflow has a unique identifier.\"\n    IDPS        [idps]                          0..1 <-- IDPSProtection         --> 1\t        [idpsGatewayECU]        GatewayECU\n        user info: \"An IDPS can be connected to a GatewayECU. Here it is modeled as a centralized inline IDPS.\"\n    Machine     [connectionVulnerableMachine]   * <-- ConnectionVulnerability   --> 0..1        [connectionVulnerabilities]     Vulnerability\n    Machine\t[accessVulnerableMachine]       * <-- AccessVulnerability       --> 0..1        [accessVulnerabilities]         Vulnerability\n    VehicleNetwork      [vehiclenetworks]       * <-- EcuConnection             --> *           [networkECUs]           ECU\n    VehicleNetwork \t[trafficVNetworks]      * <-- GatewayConnection         --> *           [trafficGatewayECU]     GatewayECU\n    ECU         [hardware]                      1 <-- FirmwareExecution         --> 0..1        [firmware]              Firmware\n        user info: \"Every ECU can have (up to one) firmware running on it.\"\n    ECU\t\t[firmwareTarget]                1 <-- FirmwareUpdate            --> 0..1        [firmwareUpdater]       FirmwareUpdaterService\n        user info: \"Every ECU can have a firmware updater UDS service responsible for handling the firmware updates.\"\n    ECU \t[hardwarePlatform]              0..1 <-- SensorsOrActuators     --> *           [sensorsOrActuators]    SensorOrActuator\n        user info: \"An ECU can be connected with physical machines such as actuators and/or sensors.\"\n    VehicleNetwork      [fwUpdaterNetworks]     0..1 <-- FwUpdaterServices      --> *           [networkFwUpdater]      FirmwareUpdaterService\n        user info: \"A FirmwareUpdaterService can be connected to a vehicle network for accepting incoming connections.\"\n}", "Type": "association"}
